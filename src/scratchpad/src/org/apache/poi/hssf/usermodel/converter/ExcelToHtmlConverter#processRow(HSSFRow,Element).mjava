    protected boolean processRow( HSSFRow row, Element tableRowElement )
    {
        boolean emptyRow = true;

        final short maxColIx = row.getLastCellNum();
        if ( maxColIx <= 0 )
            return true;

        final List<Element> emptyCells = new ArrayList<Element>( maxColIx );

        for ( int colIx = 0; colIx < maxColIx; colIx++ )
        {
            HSSFCell cell = row.getCell( colIx );

            Element tableCellElement = htmlDocumentFacade.createTableCell();

            boolean emptyCell;
            if ( cell != null )
            {
                emptyCell = processCell( cell, tableCellElement );
            }
            else
            {
                emptyCell = true;
            }

            if ( emptyCell )
            {
                emptyCells.add( tableCellElement );
            }
            else
            {
                for ( Element emptyCellElement : emptyCells )
                {
                    tableRowElement.appendChild( emptyCellElement );
                }
                emptyCells.clear();

                tableRowElement.appendChild( tableCellElement );
                emptyRow = false;
            }
        }

        return emptyRow;
    }

