    public static AreaEval evaluateArea3dPtg(HSSFWorkbook workbook, Area3DPtg a3dp) {
        short row0 = a3dp.getFirstRow();
        short col0 = a3dp.getFirstColumn();
        short row1 = a3dp.getLastRow();
        short col1 = a3dp.getLastColumn();
        Workbook wb = workbook.getWorkbook();
        HSSFSheet xsheet = workbook.getSheetAt(wb.getSheetIndexFromExternSheetIndex(a3dp.getExternSheetIndex()));
        
        // If the last row is -1, then the
        //  reference is for the rest of the column
        // (eg C:C)
        // TODO: Handle whole column ranges properly
        if(row1 == -1 && row0 >= 0) {
        	row1 = (short)xsheet.getLastRowNum();
        }
        
        ValueEval[] values = new ValueEval[(row1 - row0 + 1) * (col1 - col0 + 1)];
        for (short x = row0; xsheet != null && x < row1 + 1; x++) {
            HSSFRow row = xsheet.getRow(x);
            for (short y = col0; row != null && y < col1 + 1; y++) {
                values[(x - row0) * (col1 - col0 + 1) + (y - col0)] = 
                    getEvalForCell(row.getCell(y), row, xsheet, workbook);
            }
        }
        AreaEval ae = new Area3DEval(a3dp, values);
        return ae;
    }

