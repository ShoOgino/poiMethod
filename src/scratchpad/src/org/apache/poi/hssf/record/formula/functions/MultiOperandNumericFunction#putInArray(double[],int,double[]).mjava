    private static double[] putInArray(double[] arr, int pos, double[] d) {
        double[] tarr = arr;
        while (pos+d.length >= arr.length) {
            arr = new double[arr.length << 1];
        }
        if (tarr.length != arr.length) {
            System.arraycopy(tarr, 0, arr, 0, tarr.length);
        }
        for (int i=0, iSize=d.length; i<iSize; i++) {
            arr[pos+i] = d[i];
        }
        return arr;
    }

