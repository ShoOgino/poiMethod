	/**
	 * Returns a specific number of characters from a text string, starting at
	 * the position you specify, based on the number of characters you specify.
	 * 
	 * @see org.apache.poi.hssf.record.formula.eval.Eval
	 */
	public Eval evaluate(Eval[] args, int srcCellRow, short srcCellCol) {
		if (args.length != 3) {
			return ErrorEval.VALUE_INVALID;
		}

		String text;
		int startIx; // zero based
		int numChars;

		try {
			ValueEval evText = OperandResolver.getSingleValue(args[0], srcCellRow, srcCellCol);
			text = OperandResolver.coerceValueToString(evText);
			int startCharNum = evaluateNumberArg(args[1], srcCellRow, srcCellCol);
			numChars = evaluateNumberArg(args[2], srcCellRow, srcCellCol);
			startIx = startCharNum - 1; // convert to zero-based
		} catch (EvaluationException e) {
			return e.getErrorEval();
		}

		int len = text.length();
		if (startIx < 0) {
			return ErrorEval.VALUE_INVALID;
		}
		if (numChars < 0) {
			return ErrorEval.VALUE_INVALID;
		}
		if (numChars < 0 || startIx > len) {
			return new StringEval("");
		}
		int endIx = startIx + numChars;
		if (endIx > len) {
			endIx = len;
		}
		String result = text.substring(startIx, endIx);
		return new StringEval(result);

	}

