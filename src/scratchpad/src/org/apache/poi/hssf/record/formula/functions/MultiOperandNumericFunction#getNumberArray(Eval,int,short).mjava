    /**
     * Same as getNumberArray(Eval[], int, short) except that this
     * takes Eval instead of Eval[].
     * @param operand
     * @param srcRow
     * @param srcCol
     */
    protected double[] getNumberArray(Eval operand, int srcRow, short srcCol) {
        
        if (operand instanceof AreaEval) {
            AreaEval ae = (AreaEval) operand;
            ValueEval[] values = ae.getValues();
            DoubleList retval = new DoubleList();
            for (int j=0, jSize=values.length; j<jSize; j++) {
                /*
                 * TODO: For an AreaEval, we are constructing a RefEval
                 * per element.
                 * For now this is a tempfix solution since this may
                 * require a more generic fix at the level of
                 * HSSFFormulaEvaluator where we store an array
                 * of RefEvals as the "values" array. 
                 */
                RefEval re = (values[j] instanceof RefEval)
                        ? new Ref2DEval(null, ((RefEval) values[j]).getInnerValueEval(), true)
                        : new Ref2DEval(null, values[j], false);
                ValueEval ve = singleOperandEvaluate(re, srcRow, srcCol);
                
                if (ve instanceof NumericValueEval) {
                    NumericValueEval nve = (NumericValueEval) ve;
                    retval.add(nve.getNumberValue());
                }
                else if (ve instanceof BlankEval) {
                    // note - blanks are ignored, so returned array will be smaller.
                } 
                else {
                    return null; // indicate to calling subclass that error occurred
                }
            }
            return retval.toArray();
        }
        
        // for ValueEvals other than AreaEval
        ValueEval ve = singleOperandEvaluate(operand, srcRow, srcCol);
        
        if (ve instanceof NumericValueEval) {
            NumericValueEval nve = (NumericValueEval) ve;
            return new double[] { nve.getNumberValue(), };
        }
        
        if (ve instanceof BlankEval) {
            // ignore blanks
            return EMPTY_DOUBLE_ARRAY;
        } 
        return null;
    }

