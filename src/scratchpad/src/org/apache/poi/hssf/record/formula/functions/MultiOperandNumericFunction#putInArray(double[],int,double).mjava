    /**
     * puts d at position pos in array arr. If pos is greater than arr, the 
     * array is dynamically resized (using a simple doubling rule).
     * @param arr
     * @param pos
     * @param d
     */
    private static double[] putInArray(double[] arr, int pos, double d) {
        double[] tarr = arr;
        while (pos >= arr.length) {
            arr = new double[arr.length << 1];
        }
        if (tarr.length != arr.length) {
            System.arraycopy(tarr, 0, arr, 0, tarr.length);
        }
        arr[pos] = d;
        return arr;
    }

