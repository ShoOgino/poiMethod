    /**
     * Translates an Excel internal error code into the corresponding POI ErrorEval instance 
     * @param errorCode
     */
    public static ErrorEval valueOf(int errorCode) {
        switch(errorCode) {
            case ErrorCode.NULL: return NULL_INTERSECTION;
            case ErrorCode.DIV_0: return DIV_ZERO;
            case ErrorCode.VALUE: return VALUE_INVALID;
//            case ErrorCode.REF: return REF_INVALID;
            case ErrorCode.REF: return UNKNOWN_ERROR;
            case ErrorCode.NAME: return NAME_INVALID;
            case ErrorCode.NUM: return NUM_ERROR;
            case ErrorCode.N_A: return NA;
            
            // these cases probably shouldn't be coming through here 
            // but (as of Jan-2008) a lot of code depends on it. 
//            case -20: return UNKNOWN_ERROR;
//            case -30: return FUNCTION_NOT_IMPLEMENTED;
//            case -60: return CIRCULAR_REF_ERROR;
        }
        throw new RuntimeException("Unexpected error code (" + errorCode + ")");
    }

