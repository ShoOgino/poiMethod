    protected String buildStyle( HSSFWorkbook workbook, HSSFCellStyle cellStyle )
    {
        StringBuilder style = new StringBuilder();

        style.append( "white-space: pre-wrap; " );

        switch ( cellStyle.getAlignment() )
        {
        case HSSFCellStyle.ALIGN_CENTER:
            style.append( "text-align: center; " );
            break;
        case HSSFCellStyle.ALIGN_CENTER_SELECTION:
            style.append( "text-align: center; " );
            break;
        case HSSFCellStyle.ALIGN_FILL:
            // XXX: shall we support fill?
            break;
        case HSSFCellStyle.ALIGN_GENERAL:
            break;
        case HSSFCellStyle.ALIGN_JUSTIFY:
            style.append( "text-align: justify; " );
            break;
        case HSSFCellStyle.ALIGN_LEFT:
            style.append( "text-align: left; " );
            break;
        case HSSFCellStyle.ALIGN_RIGHT:
            style.append( "text-align: right; " );
            break;
        }

        if ( cellStyle.getFillPattern() == 0 )
        {
            // no fill
        }
        else if ( cellStyle.getFillPattern() == 1 )
        {
            final HSSFColor foregroundColor = cellStyle
                    .getFillForegroundColorColor();
            if ( foregroundColor != null )
                style.append( "background-color: "
                        + ExcelToHtmlUtils.getColor( foregroundColor ) + "; " );
        }
        else
        {
            final HSSFColor backgroundColor = cellStyle
                    .getFillBackgroundColorColor();
            if ( backgroundColor != null )
                style.append( "background-color: "
                        + ExcelToHtmlUtils.getColor( backgroundColor ) + "; " );
        }

        buildStyle_border( workbook, style, "top", cellStyle.getBorderTop(),
                cellStyle.getTopBorderColor() );
        buildStyle_border( workbook, style, "right",
                cellStyle.getBorderRight(), cellStyle.getRightBorderColor() );
        buildStyle_border( workbook, style, "bottom",
                cellStyle.getBorderBottom(), cellStyle.getBottomBorderColor() );
        buildStyle_border( workbook, style, "left", cellStyle.getBorderLeft(),
                cellStyle.getLeftBorderColor() );

        HSSFFont font = cellStyle.getFont( workbook );
        buildStyle_font( workbook, style, font );

        return style.toString();
    }

