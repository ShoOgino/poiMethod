    public BasicStroke getStroke() {
        StrokeStyle strokeStyle = shape.getStrokeStyle();
        
        float lineWidth = (float) strokeStyle.getLineWidth();
        if (lineWidth == 0.0f) lineWidth = 0.25f; // Both PowerPoint and OOo draw zero-length lines as 0.25pt

        LineDash lineDash = strokeStyle.getLineDash();
        int dashPatI[] = lineDash.pattern;
        float[] dashPatF = new float[dashPatI.length];
        final float dash_phase = 0;
        for (int i=0; i<dashPatI.length; i++) {
            dashPatF[i] = dashPatI[i]*lineWidth;
        }

        int lineCap;
        switch (strokeStyle.getLineCap()) {
            case ROUND:
                lineCap = BasicStroke.CAP_ROUND;
                break;
            case SQUARE:
                lineCap = BasicStroke.CAP_SQUARE;
                break;
            default:
            case FLAT:
                lineCap = BasicStroke.CAP_BUTT;
                break;
        }

        int lineJoin = BasicStroke.JOIN_ROUND;

        return new BasicStroke(lineWidth, lineCap, lineJoin, Math.max(1, lineWidth), dashPatF, dash_phase);
    }

