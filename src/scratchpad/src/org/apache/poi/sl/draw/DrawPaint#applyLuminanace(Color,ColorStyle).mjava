    /**
     * Apply lumMod / lumOff adjustments
     *
     * @param c the color to modify
     * @param lumMod luminance modulation in the range [0..100000]
     * @param lumOff luminance offset in the range [0..100000]
     * @return  modified color
     */
    protected static Color applyLuminanace(Color c, ColorStyle fc) {
        int lumMod = fc.getLumMod();
        if (lumMod == -1) lumMod = 100000;

        int lumOff = fc.getLumOff();
        if (lumOff == -1) lumOff = 0;
        
        if (lumMod == 100000 && lumOff == 0) return c;

        int r = c.getRed();
        int g = c.getGreen();
        int b = c.getBlue();
        
        float red,green,blue;
        
        Color color;
        if (lumOff > 0) {
            float flumOff = lumOff / 100000.f;
            red = (255.f - r) * (1.f - flumOff) + r;
            green = (255.f - g) * flumOff + g;
            blue = (255.f - b) * flumOff + b;
        } else {
            float flumMod = lumMod / 100000.f;
            red = r * lumMod;
            green = g * lumMod;
            blue = b * lumMod;
        }
        return new Color(Math.round(red), Math.round(green), Math.round(blue), c.getAlpha());
    }

