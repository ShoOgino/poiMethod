    public void draw(HemfRecord r) {
        switch (getRenderState()) {
            case EMF_DCONTEXT:
                // This state specifies that subsequent EMF records encountered in the metafile SHOULD be processed.
                // EMF records cease being processed when the next EMF+ record is encountered.
                if (r instanceof EmfComment) {
                    setRenderState(EmfRenderState.EMFPLUS_ONLY);
                }
                r.draw(this);
                break;
            case INITIAL:
                r.draw(this);
                break;
            case EMF_ONLY:
                if (!(r instanceof EmfComment)) {
                    r.draw(this);
                }
                break;
            case EMFPLUS_ONLY:
                if (r instanceof EmfComment) {
                    r.draw(this);
                }
                break;
            default:
                break;
        }
    }

