        private HemfRecord _next() {
            if (currentRecord != null && currentRecord.getRecordType().equals(HemfRecordType.eof)) {
                return null;
            }
            long recordId = stream.readUInt();
            long recordSize = stream.readUInt();

            HemfRecord record = null;
            HemfRecordType type = HemfRecordType.getById(recordId);
            if (type == null) {
                throw new RuntimeException("Undefined record of type:"+recordId);
            }
            try {
                record = type.clazz.newInstance();
            } catch (InstantiationException e) {
                throw new RuntimeException(e);
            } catch (IllegalAccessException e) {
                throw new RuntimeException(e);
            }
            try {
                record.init(stream, recordId, recordSize-8);
            } catch (IOException e) {
                throw new RecordFormatException(e);
            }

            return record;
        }

