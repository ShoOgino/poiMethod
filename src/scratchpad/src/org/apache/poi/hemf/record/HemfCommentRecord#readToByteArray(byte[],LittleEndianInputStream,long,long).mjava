    //this prepends the initial "int" which turned out NOT to be
    //a signifier of emfplus, spool, public.
    private byte[] readToByteArray(byte[] initialBytes, LittleEndianInputStream leis,
                                   long remainingDataSize, long remainingRecordSize) throws IOException {
        if (remainingDataSize > Integer.MAX_VALUE) {
            throw new RecordFormatException("Data size can't be > Integer.MAX_VALUE");
        }

        if (remainingRecordSize > Integer.MAX_VALUE) {
            throw new RecordFormatException("Record size can't be > Integer.MAX_VALUE");
        }
        if (remainingRecordSize == 0) {
            return new byte[0];
        }

        int dataSize = (int)remainingDataSize;
        int recordSize = (int)remainingRecordSize;
        byte[] arr = new byte[dataSize+initialBytes.length];
        System.arraycopy(initialBytes,0,arr, 0, initialBytes.length);
        IOUtils.readFully(leis, arr, initialBytes.length, dataSize);
        IOUtils.skipFully(leis, recordSize-dataSize);

        return arr;
    }

