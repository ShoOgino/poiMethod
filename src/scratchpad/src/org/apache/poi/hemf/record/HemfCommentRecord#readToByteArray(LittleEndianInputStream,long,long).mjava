    private byte[] readToByteArray(LittleEndianInputStream leis, long dataSize, long recordSize) throws IOException {
        assert dataSize < Integer.MAX_VALUE;

        if (recordSize == 0) {
            return new byte[0];
        }

        byte[] arr = new byte[(int)dataSize];
        IOUtils.readFully(leis, arr);
        IOUtils.skipFully(leis, recordSize-dataSize);
        return arr;
    }

