    @Override
    public long init(LittleEndianInputStream leis, long dataSize, long recordId, int flags) throws IOException {
        this.flags = flags;
        version = leis.readUInt();

        // verify MetafileSignature (20 bits) == 0xDBC01 and
        // GraphicsVersion (12 bits) in (1 or 2)
        assert((version & 0xFFFFFA00) == 0xDBC01000L && ((version & 0x3FF) == 1 || (version & 0x3FF) == 2));

        emfPlusFlags = leis.readUInt();

        logicalDpiX = leis.readUInt();
        logicalDpiY = leis.readUInt();
        return 4* LittleEndianConsts.INT_SIZE;
    }

