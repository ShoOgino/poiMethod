    @Override
    public long init(LittleEndianInputStream leis, long dataSize, long recordId, int flags) throws IOException {
        recordType = HemfPlusRecordType.getById(recordId);
        this.flags = flags;
        recordBytes = IOUtils.safelyAllocate(dataSize, MAX_RECORD_LENGTH);
        leis.readFully(recordBytes);
        return recordBytes.length;
    }

