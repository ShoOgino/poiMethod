   private static int getLength(int type, InputStream inp) throws IOException {
      switch(type) {
         case Types.NULL:
            return 0;
         case Types.BOOLEAN:
         case Types.SHORT:
            return 2;
         case Types.LONG:
         case Types.FLOAT:
         case Types.ERROR:
            return 4;
         case Types.LONG_LONG:
         case Types.DOUBLE:
         case Types.APP_TIME:
         case Types.TIME:
         case Types.CURRENCY:
            return 8;
         case Types.CLS_ID:
            return 16;
         case Types.ASCII_STRING:
         case Types.UNICODE_STRING:
         case Types.DIRECTORY:
         case Types.BINARY:
            // Need to read the length, as it varies
            return LittleEndian.readInt(inp);
         default:
            throw new IllegalArgumentException("Unknown type " + type);
      }
   }

