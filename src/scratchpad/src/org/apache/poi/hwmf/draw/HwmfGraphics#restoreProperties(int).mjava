    /**
     * Restores the properties from the stack
     *
     * @param index if the index is positive, the n-th element from the start is removed and activated.
     *      If the index is negative, the n-th previous element relative to the current properties element is removed and activated.
     */
    public void restoreProperties(int index) {
        if (index == 0) {
            return;
        }
        int stackIndex = index;
        if (stackIndex < 0) {
            int curIdx = propStack.indexOf(prop);
            assert (curIdx != -1);
            stackIndex = curIdx + index;
        }
        prop = propStack.remove(stackIndex);
    }

