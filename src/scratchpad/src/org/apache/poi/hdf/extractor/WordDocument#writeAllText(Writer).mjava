  public void writeAllText(Writer out) throws IOException
  {
    int textStart = Utils.convertBytesToInt(_header, 0x18);
    int textEnd = Utils.convertBytesToInt(_header, 0x1c);
    Vector textPieces = findProperties(textStart, textEnd, _text.root);
    int size = textPieces.size();

    for(int x = 0; x < size; x++)
    {
      TextPiece nextPiece = (TextPiece)textPieces.get(x);
      int start = nextPiece.getStart();
      int end = nextPiece.getEnd();
      boolean unicode = nextPiece.usesUnicode();
      int add = 1;

      if(unicode)
      {
        add = 2;
      }
      char ch;
      for(int y = start; y < end; y += add)
      {
        if(unicode)
        {
          ch = (char)Utils.convertBytesToShort(_header, y);
        }
        else
        {
          ch = (char)_header[y];
        }
        out.write(ch);
      }
    }
  }

