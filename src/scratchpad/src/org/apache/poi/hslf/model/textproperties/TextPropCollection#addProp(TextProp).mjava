	/**
	 * Add the property at the correct position. Replaces an existing property with the same name.
	 *
	 * @param textProp the property to be added
	 */
	public void addProp(TextProp textProp) {
	    assert(textProp != null);
	    
        int pos = 0;
        boolean found = false;
        for (TextProp curProp : getPotentialProperties()) {
            String potName = curProp.getName();
            if (pos == textPropList.size() || potName.equals(textProp.getName())) {
                if (textPropList.size() > pos && potName.equals(textPropList.get(pos).getName())) {
                    // replace existing prop (with same name)
                    textPropList.set(pos, textProp);
                } else {
                    textPropList.add(pos, textProp);
                }
                found = true;
                break;
            }
            
            if (potName.equals(textPropList.get(pos).getName())) {
                pos++;
            }
        }

        if(!found) {
            String err = "TextProp with name " + textProp.getName() + " doesn't belong to this collection.";
            throw new IllegalArgumentException(err);
        }
	}

