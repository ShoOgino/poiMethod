    protected void initTable(){
        List<Shape> shapeList = getShapeList();
        Collections.sort(shapeList, new Comparator<Shape>(){
            public int compare( Shape o1, Shape o2 ) {
                Rectangle anchor1 = o1.getAnchor();
                Rectangle anchor2 = o2.getAnchor();
                int delta = anchor1.y - anchor2.y;
                if(delta == 0) delta = anchor1.x - anchor2.x;
                return delta;
            }
        });
        int y0 = -1;
        int maxrowlen = 0;
        List<List<Shape>> lst = new ArrayList<List<Shape>>();
        List<Shape> row = null;
        for (Shape sh : shapeList) {
            if(sh instanceof TextShape){
                Rectangle anchor = sh.getAnchor();
                if(anchor.y != y0){
                    y0 = anchor.y;
                    row = new ArrayList<Shape>();
                    lst.add(row);
                }
                row.add(sh);
                maxrowlen = Math.max(maxrowlen, row.size());
            }
        }
        cells = new TableCell[lst.size()][maxrowlen];
        for (int i = 0; i < lst.size(); i++) {
            row = lst.get(i);
            for (int j = 0; j < row.size(); j++) {
                TextShape tx = (TextShape)row.get(j);
                cells[i][j] = new TableCell(tx.getSpContainer(), getParent());
                cells[i][j].setSheet(tx.getSheet());
            }
        }
    }

