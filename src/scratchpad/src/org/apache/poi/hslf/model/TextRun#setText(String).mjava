	/**
	 * Changes the text. Chance are, this won't work just yet, because
	 *  we also need to update some other bits of the powerpoint file
	 *  to match the change in the Text Atom, especially byte offsets
	 */
	public void setText(String s) {
		// If size changed, warn
		if(s.length() != getText().length()) {
			System.err.println("Warning: Your powerpoint file may no longer readable by powerpoint, as the text run has changed size!");
		}

		if(_isUnicode) {
			// The atom can safely convert to unicode
			_charAtom.setText(s);
		} else {
			// Will it fit in a 8 bit atom?
			boolean hasMultibyte = StringUtil.hasMultibyte(s);
			if(! hasMultibyte) {
				// Fine to go into 8 bit atom
				byte[] text = new byte[s.length()];
				StringUtil.putCompressedUnicode(s,text,0);
				_byteAtom.setText(text);
			} else {
				throw new RuntimeException("Setting of unicode text is currently only possible for Text Runs that are Unicode in the file, sorry. For now, please convert that text to us-ascii and re-try it");
			}
		}
		
	}

