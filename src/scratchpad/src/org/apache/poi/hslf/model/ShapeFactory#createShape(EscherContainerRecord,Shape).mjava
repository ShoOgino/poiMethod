    /**
     * Create a new shape from the data provided.  
     */
    public static Shape createShape(EscherContainerRecord spContainer, Shape parent){
        if (spContainer.getRecordId() == EscherContainerRecord.SPGR_CONTAINER){
            return new ShapeGroup(spContainer, parent);
        }

        Shape shape;
        EscherSpRecord spRecord = spContainer.getChildById(EscherSpRecord.RECORD_ID);

        int type = spRecord.getOptions() >> 4;
        switch (type){
            case ShapeTypes.TextBox:
                shape = new TextBox(spContainer, parent);
                break;
            case ShapeTypes.PictureFrame:
                shape = new Picture(spContainer, parent);
                break;
            case ShapeTypes.Line:
                shape = new Line(spContainer, parent);
                break;
            case ShapeTypes.NotPrimitive:
                if ((spRecord.getFlags() & EscherSpRecord.FLAG_GROUP) != 0)
                    //TODO: check if the shape group is a Table 
                    shape = new ShapeGroup(spContainer, parent);
                else {
                    //TODO: check if the shape has GEOMETRY__VERTICES or GEOMETRY__SEGMENTINFO properties.
                    //if it does, then return Freeform or Polygon
                    shape = new AutoShape(spContainer, parent);
                }
                break;
            default:
                shape = new AutoShape(spContainer, parent);
                break;
        }
        return shape;
    }

