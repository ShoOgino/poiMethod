    /**
     * Create a new shape from the data provided.  
     */
    public static Shape createShape(EscherContainerRecord spContainer, Shape parent){
        if (spContainer.getRecordId() == EscherContainerRecord.SPGR_CONTAINER){
            return new ShapeGroup(spContainer, parent);
        }

        Shape shape;
        EscherSpRecord spRecord = spContainer.getChildById(EscherSpRecord.RECORD_ID);

        int type = spRecord.getOptions() >> 4;
        switch (type){
            case ShapeTypes.Rectangle:
                EscherTextboxRecord txtbox = (EscherTextboxRecord)Shape.getEscherChild(spContainer, EscherTextboxRecord.RECORD_ID);
                if (txtbox == null) shape = new AutoShape(spContainer, parent);
                else{
                    if(Shape.getEscherChild(spContainer, EscherClientDataRecord.RECORD_ID) != null )
                        shape = new Placeholder(spContainer, parent);
                    else
                        shape = new TextBox(spContainer, parent);
                }
                break;
            case ShapeTypes.TextBox:
                shape = new TextBox(spContainer, parent);
                break;
            case ShapeTypes.PictureFrame:
                shape = new Picture(spContainer, parent);
                break;
            case ShapeTypes.Line:
                shape = new Line(spContainer, parent);
                break;
            case ShapeTypes.NotPrimitive:
                shape = new ShapeGroup(spContainer, parent);
                break;
            default:
                shape = new AutoShape(spContainer, parent);
                break;
        }
        return shape;
    }

