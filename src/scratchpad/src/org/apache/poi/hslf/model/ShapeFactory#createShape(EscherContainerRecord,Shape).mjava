    public static Shape createShape(EscherContainerRecord spContainer, Shape parent){
        if (spContainer.getRecordId() == EscherContainerRecord.SPGR_CONTAINER){
            return new ShapeGroup(spContainer, parent);
        }

        Shape shape;
        EscherSpRecord spRecord = spContainer.getChildById(EscherSpRecord.RECORD_ID);

        int type = spRecord.getOptions() >> 4;
        switch (type){
            case ShapeTypes.TextBox:
            case ShapeTypes.Rectangle:
                shape = new Shape(spContainer, parent);
                break;
            case ShapeTypes.PictureFrame:
                shape = new Shape(spContainer, parent);
                break;
            case ShapeTypes.Line:
                shape = new Line(spContainer, parent);
                break;
            case ShapeTypes.Ellipse:
                shape = new Ellipse(spContainer, parent);
                break;
            case ShapeTypes.NotPrimitive:
                shape = new ShapeGroup(spContainer, parent);
                break;
            default:
                shape = new Shape(spContainer, parent);
                break;
        }
        return shape;
    }

