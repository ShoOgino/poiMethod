    @Override
    public void setData(byte[] data) throws IOException {
        // skip the first 512 bytes - they are MAC specific crap
        final int nOffset = NativeHeader.PICT_HEADER_OFFSET;
        NativeHeader nHeader = new NativeHeader(data, nOffset);
        
        Header header = new Header();
        header.wmfsize = data.length - nOffset;
        byte[] compressed = compress(data, nOffset, header.wmfsize);
        header.zipsize = compressed.length;
        header.bounds = nHeader.bounds;
        Dimension nDim = nHeader.getSize();
        header.size = new Dimension(Units.toEMU(nDim.getWidth()), Units.toEMU(nDim.getHeight()));

        byte[] checksum = getChecksum(data);
        ByteArrayOutputStream out = new ByteArrayOutputStream();
        out.write(checksum);
        if (uidInstanceCount == 2) {
            out.write(checksum);
        }
        header.write(out);
        out.write(compressed);

        setRawData(out.toByteArray());
    }

