    public FillStyle getFillStyle() {
        return new FillStyle() {
            public PaintStyle getPaint() {
                switch (getFillType()) {
                    case FILL_SOLID:
                        return DrawPaint.createSolidPaint(getForegroundColor());
                    case FILL_PICTURE: {
                        final HSLFPictureData pd = getPictureData();
                        if (pd == null) break;
                        
                        return new TexturePaint() {
                            public InputStream getImageData() {
                                return new ByteArrayInputStream(pd.getData());
                            }

                            public String getContentType() {
                                return pd.getContentType();
                            }

                            public int getAlpha() {
                                return (int)(shape.getAlpha(EscherProperties.FILL__FILLOPACITY)*100000.0);
                            }
                        };
                    }
                    default:
                        logger.log(POILogger.WARN, "unsuported fill type: " + getFillType());
                        break;
                }
                return null;
            }
        };
    }

