    public CustomGeometry getGeometry() {
        ShapeType st = getShapeType();
        String name = st.getOoxmlName();
        
        PresetGeometries dict = PresetGeometries.getInstance();
        CustomGeometry geom = dict.get(name);
        if(geom == null) {
            throw new IllegalStateException("Unknown shape geometry: " + name);
        }
        
        return geom;
    }

