    protected void initParagraphsFromSheetRecords(){
        EscherTextboxWrapper txtbox = getEscherTextboxWrapper();
        HSLFSheet sheet = getSheet();

        if(sheet == null || txtbox == null) return;

        OutlineTextRefAtom ota = null;

        Record[] child = txtbox.getChildRecords();
        for (int i = 0; i < child.length; i++) {
            if (child[i] instanceof OutlineTextRefAtom) {
                ota = (OutlineTextRefAtom)child[i];
                break;
            }
        }

        List<List<HSLFTextParagraph>> sheetRuns = _sheet.getTextParagraphs();
        _paragraphs.clear();
        if (sheetRuns != null) {
            if (ota != null) {
                int idx = ota.getTextIndex();
                for (List<HSLFTextParagraph> r : sheetRuns) {
                    if (r.isEmpty()) continue;
                    int ridx = r.get(0).getIndex();
                    if (ridx > idx) break;
                    if (ridx == idx) _paragraphs.addAll(r);
                }
                if(_paragraphs.isEmpty()) {
                    logger.log(POILogger.WARN, "text run not found for OutlineTextRefAtom.TextIndex=" + idx);
                }
            } else {
                int shapeId = getShapeId();
                for (List<HSLFTextParagraph> r : sheetRuns) {
                    if (r.isEmpty()) continue;
                    if (r.get(0).getShapeId() == shapeId) _paragraphs.addAll(r);
                }
            }
        }

        // ensure the same references child records of TextRun
        // TODO: check the purpose of this ...
//        if(_txtrun != null) {
//            for (int i = 0; i < child.length; i++) {
//                for (Record r : _txtrun.getRecords()) {
//                    if (child[i].getRecordType() == r.getRecordType()) {
//                        child[i] = r;
//                    }
//                }
//            }
//        }
    }

