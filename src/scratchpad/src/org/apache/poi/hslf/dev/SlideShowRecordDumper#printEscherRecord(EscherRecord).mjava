  public String printEscherRecord( EscherRecord er ) {
        String nl = System.getProperty( "line.separator" );
        StringBuffer buf = new StringBuffer();

		if (er instanceof EscherContainerRecord) {
			buf.append(printEscherContainerRecord( (EscherContainerRecord)er ));
		} else if (er instanceof EscherTextboxRecord) {
			buf.append("EscherTextboxRecord:" + nl);
			
			EscherTextboxWrapper etw = new EscherTextboxWrapper((EscherTextboxRecord)er);
			Record children[] = etw.getChildRecords();
			for (int j=0; j<children.length; j++) {
				if (children[j] instanceof StyleTextPropAtom) {
					
					// need preceding Text[Chars|Bytes]Atom to initialize the data structure
					if (j > 0 && (children[j-1] instanceof TextCharsAtom || 
								  children[j-1] instanceof TextBytesAtom)) {
								  	
						int size = (children[j-1] instanceof TextCharsAtom) ? 
										((TextCharsAtom)children[j-1]).getText().length() : 
										((TextBytesAtom)children[j-1]).getText().length();
										
						StyleTextPropAtom tsp = (StyleTextPropAtom)children[j];
						tsp.setParentTextSize(size);
						
					} else {
						buf.append("Error! Couldn't find preceding TextAtom for style\n");
					}
					
					buf.append(children[j].toString() + nl );
				} else {				
					buf.append(children[j].toString() + nl );
				}
			}
		} else {
			buf.append( er.toString() );
		}			
		return buf.toString();
  }

