    private void extractTableText(StringBuffer ret, HSLFTable table) {
        final int nrows = table.getNumberOfRows();
        final int ncols = table.getNumberOfColumns();
        for (int row = 0; row < nrows; row++){
            for (int col = 0; col < ncols; col++){
                HSLFTableCell cell = table.getCell(row, col);
                //defensive null checks; don't know if they're necessary
                if (cell != null){
                    String txt = cell.getText();
                    txt = (txt == null) ? "" : txt;
                    ret.append(txt);
                    if (col < ncols-1){
                        ret.append('\t');
                    }
                }
            }
            ret.append('\n');
        }
    }

