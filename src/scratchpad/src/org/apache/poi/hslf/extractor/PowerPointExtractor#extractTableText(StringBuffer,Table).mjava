    private void extractTableText(StringBuffer ret, Table table) {
        for (int row = 0; row < table.getNumberOfRows(); row++){
            for (int col = 0; col < table.getNumberOfColumns(); col++){
                TableCell cell = table.getCell(row, col);
                //defensive null checks; don't know if they're necessary
                if (cell != null){
                    String txt = cell.getText();
                    txt = (txt == null) ? "" : txt;
                    ret.append(txt);
                    if (col < table.getNumberOfColumns()-1){
                        ret.append("\t");
                    }
                }
            }
            ret.append('\n');
        }
    }

