	public String getText(boolean getSlideText, boolean getNoteText, boolean getCommentText, boolean getMasterText) {
		StringBuffer ret = new StringBuffer();

		if (getSlideText) {
            if (getMasterText) {
                for (SlideMaster master : _show.getSlidesMasters()) {
                    textRunsToText(ret, master.getTextRuns());
                }
            }

            for (int i = 0; i < _slides.length; i++) {
				Slide slide = _slides[i];

				// Slide header, if set
				HeadersFooters hf = slide.getHeadersFooters();
				if (hf != null && hf.isHeaderVisible() && hf.getHeaderText() != null) {
					ret.append(hf.getHeaderText() + "\n");
				}

				// Slide text
                textRunsToText(ret, slide.getTextRuns());

                // Slide footer, if set
				if (hf != null && hf.isFooterVisible() && hf.getFooterText() != null) {
					ret.append(hf.getFooterText() + "\n");
				}

				// Comments, if requested and present
				if (getCommentText) {
					Comment[] comments = slide.getComments();
					for (int j = 0; j < comments.length; j++) {
						ret.append(comments[j].getAuthor() + " - " + comments[j].getText() + "\n");
					}
				}
			}
			if (getNoteText) {
				ret.append("\n");
			}
		}

		if (getNoteText) {
			// Not currently using _notes, as that can have the notes of
			// master sheets in. Grab Slide list, then work from there,
			// but ensure no duplicates
			HashSet seenNotes = new HashSet();
			HeadersFooters hf = _show.getNotesHeadersFooters();

			for (int i = 0; i < _slides.length; i++) {
				Notes notes = _slides[i].getNotesSheet();
				if (notes == null) {
					continue;
				}
				Integer id = Integer.valueOf(notes._getSheetNumber());
				if (seenNotes.contains(id)) {
					continue;
				}
				seenNotes.add(id);

				// Repeat the Notes header, if set
				if (hf != null && hf.isHeaderVisible() && hf.getHeaderText() != null) {
					ret.append(hf.getHeaderText() + "\n");
				}

				// Notes text
                textRunsToText(ret, notes.getTextRuns());

				// Repeat the notes footer, if set
				if (hf != null && hf.isFooterVisible() && hf.getFooterText() != null) {
					ret.append(hf.getFooterText() + "\n");
				}
			}
		}

		return ret.toString();
	}

