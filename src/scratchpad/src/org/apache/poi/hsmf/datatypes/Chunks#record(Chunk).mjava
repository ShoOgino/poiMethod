   /**
    * Called by the parser whenever a chunk is found.
    */
   public void record(Chunk chunk) {
      if(chunk.getChunkId() == MAPIProperty.MESSAGE_CLASS.id) {
         messageClass = (StringChunk)chunk;
      }
      else if(chunk.getChunkId() == MAPIProperty.INTERNET_MESSAGE_ID.id) {
         messageId = (StringChunk)chunk;
      }
      else if(chunk.getChunkId() == MAPIProperty.MESSAGE_SUBMISSION_ID.id) {
         // TODO - parse
         submissionChunk = (MessageSubmissionChunk)chunk;
      }
      else if(chunk.getChunkId() == MAPIProperty.RECEIVED_BY_ADDRTYPE.id) {
         sentByServerType = (StringChunk)chunk;
      }
      else if(chunk.getChunkId() == MAPIProperty.TRANSPORT_MESSAGE_HEADERS.id) {
         messageHeaders = (StringChunk)chunk;
      }
      
      else if(chunk.getChunkId() == MAPIProperty.CONVERSATION_TOPIC.id) {
         conversationTopic = (StringChunk)chunk;
      }
      else if(chunk.getChunkId() == MAPIProperty.SUBJECT.id) {
         subjectChunk = (StringChunk)chunk;
      }
      else if(chunk.getChunkId() == MAPIProperty.ORIGINAL_SUBJECT.id) {
         // TODO
      }
      
      else if(chunk.getChunkId() == MAPIProperty.DISPLAY_TO.id) {
         displayToChunk = (StringChunk)chunk;
      }
      else if(chunk.getChunkId() == MAPIProperty.DISPLAY_CC.id) {
         displayCCChunk = (StringChunk)chunk;
      }
      else if(chunk.getChunkId() == MAPIProperty.DISPLAY_BCC.id) {
         displayBCCChunk = (StringChunk)chunk;
      }
      
      else if(chunk.getChunkId() == MAPIProperty.SENDER_EMAIL_ADDRESS.id) {
         emailFromChunk = (StringChunk)chunk;
      }
      else if(chunk.getChunkId() == MAPIProperty.SENDER_NAME.id) {
         displayFromChunk = (StringChunk)chunk;
      }
      else if(chunk.getChunkId() == MAPIProperty.BODY.id) {
         textBodyChunk = (StringChunk)chunk;
      }
      else if(chunk.getChunkId() == MAPIProperty.BODY_HTML.id) {
         if(chunk instanceof StringChunk) {
            htmlBodyChunkString = (StringChunk)chunk;
         }
         if(chunk instanceof ByteChunk) {
            htmlBodyChunkBinary = (ByteChunk)chunk;
         }
      }
      else if(chunk.getChunkId() == MAPIProperty.RTF_COMPRESSED.id) {
         rtfBodyChunk = (ByteChunk)chunk;
      }
      
      // And add to the main list
      allChunks.add(chunk);
   }

