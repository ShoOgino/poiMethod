	/**
	 * Constructor used to build a Range from indexes in one of its internal
	 * lists.
	 *
	 * @param startIdx
	 *            The starting index in the list.
	 * @param endIdx
	 *            The ending index in the list.
	 * @param idxType
	 *            The list type.
	 * @param parent
	 *            The parent Range this range belongs to.
	 */
	protected Range(int startIdx, int endIdx, int idxType, Range parent) {
		_doc = parent._doc;
		_sections = parent._sections;
		_paragraphs = parent._paragraphs;
		_characters = parent._characters;
		_text = parent._text;
		_parent = new WeakReference(parent);

		switch (idxType) {
			case TYPE_PARAGRAPH:
				_parStart = parent._parStart + startIdx;
				_parEnd = parent._parStart + endIdx;
				_start = _paragraphs.get(_parStart).getStart();
				_end = _paragraphs.get(_parEnd).getEnd();
				_parRangeFound = true;
				break;
			case TYPE_CHARACTER:
				_charStart = parent._charStart + startIdx;
				_charEnd = parent._charStart + endIdx;
				_start = _characters.get(_charStart).getStart();
				_end = _characters.get(_charEnd).getEnd();
				_charRangeFound = true;
				break;
			case TYPE_SECTION:
				_sectionStart = parent._sectionStart + startIdx;
				_sectionEnd = parent._sectionStart + endIdx;
				_start = _sections.get(_sectionStart).getStart();
				_end = _sections.get(_sectionEnd).getEnd();
				_sectionRangeFound = true;
				break;
			case TYPE_TEXT:
				_textStart = parent._textStart + startIdx;
				_textEnd = parent._textStart + endIdx;
				_start = _text.get(_textStart).getStart();
				_end = _text.get(_textEnd).getEnd();
				_textRangeFound = true;
				break;
		}

		sanityCheckStartEnd();
	}

