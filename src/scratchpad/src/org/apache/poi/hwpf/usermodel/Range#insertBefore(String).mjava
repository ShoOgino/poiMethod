  public CharacterRun insertBefore(String text)
    //throws UnsupportedEncodingException
  {
    initAll();

    TextPiece tp = (TextPiece)_text.get(_textStart);
    StringBuffer sb = (StringBuffer)tp.getStringBuffer();

    // Since this is the first item in our list, it is safe to assume that
    // _start >= tp.getStart()
    int insertIndex = _start - tp.getStart();
    sb.insert(insertIndex, text);
    int adjustedLength = _doc.getTextTable().adjustForInsert(_textStart, text.length());
    _doc.getCharacterTable().adjustForInsert(_textStart, adjustedLength);
    _doc.getParagraphTable().adjustForInsert(_textStart, adjustedLength);
    _doc.getSectionTable().adjustForInsert(_textStart, adjustedLength);
    adjustForInsert(text.length());

    return getCharacterRun(0);
  }

