    @Override
    protected void outputCharacters( Element block, CharacterRun characterRun,
            String text )
    {
        BlockProperies blockProperies = this.blocksProperies.peek();
        Element inline = foDocumentFacade.createInline();

        Triplet triplet = getCharacterRunTriplet( characterRun );

        if ( triplet.bold != blockProperies.pBold )
        {
            WordToFoUtils.setBold( inline, triplet.bold );
        }
        if ( triplet.italic != blockProperies.pItalic )
        {
            WordToFoUtils.setItalic( inline, triplet.italic );
        }
        if ( WordToFoUtils.isNotEmpty( triplet.fontName )
                && !WordToFoUtils.equals( triplet.fontName,
                        blockProperies.pFontName ) )
        {
            WordToFoUtils.setFontFamily( inline, characterRun.getFontName() );
        }
        if ( characterRun.getFontSize() / 2 != blockProperies.pFontSize )
        {
            WordToFoUtils.setFontSize( inline, characterRun.getFontSize() / 2 );
        }
        WordToFoUtils.setCharactersProperties( characterRun, inline );
        block.appendChild( inline );

        Text textNode = foDocumentFacade.createText( text );
        inline.appendChild( textNode );
    }

