    @Override
    protected void processEndnoteAutonumbered( HWPFDocument doc, int noteIndex,
            Element block, Range endnoteTextRange )
    {
        final String textIndex = String.valueOf( internalLinkCounter
                .incrementAndGet() );
        final String forwardLinkName = "endnote_" + textIndex;
        final String backwardLinkName = "endnote_back_" + textIndex;

        Element forwardLink = foDocumentFacade
                .createBasicLinkInternal( forwardLinkName );
        forwardLink.appendChild( createNoteInline( textIndex ) );
        setId( forwardLink, backwardLinkName );
        block.appendChild( forwardLink );

        Element endnote = foDocumentFacade.createBlock();
        Element backwardLink = foDocumentFacade
                .createBasicLinkInternal( backwardLinkName );
        backwardLink.appendChild( createNoteInline( textIndex + " " ) );
        setId( backwardLink, forwardLinkName );
        endnote.appendChild( backwardLink );

        blocksProperies.push( new BlockProperies( "", -1, false, false ) );
        try
        {
            processCharacters( doc, Integer.MIN_VALUE, endnoteTextRange,
                    endnote );
        }
        finally
        {
            blocksProperies.pop();
        }

        WordToFoUtils.compactInlines( endnote );
        this.endnotes.add( endnote );
    }

