  public HWPFDocument(InputStream istream) throws IOException
  {
    //do Ole stuff
    _filesystem = new POIFSFileSystem(istream);

    // read in the main stream.
    DocumentEntry documentProps =
       (DocumentEntry)_filesystem.getRoot().getEntry("WordDocument");
    _mainStream = new byte[documentProps.getSize()];
    _filesystem.createDocumentInputStream("WordDocument").read(_mainStream);

    // use the fib to determine the name of the table stream.
    _fib = new FileInformationBlock(_mainStream);

    String name = "0Table";
    if (_fib.isFWhichTblStm())
    {
      name = "1Table";
    }

    // read in the table stream.
    DocumentEntry tableProps =
      (DocumentEntry)_filesystem.getRoot().getEntry(name);
    _tableStream = new byte[tableProps.getSize()];
    _filesystem.createDocumentInputStream(name).read(_tableStream);

    // get the start of text in the main stream
    int fcMin = _fib.getFcMin();

    DocumentProperties dop = new DocumentProperties(_tableStream, _fib.getFcDop());
    ComplexFileTable cft = new ComplexFileTable(_mainStream, _tableStream, _fib.getFcClx(), fcMin);
    CHPBinTable cbt = new CHPBinTable(_mainStream, _tableStream, _fib.getFcPlcfbteChpx(), _fib.getLcbPlcfbteChpx(), fcMin);
    PAPBinTable pbt = new PAPBinTable(_mainStream, _tableStream, _fib.getFcPlcfbtePapx(), _fib.getLcbPlcfbtePapx(), fcMin);
    SectionTable st = new SectionTable(_mainStream, _tableStream, _fib.getFcPlcfsed(), _fib.getLcbPlcfsed(), fcMin);
    StyleSheet ss = new StyleSheet(_tableStream, _fib.getFcStshf());

    int x = 0;

  }

