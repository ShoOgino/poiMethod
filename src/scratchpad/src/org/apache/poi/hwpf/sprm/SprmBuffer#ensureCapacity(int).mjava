  private void ensureCapacity( int addition )
{
    if ( _offset + addition >= _buf.length )
    {
        // add 6 more than they need for use the next iteration
        //
        // commented - buffer shall not contain any additional bytes --
        // sergey
        // byte[] newBuf = new byte[_offset + addition + 6];
         byte[] newBuf = IOUtils.safelyAllocate(_offset + addition, MAX_RECORD_LENGTH);
        System.arraycopy( _buf, 0, newBuf, 0, _buf.length );
        _buf = newBuf;
    }
}

