  public String text()
    throws UnsupportedEncodingException
  {
    if (!_textRangeFound)
    {
      int[] point = findRange(_text, _textStart, _start, _end);
      _textStart = point[0];
      _textEnd = point[1];
      _textRangeFound = true;
    }

    StringBuffer sb = new StringBuffer();
    int size = _text.size();
    for (int x = 0; x < size; x++)
    {
      TextPiece tp = (TextPiece)_text.get(x);
      String encoding = "Cp1252";
      if (tp.usesUnicode())
      {
        encoding = "UTF-16LE";
      }
      String str = new String (tp.getBuf(), Math.max(_start, tp.getStart()), Math.min(_end, tp.getEnd()), encoding);
      sb.append(str);
    }
    return sb.toString();
  }

