    /**
     * Take the first codepage that is not default, ansi or symbol.
     * Ideally, we'd want to track fonts with runs, but we don't yet
     * know how to do that.
     *
     * Consider throwing an exception if > 1 unique codepage that is not default, symbol or ansi
     * appears here.
     *
     * @param fontTable
     * @return The detected Charset from the old font table
     */
    private Charset guessCodePage(OldFontTable fontTable) {
        //try to get it out of the overall document summary information
        DocumentSummaryInformation summaryInformation = getDocumentSummaryInformation();
        if (summaryInformation != null) {
            CustomProperties customProperties = summaryInformation.getCustomProperties();
            if (customProperties != null) {
                int codePage = customProperties.getCodepage();
                try {
                    return Charset.forName(CodePageUtil.codepageToEncoding(codePage));
                } catch (UnsupportedEncodingException e) {
                    //swallow
                }
            }
            //for now, try to get first valid code page in a valid section
            for (Section section : summaryInformation.getSections()) {
                if (section.getOffset() < 0) {
                    continue;
                }
                int codePage = section.getCodepage();
                try {
                    return Charset.forName(CodePageUtil.codepageToEncoding(codePage));
                } catch (UnsupportedEncodingException e) {
                    //swallow
                }
            }
        }
        //if that still doesn't work, pick the first non-default non symbol charset
        for (OldFfn oldFfn : fontTable.getFontNames()) {
            HwmfFont.WmfCharset wmfCharset = HwmfFont.WmfCharset.valueOf(oldFfn.getChs()& 0xff);
            if (wmfCharset != null &&
                    wmfCharset != HwmfFont.WmfCharset.ANSI_CHARSET &&
                    wmfCharset != HwmfFont.WmfCharset.DEFAULT_CHARSET &&
                    wmfCharset != HwmfFont.WmfCharset.SYMBOL_CHARSET ) {
                return wmfCharset.getCharset();
            }
        }
        return DEFAULT_CHARSET;
    }

