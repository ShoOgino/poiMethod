    private int savePlex( PlexOfCps plexOfCps, int type,
            FileInformationBlock fib, HWPFOutputStream outputStream )
            throws IOException
    {
        if ( plexOfCps == null || plexOfCps.length() == 0 )
            return 0;

        byte[] data = plexOfCps.toByteArray();

        int start = outputStream.getOffset();
        int length = data.length;

        outputStream.write( data );

        switch ( type )
        {
        case PLCFFLDATN:
            fib.setFcPlcffldAtn( start );
            fib.setLcbPlcffldAtn( length );
            break;
        case PLCFFLDEDN:
            fib.setFcPlcffldEdn( start );
            fib.setLcbPlcffldEdn( length );
            break;
        case PLCFFLDFTN:
            fib.setFcPlcffldFtn( start );
            fib.setLcbPlcffldFtn( length );
            break;
        case PLCFFLDHDR:
            fib.setFcPlcffldHdr( start );
            fib.setLcbPlcffldHdr( length );
            break;
        case PLCFFLDHDRTXBX:
            fib.setFcPlcffldHdrtxbx( start );
            fib.setLcbPlcffldHdrtxbx( length );
            break;
        case PLCFFLDMOM:
            fib.setFcPlcffldMom( start );
            fib.setLcbPlcffldMom( length );
            break;
        case PLCFFLDTXBX:
            fib.setFcPlcffldTxbx( start );
            fib.setLcbPlcffldTxbx( length );
            break;
        default:
            return 0;
        }

        return length;
    }

