  public void write(HWPFOutputStream out)
    throws IOException
  {
    int offset = 0;
    byte[] buf = new byte[_stshiLength];
    LittleEndian.putShort(buf, offset, (short)_stshiLength);
    offset += LittleEndian.SHORT_SIZE;
    LittleEndian.putShort(buf, offset, (short)_styleDescriptions.length);
    offset += LittleEndian.SHORT_SIZE;
    LittleEndian.putShort(buf, offset, (short)_baseLength);
    offset += LittleEndian.SHORT_SIZE;
    LittleEndian.putShort(buf, offset, (short)_flags);
    offset += LittleEndian.SHORT_SIZE;
    LittleEndian.putShort(buf, offset, (short)_maxIndex);
    offset += LittleEndian.SHORT_SIZE;
    LittleEndian.putShort(buf, offset, (short)_maxFixedIndex);
    offset += LittleEndian.SHORT_SIZE;
    LittleEndian.putShort(buf, offset, (short)_stylenameVersion);
    offset += LittleEndian.SHORT_SIZE;

    LittleEndian.putShort(buf, offset, (short)_rgftc[0]);
    offset += LittleEndian.SHORT_SIZE;
    LittleEndian.putShort(buf, offset, (short)_rgftc[1]);
    offset += LittleEndian.SHORT_SIZE;
    LittleEndian.putShort(buf, offset, (short)_rgftc[2]);

    out.write(buf);

    byte[] sizeHolder = new byte[2];
    for (int x = 0; x < _styleDescriptions.length; x++)
    {
      if(_styleDescriptions[x] != null)
      {
          byte[] std = _styleDescriptions[x].toByteArray();

          LittleEndian.putShort(sizeHolder, (short)std.length);
          out.write(sizeHolder);
          out.write(std);
      }
      else
      {
        sizeHolder[0] = 0;
        sizeHolder[1] = 0;
        out.write(sizeHolder);
      }
    }

  }
  /**
   * Creates a PartagraphProperties object from a papx stored in the
   * StyleDescription at the index istd in the StyleDescription array. The PAP
   * is placed in the StyleDescription at istd after its been created. Not
   * every StyleDescription will contain a papx. In these cases this function
   * does nothing
   *
   * @param istd The index of the StyleDescription to create the
   *        ParagraphProperties  from (and also place the finished PAP in)
   */
//  private void createPap(int istd)
//  {
//      StyleDescription sd = _styleDescriptions[istd];
//      ParagraphProperties pap = sd.getPAP();
//      byte[] papx = sd.getPAPX();
//      int baseIndex = sd.getBaseStyle();
//      if(pap == null && papx != null)
//      {
//          ParagraphProperties parentPAP = _nilStyle.getPAP();
//          if(baseIndex != NIL_STYLE)
//          {
//
//              parentPAP = _styleDescriptions[baseIndex].getPAP();
//              if(parentPAP == null)
//              {
//                  createPap(baseIndex);
//                  parentPAP = _styleDescriptions[baseIndex].getPAP();
//              }
//
//          }
//
//          pap = (ParagraphProperties)uncompressProperty(papx, parentPAP, this);
//          sd.setPAP(pap);
//      }
//  }
//  /**
//   * Creates a CharacterProperties object from a chpx stored in the
//   * StyleDescription at the index istd in the StyleDescription array. The
//   * CharacterProperties object is placed in the StyleDescription at istd after
//   * its been created. Not every StyleDescription will contain a chpx. In these
//   * cases this function does nothing.
//   *
//   * @param istd The index of the StyleDescription to create the
//   *        CharacterProperties object from.
//   */
//  private void createChp(int istd)
//  {
//      StyleDescription sd = _styleDescriptions[istd];
//      CharacterProperties chp = sd.getCHP();
//      byte[] chpx = sd.getCHPX();
//      int baseIndex = sd.getBaseStyle();
//      if(chp == null && chpx != null)
//      {
//          CharacterProperties parentCHP = _nilStyle.getCHP();
//          if(baseIndex != NIL_STYLE)
//          {
//
//              parentCHP = _styleDescriptions[baseIndex].getCHP();
//              if(parentCHP == null)
//              {
//                  createChp(baseIndex);
//                  parentCHP = _styleDescriptions[baseIndex].getCHP();
//              }
//
//          }
//
//          chp = (CharacterProperties)uncompressProperty(chpx, parentCHP, this);
//          sd.setCHP(chp);
//      }
//  }

