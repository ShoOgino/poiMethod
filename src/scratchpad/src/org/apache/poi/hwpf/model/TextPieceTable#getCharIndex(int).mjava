  	/* (non-Javadoc)
	 * @see org.apache.poi.hwpf.model.CharIndexTranslator#getLengthInChars(int)
	 */
	public int getCharIndex(int bytePos) {
		int charCount = 0;

		Iterator it = _textPieces.iterator();
		while (it.hasNext()) {
			TextPiece tp = (TextPiece) it.next();
			int pieceStart = tp.getPieceDescriptor().getFilePosition();
			if(pieceStart >= bytePos) {
				break;
			}
			
			int bytesLength = tp.bytesLength();
			int pieceEnd = pieceStart + bytesLength;

			int toAdd = bytePos > pieceEnd ? bytesLength : bytesLength
					- (pieceEnd - bytePos);

			if (tp.isUnicode()) {
				charCount += toAdd / 2;
			} else {
				charCount += toAdd;
			}
		}

		return charCount;
	}

