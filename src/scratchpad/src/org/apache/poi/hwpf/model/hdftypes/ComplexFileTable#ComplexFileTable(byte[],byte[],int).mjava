  public ComplexFileTable(byte[] documentStream, byte[] tableStream, int offset) throws IOException
  {
    //skips through the prms before we reach the piece table. These contain data
    //for actual fast saved files
    while (tableStream[offset] == 1)
    {
      offset++;
      int skip = LittleEndian.getShort(tableStream, offset);
      offset += 2 + skip;
    }
    if(tableStream[offset] != 2)
    {
      throw new IOException("The text piece table is corrupted");
    }
    else
    {
      int pieceTableSize = LittleEndian.getInt(tableStream, ++offset);
      offset += LittleEndian.INT_SIZE;
      _tpt = new TextPieceTable(documentStream, tableStream, offset, pieceTableSize);
    }
  }

