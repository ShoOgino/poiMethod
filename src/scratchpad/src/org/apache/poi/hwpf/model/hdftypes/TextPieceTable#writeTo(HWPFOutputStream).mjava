  public byte[] writeTo(HWPFOutputStream docStream)
    throws IOException
  {

    PlexOfCps textPlex = new PlexOfCps(PieceDescriptor.getSizeInBytes());
    //int fcMin = docStream.getOffset();

    int size = _textPieces.size();
    for (int x = 0; x < size; x++)
    {
      TextPiece next = (TextPiece)_textPieces.get(x);
      PieceDescriptor pd = next.getPieceDescriptor();

      // set the text piece position to the current docStream offset.
      pd.setFilePosition(docStream.getOffset());

      // write the text to the docstream and save the piece descriptor to the
      // plex which will be written later to the tableStream.
      docStream.write(next.getBuf());

      int nodeStart = next.getStart();
      textPlex.addProperty(new PropertyNode(nodeStart,
                                            (next.getEnd() - nodeStart)/_multiple + nodeStart,
                                            pd.toByteArray()));

    }

    return textPlex.toByteArray();

  }

