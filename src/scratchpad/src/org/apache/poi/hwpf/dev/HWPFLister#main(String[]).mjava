    public static void main( String[] args ) throws Exception
    {
        if ( args.length == 0 )
        {
            System.err.println( "Use:" );
            System.err
                    .println( "\tHWPFLister <filename>\n"
                            + "\t\t[--textPieces] [--textPiecesText]\n"
                            + "\t\t[--chpx] [--chpxProperties] [--chpxSprms]\n"
                            + "\t\t[--papx] [--papxProperties]\n"
                            + "\t\t[--paragraphs] [--paragraphsSprms] [--paragraphsText]\n"
                            + "\t\t[--bookmarks]\n" +"\t\t[--fields]\n" + "\t\t[--pictures]\n"
                            + "\t\t[--writereadback]\n" );
            System.exit( 1 );
        }

        boolean outputTextPieces = false;
        boolean outputTextPiecesText = false;

        boolean outputChpx = false;
        boolean outputChpxProperties = false;
        boolean outputChpxSprms = false;

        boolean outputParagraphs = false;
        boolean outputParagraphsSprms = false;
        boolean outputParagraphsText = false;

        boolean outputPapx = false;
        boolean outputPapxProperties = false;

        boolean outputBookmarks = false;
        boolean outputFields = false;
        boolean outputPictures = false;

        boolean writereadback = false;

        for ( String arg : Arrays.asList( args ).subList( 1, args.length ) )
        {
            if ( "--textPieces".equals( arg ) )
                outputTextPieces = true;
            if ( "--textPiecesText".equals( arg ) )
                outputTextPiecesText = true;

            if ( "--chpx".equals( arg ) )
                outputChpx = true;
            if ( "--chpxProperties".equals( arg ) )
                outputChpxProperties = true;
            if ( "--chpxSprms".equals( arg ) )
                outputChpxSprms = true;

            if ( "--paragraphs".equals( arg ) )
                outputParagraphs = true;
            if ( "--paragraphsSprms".equals( arg ) )
                outputParagraphsSprms = true;
            if ( "--paragraphsText".equals( arg ) )
                outputParagraphsText = true;

            if ( "--papx".equals( arg ) )
                outputPapx = true;
            if ( "--papxProperties".equals( arg ) )
                outputPapxProperties = true;

            if ( "--bookmarks".equals( arg ) )
                outputBookmarks = true;
            if ( "--fields".equals( arg ) )
                outputFields = true;
            if ( "--pictures".equals( arg ) )
                outputPictures = true;

            if ( "--writereadback".equals( arg ) )
                writereadback = true;
        }

        HWPFDocumentCore doc = loadDoc( new File( args[0] ) );
        if ( writereadback )
            doc = writeOutAndReadBack( doc );

        HWPFLister lister = new HWPFLister( doc );
        lister.dumpFIB();

        if ( outputTextPieces )
        {
            System.out.println( "== Text pieces ==" );
            lister.dumpTextPieces( outputTextPiecesText );
        }

        if ( outputChpx )
        {
            System.out.println( "== CHPX ==" );
            lister.dumpChpx( outputChpxProperties, outputChpxSprms );
        }

        if ( outputPapx )
        {
            System.out.println( "== PAPX ==" );
            lister.dumpPapx( outputPapxProperties );
        }

        if ( outputParagraphs )
        {
            System.out.println( "== Text paragraphs ==" );
            lister.dumpParagraphs( true );

            System.out.println( "== DOM paragraphs ==" );
            lister.dumpParagraphsDom( outputParagraphsSprms, outputPapx,
                    outputParagraphsText );
        }

        if ( outputBookmarks )
        {
            System.out.println( "== BOOKMARKS ==" );
            lister.dumpBookmarks();
        }

        if ( outputFields )
        {
            System.out.println( "== FIELDS ==" );
            lister.dumpFields();
        }

        if ( outputPictures )
        {
            System.out.println( "== PICTURES ==" );
            lister.dumpPictures();
        }
    }

