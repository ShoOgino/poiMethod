    /**
     * Check that we can decode the first 16 codes
     * (flag + 8 codes, flag + 8 codes)
     */
    @Test
    public void testFirstTwoBlocks() throws Exception {
        HMEFMessage msg;
        try (InputStream is = _samples.openResourceAsStream("quick-winmail.dat")) {
            msg = new HMEFMessage(is);
        }

        MAPIAttribute attr = msg.getMessageMAPIAttribute(MAPIProperty.RTF_COMPRESSED);
        assertNotNull(attr);
        MAPIRtfAttribute rtfAttr = (MAPIRtfAttribute) attr;

        // Truncate to header + flag + data for flag + flag + data
        byte[] data = new byte[16 + 12 + 13];
        System.arraycopy(rtfAttr.getRawData(), 0, data, 0, data.length);

        // Decompress it
        CompressedRTF comp = new CompressedRTF();
        byte[] decomp = comp.decompress(new ByteArrayInputStream(data));
       String decompStr = new String(decomp, StandardCharsets.US_ASCII);

        // Test
        assertEquals(block2.length(), decomp.length);
        assertEquals(block2, decompStr);
    }

