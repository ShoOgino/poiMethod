	public void testChangeWriteRead() throws Exception {
		HSLFSlideShowImpl[] h = new HSLFSlideShowImpl[] { hss, hssRichA, hssRichB };
		HSLFSlide[] s = new HSLFSlide[] { ss.getSlides()[0], ssRichA.getSlides()[0], ssRichB.getSlides()[0] };

		for(int i=0; i<h.length; i++) {
			// Change
			HSLFSlide slideOne = s[i];
			HSLFTextParagraph[] textRuns = slideOne.getTextParagraphs();
			HSLFTextRun rtr = textRuns[0].getTextRuns()[0];

			rtr.setBold(true);
			rtr.setFontSize(18);
			rtr.setFontName("Courier");

			// Check it took those
			assertEquals(true, rtr.isBold());
			assertEquals(18, rtr.getFontSize());
			assertEquals("Courier", rtr.getFontName());

			// Write out and back in
			ByteArrayOutputStream baos = new ByteArrayOutputStream();
			h[i].write(baos);
			ByteArrayInputStream bais = new ByteArrayInputStream(baos.toByteArray());

			HSLFSlideShowImpl readHSLF = new HSLFSlideShowImpl(bais);
			HSLFSlideShow readS = new HSLFSlideShow(readHSLF);

			// Tweak existing one again, to ensure really worked
			rtr.setBold(false);
			rtr.setFontSize(17);
			rtr.setFontName("CourierZZ");

			// Check it took those changes
			assertEquals(false, rtr.isBold());
			assertEquals(17, rtr.getFontSize());
			assertEquals("CourierZZ", rtr.getFontName());


			// Now, look at the one we changed, wrote out, and read back in
			// Ensure it does contain our original modifications
			HSLFSlide slideOneRR = readS.getSlides()[0];
			HSLFTextParagraph[] textRunsRR = slideOneRR.getTextParagraphs();
			HSLFTextRun rtrRRa = textRunsRR[0].getTextRuns()[0];

			assertEquals(true, rtrRRa.isBold());
			assertEquals(18, rtrRRa.getFontSize());
			assertEquals("Courier", rtrRRa.getFontName());
		}
	}

