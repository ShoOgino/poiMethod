    /**
     * Tests that we can work with both {@link POIFSFileSystem}
     * and {@link NPOIFSFileSystem}
     */
    @SuppressWarnings("resource")
    @Test
    public void testDifferentPOIFS() throws IOException {
        // Open the two filesystems
        File pptFile = slTests.getFile("basic_test_ppt_file.ppt");
        InputStream is1 = new FileInputStream(pptFile);
        OPOIFSFileSystem opoifs = new OPOIFSFileSystem(is1);
        is1.close();
        NPOIFSFileSystem npoifs = new NPOIFSFileSystem(pptFile);
        
        DirectoryNode[] files = { opoifs.getRoot(), npoifs.getRoot() };

        // Open directly
        for (DirectoryNode dir : files) {
            PowerPointExtractor extractor = new PowerPointExtractor(dir);
            assertEquals(expectText, extractor.getText());
        }

        // Open via a HSLFSlideShow
        for (DirectoryNode dir : files) {
            HSLFSlideShowImpl slideshow = new HSLFSlideShowImpl(dir);
            PowerPointExtractor extractor = new PowerPointExtractor(slideshow);
            assertEquals(expectText, extractor.getText());
            extractor.close();
            slideshow.close();
        }

        npoifs.close();
    }

