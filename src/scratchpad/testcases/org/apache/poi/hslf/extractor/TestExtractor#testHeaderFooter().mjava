    /**
     * From bug #45537
     */
    @Test
    public void testHeaderFooter() throws IOException {
        String text;

        // With a header on the notes
        InputStream is1 = slTests.openResourceAsStream("45537_Header.ppt");
        HSLFSlideShow ppt1 = new HSLFSlideShow(is1);
        is1.close();
        assertNotNull(ppt1.getNotesHeadersFooters());
        assertEquals("testdoc test phrase", ppt1.getNotesHeadersFooters().getHeaderText());

        PowerPointExtractor ppe1 = new PowerPointExtractor(ppt1.getSlideShowImpl());

        text = ppe1.getText();
        assertFalse("Header shouldn't be there by default\n" + text, text.contains("testdoc"));
        assertFalse("Header shouldn't be there by default\n" + text, text.contains("test phrase"));

        ppe1.setNotesByDefault(true);
        text = ppe1.getText();
        assertContains(text, "testdoc");
        assertContains(text, "test phrase");
        ppe1.close();
        ppt1.close();

        // And with a footer, also on notes
        InputStream is2 = slTests.openResourceAsStream("45537_Footer.ppt");
        HSLFSlideShow ppt2 = new HSLFSlideShow(is2);
        is2.close();
        
        assertNotNull(ppt2.getNotesHeadersFooters());
        assertEquals("testdoc test phrase", ppt2.getNotesHeadersFooters().getFooterText());
        ppt2.close();

        PowerPointExtractor ppe2 = openExtractor("45537_Footer.ppt");

        text = ppe2.getText();
        assertFalse("Header shouldn't be there by default\n" + text, text.contains("testdoc"));
        assertFalse("Header shouldn't be there by default\n" + text, text.contains("test phrase"));

        ppe2.setNotesByDefault(true);
        text = ppe2.getText();
        assertContains(text, "testdoc");
        assertContains(text, "test phrase");
        ppe2.close();
    }

