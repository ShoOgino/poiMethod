    /**
     * Test adding shapes to <code>ShapeGroup</code>
     */
    @Test
    public void shapeGroup() throws Exception {
        HSLFSlideShow ppt = new HSLFSlideShow();

        HSLFSlide slide = ppt.createSlide();
        Dimension pgsize = ppt.getPageSize();

        HSLFGroupShape group = new HSLFGroupShape();

        group.setAnchor(new Rectangle(0, 0, (int)pgsize.getWidth(), (int)pgsize.getHeight()));
        slide.addShape(group);

        int idx = ppt.addPicture(_slTests.readFile("clock.jpg"), HSLFPictureShape.JPEG);
        HSLFPictureShape pict = new HSLFPictureShape(idx, group);
        pict.setAnchor(new Rectangle(0, 0, 200, 200));
        group.addShape(pict);

        Line line = new Line(group);
        line.setAnchor(new Rectangle(300, 300, 500, 0));
        group.addShape(line);

        //serialize and read again.
        ByteArrayOutputStream  out = new ByteArrayOutputStream();
        ppt.write(out);
        out.close();

        ByteArrayInputStream is = new ByteArrayInputStream(out.toByteArray());
        ppt = new HSLFSlideShow(is);
        is.close();

        slide = ppt.getSlides()[0];

        HSLFShape[] shape = slide.getShapes();
        assertEquals(1, shape.length);
        assertTrue(shape[0] instanceof HSLFGroupShape);

        group = (HSLFGroupShape)shape[0];
        HSLFShape[] grshape = group.getShapes();
        assertEquals(2, grshape.length);
        assertTrue(grshape[0] instanceof HSLFPictureShape);
        assertTrue(grshape[1] instanceof Line);

        pict = (HSLFPictureShape)grshape[0];
        assertEquals(new Rectangle(0, 0, 200, 200), pict.getAnchor());

        line = (Line)grshape[1];
        assertEquals(new Rectangle(300, 300, 500, 0), line.getAnchor());
    }

