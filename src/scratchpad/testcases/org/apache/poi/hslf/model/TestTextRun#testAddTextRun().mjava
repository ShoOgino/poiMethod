	/**
	 * Test creation of TextRun objects.
	 */
	public void testAddTextRun() {
		HSLFSlideShow ppt = new HSLFSlideShow();
		HSLFSlide slide = ppt.createSlide();

		assertNull(slide.getTextRuns());

		HSLFTextBox shape1 = new HSLFTextBox();
		HSLFTextParagraph run1 = shape1.getTextParagraph();
		assertSame(run1, shape1.createTextRun());
		run1.setText("Text 1");
		slide.addShape(shape1);

		//The array of Slide's text runs must be updated when new text shapes are added.
		HSLFTextParagraph[] runs = slide.getTextRuns();
		assertNotNull(runs);
		assertSame(run1, runs[0]);

		HSLFTextBox shape2 = new HSLFTextBox();
		HSLFTextParagraph run2 = shape2.getTextParagraph();
		assertSame(run2, shape2.createTextRun());
		run2.setText("Text 2");
		slide.addShape(shape2);

		runs = slide.getTextRuns();
		assertEquals(2, runs.length);

		assertSame(run1, runs[0]);
		assertSame(run2, runs[1]);

		//as getShapes()
		HSLFShape[] sh = slide.getShapes();
		assertEquals(2, sh.length);
		assertTrue(sh[0] instanceof HSLFTextBox);
		HSLFTextBox box1 = (HSLFTextBox)sh[0];
		assertSame(run1, box1.getTextParagraph());
		HSLFTextBox box2 = (HSLFTextBox)sh[1];
		assertSame(run2, box2.getTextParagraph());

		//test Table - a complex group of shapes containing text objects
		HSLFSlide slide2 = ppt.createSlide();
		assertNull(slide2.getTextRuns());
		Table table = new Table(2, 2);
		slide2.addShape(table);
		runs = slide2.getTextRuns();
		assertNotNull(runs);
		assertEquals(4, runs.length);
	}

