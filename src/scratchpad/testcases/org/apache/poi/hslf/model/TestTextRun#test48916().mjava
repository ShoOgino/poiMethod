    public void test48916() throws IOException {
        HSLFSlideShow ppt = new HSLFSlideShow(_slTests.openResourceAsStream("SampleShow.ppt"));
        for(HSLFSlide slide : ppt.getSlides()){
            for(HSLFShape sh : slide.getShapes()){
                if(sh instanceof HSLFTextShape){
                    HSLFTextShape tx = (HSLFTextShape)sh;
                    HSLFTextParagraph run = tx.getTextParagraph();
                    //verify that records cached in  TextRun and EscherTextboxWrapper are the same
                    Record[] runChildren = run.getRecords();
                    Record[] txboxChildren = tx.getEscherTextboxWrapper().getChildRecords();
                    assertEquals(runChildren.length, txboxChildren.length);
                    for(int i=0; i < txboxChildren.length; i++){
                        assertSame(txboxChildren[i], runChildren[i]);
                    }
                    //caused NPE prior to fix of Bugzilla #48916 
                    run.getRichTextRuns()[0].setBold(true);
                    run.getRichTextRuns()[0].setFontColor(Color.RED);
                }
            }
        }
        ByteArrayOutputStream out = new ByteArrayOutputStream();
        ppt.write(out);
        ppt = new HSLFSlideShow(new ByteArrayInputStream(out.toByteArray()));
        for(HSLFSlide slide : ppt.getSlides()){
            for(HSLFShape sh : slide.getShapes()){
                if(sh instanceof HSLFTextShape){
                    HSLFTextShape tx = (HSLFTextShape)sh;
                    HSLFTextParagraph run = tx.getTextParagraph();
                    HSLFTextRun rt = run.getRichTextRuns()[0];
                    assertTrue(rt.isBold());
                    assertEquals(rt.getFontColor(), Color.RED);
                }
            }
        }

    }

