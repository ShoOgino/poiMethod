    @Test
    public void testAllFiles() throws Exception {
        String fileName = file.getName();
        if (EXCLUDED.containsKey(fileName)) {
            thrown.expect(EXCLUDED.get(fileName));
        }

        try {
            runOneFile(file);
        } catch (OldPowerPointFormatException e) {
            // expected for some files
            if(!OLD_FILES.contains(file.getName())) {
                throw e;
            }
        } catch (EncryptedPowerPointFileException e) {
            // expected for some files
            if(!ENCRYPTED_FILES.contains(file.getName())) {
                throw e;
            }
        }
    }

