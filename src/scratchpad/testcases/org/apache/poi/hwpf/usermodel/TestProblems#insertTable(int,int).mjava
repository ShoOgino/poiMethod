    private static void insertTable(int rows, int columns) {
        // POI apparently can't create a document from scratch,
        // so we need an existing empty dummy document
        HWPFDocument doc = HWPFTestDataSamples.openSampleFile("empty.doc");

        Range range = doc.getRange();
        Table table = range.insertBefore(new TableProperties(columns), rows);

        for (int rowIdx = 0; rowIdx < table.numRows(); rowIdx++) {
            TableRow row = table.getRow(rowIdx);
            for (int colIdx = 0; colIdx < row.numCells(); colIdx++) {
                TableCell cell = row.getCell(colIdx);
                Paragraph par = cell.getParagraph(0);
                par.insertBefore("" + (rowIdx * row.numCells() + colIdx));
            }
        }
    }

