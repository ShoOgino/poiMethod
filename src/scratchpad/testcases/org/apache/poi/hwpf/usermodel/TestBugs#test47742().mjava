    /**
     * Bug 4774 - text extracted by WordExtractor is broken
     */
    public void test47742() throws Exception
    {

        // (1) extract text from MS Word document via POI
        HWPFDocument doc = HWPFTestDataSamples.openSampleFile( "Bug47742.doc" );
        String foundText = new WordExtractor( doc ).getText();

        // (2) read text from text document (retrieved by saving the word
        // document as text file using encoding UTF-8)
        InputStream is = POIDataSamples.getDocumentInstance()
                .openResourceAsStream( "Bug47742-text.txt" );
        try {
            byte[] expectedBytes = IOUtils.toByteArray( is );
            String expectedText = new String( expectedBytes, "utf-8" )
                    .substring( 1 ); // strip-off the unicode marker
    
            assertEquals( expectedText, foundText );
        } finally {
            is.close();
        }
    }

