    @Test(expected=IllegalStateException.class)
    public void testInvalidInPlaceWriteOPOIFS() throws Exception {
        // Can't work for OPOIFS
        OPOIFSFileSystem ofs = new OPOIFSFileSystem(SAMPLES.openResourceAsStream("SampleDoc.doc"));
        HWPFDocument doc = new HWPFDocument(ofs.getRoot());
        try {
            doc.write();
        } finally {
            doc.close();
        }
    }

