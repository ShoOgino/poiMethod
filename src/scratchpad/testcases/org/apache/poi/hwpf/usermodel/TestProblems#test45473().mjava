    /**
     * Bug 45473 - HWPF cannot read file after save
     */
    public void test45473() {
        HWPFDocument doc1 = HWPFTestDataSamples.openSampleFile("Bug45473.doc");
        String text1 = new WordExtractor(doc1).getText().trim();

        HWPFDocument doc2 = HWPFTestDataSamples.writeOutAndReadBack(doc1);
        String text2 = new WordExtractor(doc2).getText().trim();

        // the text in the saved document has some differences in line separators but we tolerate that
        assertEquals(text1.replaceAll("\n", ""), text2.replaceAll("\n", ""));
    }

