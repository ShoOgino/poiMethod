    private static String getHtmlText(final String sampleFileName,
            boolean emulatePictureStorage) throws Exception {
        HWPFDocument hwpfDocument = new HWPFDocument(POIDataSamples
                .getDocumentInstance().openResourceAsStream(sampleFileName));

        Document newDocument = XMLHelper.getDocumentBuilderFactory().newDocumentBuilder().newDocument();
        WordToHtmlConverter wordToHtmlConverter = new WordToHtmlConverter(
                newDocument);

        if (emulatePictureStorage)
        {
            wordToHtmlConverter.setPicturesManager((content, pictureType, suggestedName, widthInches, heightInches) -> suggestedName);
        }

        wordToHtmlConverter.processDocument(hwpfDocument);

        StringWriter stringWriter = new StringWriter();

        Transformer transformer = TransformerFactory.newInstance()
                .newTransformer();
        transformer.setOutputProperty(OutputKeys.INDENT, "yes");
        transformer.setOutputProperty(OutputKeys.ENCODING, "utf-8");
        transformer.setOutputProperty(OutputKeys.METHOD, "html");
        transformer.transform(
                new DOMSource(wordToHtmlConverter.getDocument()),
                new StreamResult(stringWriter));

        return stringWriter.toString();
    }

