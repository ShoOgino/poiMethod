    /**
     * Tests that we can work with both {@link POIFSFileSystem}
     *  and {@link NPOIFSFileSystem}
     */
    @Test
    public void testDifferentPOIFS() throws Exception {
       // Open the two filesystems
       File file = docTests.getFile("test2.doc");
       InputStream is = new FileInputStream(file);
       OPOIFSFileSystem opoifs = new OPOIFSFileSystem(is);
       is.close();
       NPOIFSFileSystem npoifs = new NPOIFSFileSystem(file);
       
       DirectoryNode[] files = { opoifs.getRoot(), npoifs.getRoot() };
       
       // Open directly 
       for(DirectoryNode dir : files) {
          WordExtractor extractor = new WordExtractor(dir);
          assertEqualsTrim(p_text1_block, extractor.getText());
       }

       // Open via a HWPFDocument
       for(DirectoryNode dir : files) {
          HWPFDocument doc = new HWPFDocument(dir);
          WordExtractor extractor = new WordExtractor(doc);
          assertEqualsTrim(p_text1_block, extractor.getText());
          extractor.close();
       }
       
       npoifs.close();
    }

