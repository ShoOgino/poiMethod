   /**
    * Test that we can handle both PDF and MSG attachments
    */
   public void testReadMsgAttachments() throws Exception {
       AttachmentChunks[] attachments = pdfMsgAttachments.getAttachmentFiles();
       assertEquals(2, attachments.length);
       
       AttachmentChunks attachment;

       // Second is a PDF
       attachment = pdfMsgAttachments.getAttachmentFiles()[1];
       assertEquals("smbprn~1.pdf", attachment.getAttachFileName().toString());
       assertEquals("smbprn.00009008.KdcPjl.pdf", attachment.getAttachLongFileName().toString());
       assertEquals(".pdf", attachment.getAttachExtension().getValue());
       assertEquals(null, attachment.getAttachMimeTag());
       assertEquals(null, attachment.getAttachmentDirectory());
       assertEquals(13539, attachment.getAttachData().getValue().length);
       
       // First in a nested message
       attachment = pdfMsgAttachments.getAttachmentFiles()[0];
       assertEquals("Test Attachment", attachment.getAttachFileName().toString());
       assertEquals(null, attachment.getAttachLongFileName());
       assertEquals(null, attachment.getAttachExtension());
       assertEquals(null, attachment.getAttachMimeTag());
       assertEquals(null, attachment.getAttachData());
       assertNotNull(attachment.getAttachmentDirectory());
       
       // Check we can see some bits of it
       MAPIMessage nested = attachment.getAttachmentDirectory().getAsEmbededMessage();
       assertEquals(1, nested.getRecipientNamesList().length);
       assertEquals("Nick Booth", nested.getRecipientNames());
       assertEquals("Test Attachment", nested.getConversationTopic());
   }

