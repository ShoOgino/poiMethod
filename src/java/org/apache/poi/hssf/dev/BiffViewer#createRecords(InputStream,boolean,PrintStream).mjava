    /**
     *  Create an array of records from an input stream
     *
     *@param  in                         the InputStream from which the records
     *      will be obtained
     *@param  dump
     *@return                            an array of Records created from the
     *      InputStream
     *@exception  RecordFormatException  on error processing the InputStream
     */
    public static Record[] createRecords(InputStream in, boolean dump, PrintStream ps)
             throws RecordFormatException {
        ArrayList records = new ArrayList();
        RecordDetails activeRecord = null;

        BiffviewRecordInputStream recStream = new BiffviewRecordInputStream(in);
        while (recStream.hasNextRecord()) {
            recStream.nextRecord();
            if (recStream.getSid() != 0) {
                Record record = createRecord (recStream);
                    if (record.getSid() != ContinueRecord.sid)
                    {
                        records.add(record);
                        if (activeRecord != null)
                            activeRecord.dump(ps);
                        int startPos = (int)(recStream.getPos()-recStream.getLength() - 4);
                        activeRecord = new RecordDetails(recStream.getSid(), recStream.getLength(), startPos, record);
                    }
                    if (dump) {
                        recStream.dumpBytes(ps);
                    }
              }
        }
        if (activeRecord != null) {
            activeRecord.dump(ps);
        }
        Record[] retval = new Record[records.size()];
        records.toArray(retval);
        return retval;
    }

