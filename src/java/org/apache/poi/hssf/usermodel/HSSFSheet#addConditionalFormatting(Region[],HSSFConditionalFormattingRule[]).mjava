     /**
      * Allows to add a new Conditional Formatting set to the sheet.
      *
      * @param regions - list of rectangular regions to apply conditional formatting rules
      * @param hcfRules - set of up to three conditional formatting rules
      *
      * @return index of the newly created Conditional Formatting object
      */

    public int addConditionalFormatting(Region [] regions, HSSFConditionalFormattingRule [] hcfRules) {
        if (regions == null) {
            throw new IllegalArgumentException("regions must not be null");
        }
        if (hcfRules == null) {
            throw new IllegalArgumentException("hcfRules must not be null");
        }

        CFRuleRecord[] rules = new CFRuleRecord[hcfRules.length];
        for (int i = 0; i != hcfRules.length; i++) {
            rules[i] = hcfRules[i].getCfRuleRecord();
        }
        CFRecordsAggregate cfra = new CFRecordsAggregate(regions, rules);
        return sheet.addConditionalFormatting(cfra);
     }

