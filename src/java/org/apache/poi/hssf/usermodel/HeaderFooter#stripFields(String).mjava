    /**
     * Removes any fields (eg macros, page markers etc)
     *  from the string.
     * Normally used to make some text suitable for showing
     *  to humans, and the resultant text should not normally
     *  be saved back into the document!
     */
    public static String stripFields(String text) {
    	int pos;
    	
    	// Check we really got something to work on
    	if(text == null || text.length() == 0) {
    		return text;
    	}
    	
    	// Firstly, do the easy ones which are static
    	for(int i=0; i<Field.ALL_FIELDS.size(); i++) {
    		String seq = ((Field)Field.ALL_FIELDS.get(i)).sequence;
    		while((pos = text.indexOf(seq)) > -1) {
    			text = text.substring(0, pos) +
    				text.substring(pos+seq.length());
    		}
    	}
    	
    	// Now do the tricky, dynamic ones
    	// These are things like font sizes and font names
    	text = text.replaceAll("\\&\\d+", "");
    	text = text.replaceAll("\\&\".*?,.*?\"", "");
    	
    	// All done
    	return text;
    }

