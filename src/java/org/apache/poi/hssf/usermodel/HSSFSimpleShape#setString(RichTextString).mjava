    /**
     * @param string Sets the rich text string used by this object.
     */
    public void setString(RichTextString string) {
        //TODO add other shape types which can not contain text
        if (getShapeType() == 0 || getShapeType() == OBJECT_TYPE_LINE){
            throw new IllegalStateException("Cannot set text for shape type: "+getShapeType());
        }
        HSSFRichTextString rtr = (HSSFRichTextString) string;
        // If font is not set we must set the default one
        if (rtr.numFormattingRuns() == 0) rtr.applyFont((short) 0);
        EscherTextboxRecord textbox = getEscherContainer().getChildById(EscherTextboxRecord.RECORD_ID);
        if (string.getString()!= null && !string.getString().equals("")){
            if (null == textbox){
                EscherTextboxRecord escherTextbox = new EscherTextboxRecord();
                escherTextbox.setRecordId(EscherTextboxRecord.RECORD_ID);
                escherTextbox.setOptions((short) 0x0000);
                getEscherContainer().addChildRecord(escherTextbox);
                _patriarch._getBoundAggregate().associateShapeToObjRecord(getEscherContainer().getChildById(EscherTextboxRecord.RECORD_ID), getTextObjectRecord());
            }
        } else {
            if (null != textbox){
                getEscherContainer().removeChildRecord(textbox);
                _patriarch._getBoundAggregate().removeShapeToObjRecord(textbox);
            }
        }
        _textObjectRecord.setStr(rtr);
    }

