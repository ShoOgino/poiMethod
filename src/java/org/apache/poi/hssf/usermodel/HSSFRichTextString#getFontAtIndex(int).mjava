    /**
     * Returns the font in use at a particular index.
     *
     * @param index         The index.
     * @return              The font that's currently being applied at that
     *                      index or null if no font is being applied or the
     *                      index is out of range.
     */
    public short getFontAtIndex( int index )
    {
        if (index < 0 || index >= string.length())
            throw new ArrayIndexOutOfBoundsException("Font index " + index + " out of bounds of string");
        Integer key = new Integer(index + 1);
        SortedMap head = formattingRuns.headMap(key);
        if (head.isEmpty())
            throw new IllegalStateException("Should not reach here.  No font found.");
        else
            return ((Short) head.get(head.lastKey())).shortValue();
    }

