	private Format getFormat(double cellValue, int formatIndex, String formatStr) {
		Format format = (Format)formats.get(formatStr);
		if (format != null) {
			return format;
		} else if (formatStr.equals("General")) {
			if (HSSFDataFormatter.isWholeNumber(cellValue)) {
				return generalWholeNumFormat;
			} else {
				return generalDecimalNumFormat;
			}
		} else {
			format = createFormat(cellValue, formatIndex, formatStr);
			formats.put(formatStr, format);
			return format;
		}
	}

