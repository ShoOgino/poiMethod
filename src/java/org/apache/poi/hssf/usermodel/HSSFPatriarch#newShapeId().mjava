    int newShapeId() {
        if (_boundAggregate.getEscherContainer() == null){
            throw new IllegalStateException("We can use this method for only existing files");
        }
        DrawingManager2 dm = _boundAggregate.getDrawingManager();
        EscherDgRecord dg =
                _boundAggregate.getEscherContainer().getChildById(EscherDgRecord.RECORD_ID);
        short drawingGroupId = dg.getDrawingGroupId();
        return dm.allocateShapeId(drawingGroupId, dg);
    }

