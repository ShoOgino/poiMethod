    public HSSFCell[] removeArrayFormula(Cell cell) {
        ArrayList<HSSFCell> lst = new ArrayList<HSSFCell>();
        CellValueRecordInterface rec = ((HSSFCell) cell).getCellValueRecord();
        if (!(rec instanceof FormulaRecordAggregate)) {
            String ref = new CellReference(cell).formatAsString();
            throw new IllegalArgumentException("Cell " + ref + " is not part of an array formula");
        }
        FormulaRecordAggregate fra = (FormulaRecordAggregate) rec;
        CellRangeAddress range = fra.removeArrayFormula(cell.getRowIndex(), cell.getColumnIndex());
        if (range == null) {
            String ref = new CellReference(cell).formatAsString();
            throw new IllegalArgumentException("Cell " + ref + " is not part of an array formula");
        }
        // clear all cells in the range
        for (int rowIn = range.getFirstRow(); rowIn <= range.getLastRow(); rowIn++) {
            for (int colIn = range.getFirstColumn(); colIn <= range.getLastColumn(); colIn++) {
                HSSFCell rCell = getRow(rowIn).getCell(colIn);
                rCell.setCellType(Cell.CELL_TYPE_BLANK);
                lst.add(rCell);
             }
        }
        return lst.toArray(new HSSFCell[lst.size()]);
    }

