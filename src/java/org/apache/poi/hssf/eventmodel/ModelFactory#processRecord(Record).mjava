    //ERFListener
    public boolean processRecord(Record rec) {
        if (rec.getSid() == BOFRecord.sid) {
            if (lastEOF != true) {
                throw new RuntimeException("Not yet handled embedded models");
            }
            BOFRecord bof = (BOFRecord)rec;
            switch (bof.getType()) {
                case BOFRecord.TYPE_WORKBOOK:
                    currentmodel = new Workbook();
                    break;
                case BOFRecord.TYPE_WORKSHEET:
                    currentmodel = Sheet.createSheet();
                    break;
                default:
                   throw new RuntimeException("Unsupported model type "+bof.getType());
            }
        }

        if (rec.getSid() == EOFRecord.sid) {
            lastEOF = true;
            throwEvent(currentmodel);
        } else {
            lastEOF = false;
        }
        return true;
    }

