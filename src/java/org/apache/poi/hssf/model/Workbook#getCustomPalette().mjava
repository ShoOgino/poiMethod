    /**
     * Returns the custom palette in use for this workbook; if a custom palette record
     * does not exist, then it is created.
     */
    public PaletteRecord getCustomPalette()
    {
        PaletteRecord palette;
        Record rec = records.get(records.getPalettepos());
        if (rec instanceof PaletteRecord)
        {
            palette = (PaletteRecord) rec;
        }
        else
        {
            palette = createPalette();
            records.add(records.getPalettepos(), palette);
        }
        return palette;
    }

