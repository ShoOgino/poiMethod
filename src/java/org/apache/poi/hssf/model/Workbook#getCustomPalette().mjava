    /**
     * Returns the custom palette in use for this workbook; if a custom palette record
     * does not exist, then it is created.
     */
    public PaletteRecord getCustomPalette()
    {
        PaletteRecord palette;
        Record rec = (Record) records.get(palettepos);
        if (rec instanceof PaletteRecord)
        {
            palette = (PaletteRecord) rec;
        }
        else
        {
            palette = createPalette();
            records.add(palettepos, palette);
            ++bspos;
        }
        return palette;
    }

