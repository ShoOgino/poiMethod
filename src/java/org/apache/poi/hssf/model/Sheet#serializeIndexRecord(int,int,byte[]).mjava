    /**
     * @param indexRecordOffset also happens to be the end of the BOF record
     * @return the size of the serialized INDEX record
     */
    private int serializeIndexRecord(int bofRecordIndex, int indexRecordOffset, byte[] data) {

        // 'initial sheet records' are between INDEX and first ROW record.
        int sizeOfInitialSheetRecords = 0;
        // start just after BOF record (INDEX is not present in this list)
        for (int j = bofRecordIndex + 1; j < records.size(); j++) {
            RecordBase tmpRec = ((RecordBase) records.get(j));
            if (tmpRec instanceof UncalcedRecord) {
                continue;
            }
            if (tmpRec instanceof RowRecordsAggregate) {
                break;
            }
            sizeOfInitialSheetRecords += tmpRec.getRecordSize();
        }
        if (_isUncalced) {
            sizeOfInitialSheetRecords += UncalcedRecord.getStaticRecordSize();
        }
        IndexRecord index = _rowsAggregate.createIndexRecord(indexRecordOffset, sizeOfInitialSheetRecords);
        return index.serialize(indexRecordOffset, data);
    }

