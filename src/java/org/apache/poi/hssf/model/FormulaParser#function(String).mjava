    /**
     * Note - Excel function names are 'case aware but not case sensitive'.  This method may end
     * up creating a defined name record in the workbook if the specified name is not an internal
     * Excel function, and has not been encountered before. 
     * 
     * @param name case preserved function name (as it was entered/appeared in the formula). 
     */
    private Ptg function(String name) {
        int numArgs =0 ;
        // Note regarding parameter - 
        if(!AbstractFunctionPtg.isInternalFunctionName(name)) {
            // external functions get a Name token which points to a defined name record
            NamePtg nameToken = new NamePtg(name, this.book);
            
            // in the token tree, the name is more or less the first argument
            numArgs++;  
            tokens.add(nameToken);
        }
        //average 2 args per function
        List argumentPointers = new ArrayList(2);

        Match('(');
        numArgs += Arguments(argumentPointers);
        Match(')');

        return getFunction(name, numArgs, argumentPointers);
    }

