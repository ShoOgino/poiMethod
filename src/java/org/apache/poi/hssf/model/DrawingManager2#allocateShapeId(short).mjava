    /**
     * Allocates new shape id for the drawing group id.
     * 
     * @param drawingGroupId the drawing group id
     * 
     * @return a new shape id
     * 
     * @deprecated in POI 3.17-beta2, use allocateShapeId(EscherDgRecord) 
     */
    @Deprecated
    @Removal(version="4.0")
    public int allocateShapeId(short drawingGroupId) {
        for (EscherDgRecord dg : drawingGroups) {
            if (dg.getDrawingGroupId() == drawingGroupId) {
                return allocateShapeId(dg);
            }
        }
        throw new IllegalStateException("Drawing group id "+drawingGroupId+" doesn't exist.");
    }

