    public int serialize(int offset, byte [] data) {
    	int dataSize = getDataSize();
        LittleEndian.putUShort(data, 0 + offset, sid);
        LittleEndian.putUShort(data, 2 + offset, dataSize);
        LittleEndian.putByte(data, 4 + offset,  getPane());
        LittleEndian.putUShort(data, 5 + offset, getActiveCellRow());
        LittleEndian.putUShort(data, 7 + offset, getActiveCellCol());
        LittleEndian.putUShort(data, 9 + offset, getActiveCellRef());
        int nRefs = field_6_refs.length;
        LittleEndian.putUShort(data, 11 + offset, nRefs);
        for (int i = 0; i < field_6_refs.length; i++) {
			Reference r = field_6_refs[i];
			r.serialize(offset + 13 + i * Reference.ENCODED_SIZE, data);
		}
        return 4 + dataSize;
    }

