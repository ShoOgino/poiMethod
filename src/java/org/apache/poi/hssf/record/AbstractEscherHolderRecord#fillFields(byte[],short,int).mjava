    protected void fillFields(byte [] data, short size, int offset)
    {
        escherRecords = new ArrayList();
        if (! DESERIALISE )
        {
            rawData = new byte[size];
            System.arraycopy(data, offset, rawData, 0, size);
        }
        else
        {
            EscherRecordFactory recordFactory = new DefaultEscherRecordFactory();
            int pos = offset;
            while ( pos < offset + size )
            {
                EscherRecord r = recordFactory.createRecord(data, pos);
                int bytesRead = r.fillFields(data, pos, recordFactory );
                escherRecords.add(r);
                pos += bytesRead;
            }
        }
    }

