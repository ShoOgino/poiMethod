  /** Moves to the next record in the stream.
   *
   * <i>Note: The auto continue flag is reset to true</i>
   */
  public void nextRecord() throws RecordFormatException {
    if ((currentLength != -1) && (currentLength != recordOffset)) {
      System.out.println("WARN. Unread "+remaining()+" bytes of record 0x"+Integer.toHexString(currentSid));
    }
    currentSid = nextSid;
    pos += LittleEndian.SHORT_SIZE;
    autoContinue = true;
    try {
      recordOffset = 0;
      currentLength = LittleEndian.readShort(in);
      if (currentLength > MAX_RECORD_DATA_SIZE)
        throw new RecordFormatException("The content of an excel record cannot exceed "+MAX_RECORD_DATA_SIZE+" bytes");
      pos += LittleEndian.SHORT_SIZE;
      in.read(data, 0, currentLength);

      //Read the Sid of the next record
      if (in.available() < EOFRecord.ENCODED_SIZE) {
          if (in.available() > 0) {
              // some scrap left over?
              // ex45582-22397.xls has one extra byte after the last record
              // Excel reads that file OK
          }
          nextSid = INVALID_SID_VALUE;
      } else {
          nextSid = LittleEndian.readShort(in);
          if (nextSid == INVALID_SID_VALUE) {
              throw new RecordFormatException("Found sid " + nextSid + " after record with sid 0x"
                      + Integer.toHexString(currentSid).toUpperCase());
          }
      }
    } catch (IOException ex) {
      throw new RecordFormatException("Error reading bytes", ex);
    }
  }

