    @Override
    public CFRule12Record clone() {
        CFRule12Record rec = new CFRule12Record(getConditionType(), getComparisonOperation());
        rec.futureHeader.setAssociatedRange(futureHeader.getAssociatedRange().copy());
        
        super.copyTo(rec);

        // use min() to gracefully handle cases where the length-property and the array-length do not match
        // we saw some such files in circulation
        rec.ext_formatting_length = Math.min(ext_formatting_length, ext_formatting_data.length);
        rec.ext_formatting_data = new byte[ext_formatting_length];
        System.arraycopy(ext_formatting_data, 0, rec.ext_formatting_data, 0, rec.ext_formatting_length);
        
        rec.formula_scale = formula_scale.copy();
        
        rec.ext_opts = ext_opts;
        rec.priority = priority;
        rec.template_type = template_type;
        rec.template_param_length = template_param_length;
        rec.template_params = new byte[template_param_length];
        System.arraycopy(template_params, 0, rec.template_params, 0, template_param_length);

        if (color_gradient != null) {
            rec.color_gradient = (ColorGradientFormatting)color_gradient.clone();
        }
        if (multistate != null) {
            rec.multistate = (IconMultiStateFormatting)multistate.clone();
        }
        if (data_bar != null) {
            rec.data_bar = (DataBarFormatting)data_bar.clone();
        }
        if (filter_data != null) {
            rec.filter_data = new byte[filter_data.length];
            System.arraycopy(filter_data, 0, rec.filter_data, 0, filter_data.length);
        }
        
        return rec;
    }

