	private boolean hasFormula() {
		// TODO - determine exact conditions when formula is present
		if (false) {
			// "Microsoft Office Excel 97-2007 Binary File Format (.xls) Specification"
			// m$'s document suggests logic like this, but bugzilla 44774 att 21790 seems to disagree
			if (isStdDocumentNameIdentifier()) {
				if (isOLELink()) {
					// seems to be not possible according to m$ document
					throw new IllegalStateException(
							"flags (std-doc-name and ole-link) cannot be true at the same time");
				}
				return false;
			}
			if (isOLELink()) {
				return false;
			}
			return true;
		}

		// This was derived by trial and error, but doesn't seem quite right
		if (isAutomaticLink()) {
			return false;
		}
		return true;
	}

