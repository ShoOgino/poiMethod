    void initCipherForBlock(Cipher rc4, int keyBlockNo) {
        byte buf[] = new byte[LittleEndianConsts.INT_SIZE]; 
        LittleEndian.putInt(buf, 0, keyBlockNo);
        
        MessageDigest md5 = CryptoFunctions.getMessageDigest(HashAlgorithm.md5);
        md5.update(_secretKey.getEncoded());
        md5.update(buf);

        SecretKeySpec skeySpec = new SecretKeySpec(md5.digest(), _secretKey.getAlgorithm());
        try {
            rc4.init(Cipher.ENCRYPT_MODE, skeySpec);
        } catch (GeneralSecurityException e) {
            throw new EncryptedDocumentException("Can't rekey for next block", e);
        }
    }

