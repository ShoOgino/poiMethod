	private void encryptBytes(byte data[], int offset, final int bytesToRead)  {
	    if (bytesToRead == 0) return;
	    
	    if (_shouldSkipEncryptionOnCurrentRecord) {
            // even when encryption is skipped, we need to update the cipher
	        byte dataCpy[] = new byte[bytesToRead];
	        System.arraycopy(data, offset, dataCpy, 0, bytesToRead);
	        data = dataCpy;
	        offset = 0;
	    }
	    
        try {
            _rc4.update(data, offset, bytesToRead, data, offset);
        } catch (ShortBufferException e) {
            throw new EncryptedDocumentException("input buffer too small", e);
        }
	}

