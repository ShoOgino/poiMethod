	public Biff8DecryptingStream(InputStream in, int initialOffset, Biff8EncryptionKey key) {
	    if (key instanceof Biff8RC4Key) {
	        _cipher = new Biff8RC4(initialOffset, (Biff8RC4Key)key);
	    } else if (key instanceof Biff8XORKey) {
	        _cipher = new Biff8XOR(initialOffset, (Biff8XORKey)key);
	    } else {
	        throw new EncryptedDocumentException("Crypto API not supported yet.");
	    }

		if (in instanceof LittleEndianInput) {
			// accessing directly is an optimisation
			_le = (LittleEndianInput) in;
		} else {
			// less optimal, but should work OK just the same. Often occurs in junit tests.
			_le = new LittleEndianInputStream(in);
		}
	}

