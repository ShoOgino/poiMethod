    private void appendFormula(StringBuffer sb, String label, Stack stack) {
        sb.append(label);
        if (stack.isEmpty()) {
            sb.append("<empty>\n");
            return;
        }
        sb.append("\n");
        Ptg[] ptgs = new Ptg[stack.size()];
        stack.toArray(ptgs);
        for (int i = 0; i < ptgs.length; i++) {
            sb.append('\t').append(ptgs[i].toString()).append('\n');
        }
    }

