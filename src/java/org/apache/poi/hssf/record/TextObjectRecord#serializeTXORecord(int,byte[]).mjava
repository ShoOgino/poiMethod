	private int serializeTXORecord(int offset, byte[] data) {
		int dataSize = getDataSize();
		
		LittleEndian.putUShort(data, 0 + offset, TextObjectRecord.sid);
		LittleEndian.putUShort(data, 2 + offset, dataSize);

		
		LittleEndian.putUShort(data, 4 + offset, field_1_options);
		LittleEndian.putUShort(data, 6 + offset, field_2_textOrientation);
		LittleEndian.putUShort(data, 8 + offset, field_3_reserved4);
		LittleEndian.putUShort(data, 10 + offset, field_4_reserved5);
		LittleEndian.putUShort(data, 12 + offset, field_5_reserved6);
		LittleEndian.putUShort(data, 14 + offset, _text.length());
		LittleEndian.putUShort(data, 16 + offset, getFormattingDataLength());
		LittleEndian.putInt(data, 18 + offset, field_8_reserved7);
		
		if (_linkRefPtg != null) {
			int pos = offset+22;
			int formulaSize = _linkRefPtg.getSize();
			LittleEndian.putUShort(data, pos, formulaSize);
			pos += LittleEndian.SHORT_SIZE;
			LittleEndian.putInt(data, pos, _unknownPreFormulaInt);
			pos += LittleEndian.INT_SIZE;
			_linkRefPtg.writeBytes(data, pos);
			pos += formulaSize;
			if (_unknownPostFormulaByte != null) {
				LittleEndian.putByte(data, pos, _unknownPostFormulaByte.byteValue());
				pos += LittleEndian.BYTE_SIZE;
			}
		}
		
		return 4 + dataSize;
	}

