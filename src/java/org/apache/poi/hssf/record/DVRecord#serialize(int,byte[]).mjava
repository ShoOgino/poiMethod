	public int serialize(int offset, byte [] data) {
		int size = this.getRecordSize();
		LittleEndian.putShort(data, 0 + offset, sid);
		LittleEndian.putShort(data, 2 + offset, ( short ) (size-4));

		int pos = 4;
		LittleEndian.putInt(data, pos + offset, _option_flags);
		pos += 4;
		
		pos += serializeUnicodeString(_promptTitle, pos+offset, data);
		pos += serializeUnicodeString(_errorTitle, pos+offset, data);
		pos += serializeUnicodeString(_promptText, pos+offset, data);
		pos += serializeUnicodeString(_errorText, pos+offset, data);
		LittleEndian.putUShort(data, offset+pos, Ptg.getEncodedSize(_formula1));
		pos += 2;
		LittleEndian.putUShort(data, offset+pos, _not_used_1);
		pos += 2;

		pos += Ptg.serializePtgs(_formula1, data, pos+offset);

		LittleEndian.putUShort(data, offset+pos, Ptg.getEncodedSize(_formula2));
		pos += 2;
		LittleEndian.putShort(data, offset+pos, _not_used_2);
		pos += 2;
		pos += Ptg.serializePtgs(_formula2, data, pos+offset);
		_regions.serialize(pos+offset, data);
		return size;
	}

