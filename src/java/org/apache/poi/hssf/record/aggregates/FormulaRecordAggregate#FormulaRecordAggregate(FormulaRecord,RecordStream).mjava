    public FormulaRecordAggregate(FormulaRecord formulaRecord, RecordStream rs) {
        _formulaRecord = formulaRecord;
        Class nextClass = rs.peekNextClass();
        if (nextClass == SharedFormulaRecord.class) {
            // For (text) shared formulas, the SharedFormulaRecord comes before the StringRecord.
            // In any case it is OK to skip SharedFormulaRecords because they were collected 
            // before constructing the ValueRecordsAggregate.
            rs.getNext(); // skip the shared formula record
            nextClass = rs.peekNextClass();
        }
        if (nextClass == StringRecord.class) {
            _stringRecord = (StringRecord) rs.getNext();
        } else if (nextClass == TableRecord.class) {
            _tableRecord = (TableRecord) rs.getNext();
        }
    }

