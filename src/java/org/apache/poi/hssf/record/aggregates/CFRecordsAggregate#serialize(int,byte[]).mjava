	/**
	 * called by the class that is responsible for writing this sucker.
	 * Subclasses should implement this so that their data is passed back in a
	 * byte array.
	 *
	 * @param offset to begin writing at
	 * @param data byte array containing instance data
	 * @return number of bytes written
	 */

	public int serialize(int offset, byte[] data)
	{
		int pos = offset;
		if( header != null && rules.size()>0 )
		{
			header.setNumberOfConditionalFormats(rules.size());

			pos += (( Record ) header).serialize(pos, data);

			for(Iterator itr = rules.iterator(); itr.hasNext();)
			{
				pos += (( Record ) itr.next()).serialize(pos, data);
			}
		}
		return pos - offset;
	}

