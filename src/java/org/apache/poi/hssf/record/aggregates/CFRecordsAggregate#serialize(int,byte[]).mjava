	/**
	 * called by the class that is responsible for writing this sucker.
	 * Subclasses should implement this so that their data is passed back in a
	 * byte array.
	 *
	 * @param offset to begin writing at
	 * @param data byte array containing instance data
	 * @return number of bytes written
	 */

	public int serialize(int offset, byte[] data)
	{
		int nRules = rules.size();
		header.setNumberOfConditionalFormats(nRules);

		int pos = offset;

		pos += header.serialize(pos, data);
		for(int i=0; i< nRules; i++) {
			pos += getRule(i).serialize(pos, data);
		}
		return pos - offset;
	}

