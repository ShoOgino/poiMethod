    public int visitCellsForRow(int rowIndex, RecordVisitor rv) {
        int result = 0;
        CellValueRecordInterface[] cellRecs = records[rowIndex];
        if (cellRecs != null) {
            for (int i = 0; i < cellRecs.length; i++) {
                CellValueRecordInterface cvr = cellRecs[i];
                if (cvr == null) {
                    continue;
                }
                if (cvr instanceof FormulaRecordAggregate) {
                    FormulaRecordAggregate fmAgg = (FormulaRecordAggregate) cvr;
                    Record fmAggRec = fmAgg.getFormulaRecord();
                    rv.visitRecord(fmAggRec);
                    result += fmAggRec.getRecordSize();
                    fmAggRec = fmAgg.getStringRecord();
                    if (fmAggRec != null) {
                        rv.visitRecord(fmAggRec);
                        result += fmAggRec.getRecordSize();
                    }
                } else {
                    Record rec = (Record) cvr;
                    rv.visitRecord(rec);
                    result += rec.getRecordSize();
                }
            }
        }
        return result;
    }

