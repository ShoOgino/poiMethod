	private static byte[] createFormatData(HSSFRichTextString str) {
		int nRuns = str.numFormattingRuns();
		byte[] result = new byte[(nRuns + 1) * FORMAT_RUN_ENCODED_SIZE];
		int pos = 0;
		for (int i = 0; i < nRuns; i++) {
			LittleEndian.putUShort(result, pos, str.getIndexOfFormattingRun(i));
			pos += 2;
			int fontIndex = str.getFontOfFormattingRun(i);
			LittleEndian.putUShort(result, pos, fontIndex == str.NO_FONT ? 0 : fontIndex);
			pos += 2;
			pos += 4; // skip reserved
		}
		LittleEndian.putUShort(result, pos, str.length());
		pos += 2;
		LittleEndian.putUShort(result, pos, 0);
		pos += 2;
		pos += 4; // skip reserved

		return result;
	}

