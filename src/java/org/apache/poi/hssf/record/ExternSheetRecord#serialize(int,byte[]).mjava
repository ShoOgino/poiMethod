    /**
     * called by the class that is responsible for writing this sucker.
     * Subclasses should implement this so that their data is passed back in a
     * byte array.
     *
     * @param offset to begin writing at
     * @param data byte array containing instance data
     * @return number of bytes written     */
    public int serialize( int offset, byte[] data )
    {
        LittleEndian.putShort( data, 0 + offset, sid );
        LittleEndian.putShort( data, 2 + offset, (short) ( 2 + ( getNumOfREFRecords() * 6 ) ) );
        LittleEndian.putShort( data, 4 + offset, getNumOfREFStructures() );
        int pos = 6;
        for ( int k = 0; k < getNumOfREFRecords(); k++ )
        {
            ExternSheetSubRecord record = getREFRecordAt( k );
            System.arraycopy( record.serialize(), 0, data, pos + offset, 6 );
            pos += 6;
        }
        return getRecordSize();
    }

