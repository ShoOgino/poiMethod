    /**
     * @return text representation of this cell reference that can be used in text 
     * formulas. The sheet name will get properly delimited if required.
     */
    public String toFormulaString(Workbook book)
    {
        StringBuffer retval = new StringBuffer();
        String sheetName = book.findSheetNameFromExternSheet(field_1_index_extern_sheet);
        if(sheetName != null) {
            SheetNameFormatter.appendFormat(retval, sheetName);
            retval.append( '!' );
        }
        retval.append((new CellReference(getRow(),getColumn(),!isRowRelative(),!isColRelative())).formatAsString()); 
        return retval.toString();
    }

