	public Eval evaluate(Eval[] args, int srcCellRow, short srcCellCol) {
		switch(args.length) {
			case 2:
				// expected
				break;
			default:
				// TODO - it doesn't seem to be possible to enter COUNTIF() into Excel with the wrong arg count
				// perhaps this should be an exception
				return ErrorEval.VALUE_INVALID;
		}

		Eval criteriaArg = args[1];
		if(criteriaArg instanceof RefEval) {
			// criteria is not a literal value, but a cell reference
			// for example COUNTIF(B2:D4, E1)
			RefEval re = (RefEval)criteriaArg;
			criteriaArg = re.getInnerValueEval();
		} else {
			// other non literal tokens such as function calls, have been fully evaluated
			// for example COUNTIF(B2:D4, COLUMN(E1))
		}
		if(criteriaArg instanceof BlankEval) {
			// If the criteria arg is a reference to a blank cell, countif always returns zero.
			return NumberEval.ZERO;
		}
		I_MatchPredicate mp = createCriteriaPredicate(criteriaArg);
		return countMatchingCellsInArea(args[0], mp);
	}

