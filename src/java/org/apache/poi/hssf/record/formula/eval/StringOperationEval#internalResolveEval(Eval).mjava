    private ValueEval internalResolveEval(Eval eval) {
        ValueEval retval;
        if (eval instanceof StringValueEval) {
            retval = (StringValueEval) eval;
        }
        else if (eval instanceof RefEval) {
            RefEval re = (RefEval) eval;
            ValueEval tve = re.getInnerValueEval();
            if (tve instanceof StringValueEval || tve instanceof BlankEval) {
                retval = tve;
            }
            else {
                retval = ErrorEval.NAME_INVALID;
            }
        }
        else if (eval instanceof BlankEval) {
            retval = (BlankEval) eval;
        }
        else {
            retval = ErrorEval.NAME_INVALID;
        }
        return retval;
    }

