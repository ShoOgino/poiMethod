    /**
     * @return zero based index of the found or newly created defined name record. 
     */
    private static final int getOrCreateNameRecord(HSSFWorkbook book, String name) {
        // perhaps this logic belongs in Workbook?
        int countNames = book.getNumberOfNames();
        for (int i = 0; i < countNames; i++) {
            if(name.equalsIgnoreCase( book.getNameName(i) )) {
                return i; 
            }
        }
        
        HSSFName nameObj = book.createName();
        nameObj.setNameName(name);
        
        return countNames;
    }

