    /**
     * uses the relevant flags to decode the supplied RefVal
     * @param eval
     */
    private ValueEval xlateRefEval(RefEval reval) {
        ValueEval eval = reval.getInnerValueEval();
        
        // most common case - least worries :)
        if (eval instanceof NumberEval) {
            return eval;
        }
        
        if (eval instanceof BoolEval) {
            return ((flags & REF_BOOL_IS_PARSED) > 0)
                    ? (ValueEval) eval
                    : BlankEval.INSTANCE;
        } 
        
        if (eval instanceof StringEval) {
            // all ref strings are blanks
			return BlankEval.INSTANCE;
        }
        
        if (eval instanceof ErrorEval) {
            return eval;
        }
        
        if (eval instanceof BlankEval) {
            return xlateBlankEval();
        }
        
        throw new RuntimeException("Invalid ValueEval type passed for conversion: ("
        		+ eval.getClass().getName() + ")");
    }

