	/**
	 * @param colArgWasPassed <code>false</code> if the INDEX argument list had just 2 items
	 *            (exactly 1 comma).  If anything is passed for the <tt>column_num</tt> argument
	 *            (including {@link BlankEval} or {@link MissingArgEval}) this parameter will be
	 *            <code>true</code>.  This parameter is needed because error codes are slightly
	 *            different when only 2 args are passed.
	 */
	private static ValueEval getValueFromArea(AreaEval ae, int pRowIx, int pColumnIx,
			boolean colArgWasPassed, int srcRowIx, int srcColIx) throws EvaluationException {
		boolean rowArgWasEmpty = pRowIx == 0;
		boolean colArgWasEmpty = pColumnIx == 0;
		int rowIx;
		int columnIx;

		// when the area ref is a single row or a single column,
		// there are special rules for conversion of rowIx and columnIx
		if (ae.isRow()) {
			if (ae.isColumn()) {
				// single cell ref
				rowIx = rowArgWasEmpty ? 0 : pRowIx-1;
				columnIx = colArgWasEmpty ? 0 : pColumnIx-1;
			} else {
				if (colArgWasPassed) {
					rowIx = rowArgWasEmpty ? 0 : pRowIx-1;
					columnIx = pColumnIx-1;
				} else {
					// special case - row arg seems to get used as the column index
					rowIx = 0;
					// transfer both the index value and the empty flag from 'row' to 'column':
					columnIx = pRowIx-1;
					colArgWasEmpty = rowArgWasEmpty;
				}
			}
		} else if (ae.isColumn()) {
			if (rowArgWasEmpty) {
				rowIx = srcRowIx - ae.getFirstRow();
			} else {
				rowIx = pRowIx-1;
			}
			if (colArgWasEmpty) {
				columnIx = 0;
			} else {
				columnIx = colArgWasEmpty ? 0 : pColumnIx-1;
			}
		} else {
			// ae is an area (not single row or column)
			if (!colArgWasPassed) {
				// always an error with 2-D area refs
				// Note - the type of error changes if the pRowArg is negative
				throw new EvaluationException(pRowIx < 0 ? ErrorEval.VALUE_INVALID : ErrorEval.REF_INVALID);
			}
			// Normal case - area ref is 2-D, and both index args were provided
			// if either arg is missing (or blank) the logic is similar to OperandResolver.getSingleValue()
			if (rowArgWasEmpty) {
				rowIx = srcRowIx - ae.getFirstRow();
			} else {
				rowIx = pRowIx-1;
			}
			if (colArgWasEmpty) {
				columnIx = srcColIx - ae.getFirstColumn();
			} else {
				columnIx = pColumnIx-1;
			}
		}

		int width = ae.getWidth();
		int height = ae.getHeight();
		// Slightly irregular logic for bounds checking errors
		if (!rowArgWasEmpty && rowIx >= height || !colArgWasEmpty && columnIx >= width) {
			// high bounds check fail gives #REF! if arg was explicitly passed
			throw new EvaluationException(ErrorEval.REF_INVALID);
		}
		if (rowIx < 0 || columnIx < 0 || rowIx >= height || columnIx >= width) {
			throw new EvaluationException(ErrorEval.VALUE_INVALID);
		}
		return ae.getRelativeValue(rowIx, columnIx);
	}

