	/**
	 * @return the number of evaluated cells in the range that match the specified criteria
	 */
	private Eval countMatchingCellsInArea(Eval rangeArg, I_MatchPredicate criteriaPredicate) {
		int result = 0;
		if (rangeArg instanceof RefEval) {
			RefEval refEval = (RefEval) rangeArg;
			if(criteriaPredicate.matches(refEval.getInnerValueEval())) {
				result++;
			}
		} else if (rangeArg instanceof AreaEval) {

			AreaEval range = (AreaEval) rangeArg;
			ValueEval[] values = range.getValues();
			for (int i = 0; i < values.length; i++) {
				if(criteriaPredicate.matches(values[i])) {
					result++;
				}
			}
		} else {
			throw new IllegalArgumentException("Bad range arg type (" + rangeArg.getClass().getName() + ")");
		}
		return new NumberEval(result);
	}

