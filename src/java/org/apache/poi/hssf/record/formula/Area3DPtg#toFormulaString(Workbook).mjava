    /**
     * @return text representation of this area reference that can be used in text
     *  formulas. The sheet name will get properly delimited if required.
     */
	public String toFormulaString(Workbook book)
	{
		StringBuffer retval = new StringBuffer();
		String sheetName = Ref3DPtg.getSheetName(book, field_1_index_extern_sheet);
		if(sheetName != null) {
			SheetNameFormatter.appendFormat(retval, sheetName);
			retval.append( '!' );
		}
		retval.append( ( new CellReference( getFirstRow(), getFirstColumn(), !isFirstRowRelative(), !isFirstColRelative() ) ).toString() );
		retval.append( ':' );
		retval.append( ( new CellReference( getLastRow(), getLastColumn(), !isLastRowRelative(), !isLastColRelative() ) ).toString() );
		return retval.toString();
	}

