    protected int evaluateAsInteger(Eval eval) {
        int numval = -1;
        if (eval instanceof NumberEval) {
            NumberEval neval = (NumberEval) eval;
            double d = neval.getNumberValue();
            numval = (int) d;
        }
        else if (eval instanceof StringEval) {
            StringEval seval = (StringEval) eval;
            String s = seval.getStringValue();
            try { 
                double d = Double.parseDouble(s);
                numval = (int) d;
            } 
            catch (Exception e) {
            }
        }
        else if (eval instanceof BoolEval) {
            BoolEval beval = (BoolEval) eval;
            numval = beval.getBooleanValue() ? 1 : 0;
        }
        else if (eval instanceof RefEval) {
            numval = evaluateAsInteger(xlateRefEval((RefEval) eval));
        }
        return numval;
    }

