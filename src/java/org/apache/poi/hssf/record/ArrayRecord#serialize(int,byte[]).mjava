	public int serialize( int offset, byte[] data ) {
		int dataSize = getDataSize();

		LittleEndian.putShort(data, 0 + offset, sid);
		LittleEndian.putUShort(data, 2 + offset, dataSize);

		int pos = offset+4;
		_range.serialize(pos, data);
		pos += CellRangeAddress8Bit.ENCODED_SIZE;
		LittleEndian.putUShort(data, pos, _options);
		pos+=2;
		LittleEndian.putInt(data, pos, _field3notUsed);
		pos+=4;
		int tokenSize = Ptg.getEncodedSizeWithoutArrayData(_formulaTokens);
		LittleEndian.putUShort(data, pos, tokenSize);
		pos+=2;
		Ptg.serializePtgs(_formulaTokens, data, pos);
		return dataSize + 4;
	}

