	/**
	 * @return byte array containing instance data
	 */

	public int serialize(int offset, byte[] data)
	{
		int recordsize = getRecordSize();
		
		LittleEndian.putShort(data, 0 + offset, sid);
		LittleEndian.putShort(data, 2 + offset, (short) (recordsize-4));
		LittleEndian.putShort(data, 4 + offset, (short) field_1_numcf);
		LittleEndian.putShort(data, 6 + offset, (short) field_2_need_recalculation);
		LittleEndian.putShort(data, 8 + offset, (short) field_3_enclosing_cell_range.getFirstRow());
		LittleEndian.putShort(data, 10 + offset, (short) field_3_enclosing_cell_range.getLastRow());
		LittleEndian.putShort(data, 12 + offset, (short) field_3_enclosing_cell_range.getFirstColumn());
		LittleEndian.putShort(data, 14 + offset, (short) field_3_enclosing_cell_range.getLastColumn());
		LittleEndian.putShort(data, 16 + offset, (short) field_4_cell_ranges.length);
		for( int i=0 ; i!=field_4_cell_ranges.length; i++)
		{
			CellRange cr = field_4_cell_ranges[i];
			LittleEndian.putShort(data, 18 + 0 + 8 * i + offset, (short) cr.getFirstRow());
			LittleEndian.putShort(data, 18 + 2 + 8 * i + offset, (short) cr.getLastRow());
			LittleEndian.putShort(data, 18 + 4 + 8 * i + offset, (short) cr.getFirstColumn());
			LittleEndian.putShort(data, 18 + 6 + 8 * i + offset, (short) cr.getLastColumn());
		}
		return getRecordSize();
	}

