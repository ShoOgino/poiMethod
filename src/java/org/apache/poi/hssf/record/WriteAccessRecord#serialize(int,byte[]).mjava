	public int serialize(int offset, byte[] data) {
		String username = getUsername();
		boolean is16bit = StringUtil.hasMultibyte(username);

		LittleEndian.putUShort(data, 0 + offset, sid);
		LittleEndian.putUShort(data, 2 + offset, DATA_SIZE);
		LittleEndian.putUShort(data, 4 + offset, username.length());
		LittleEndian.putByte(data, 6 + offset, is16bit ? 0x01 : 0x00);
		int pos = offset + 7;
		if (is16bit) {
			StringUtil.putUnicodeLE(username, data, pos);
			pos += username.length() * 2;
		} else {
			StringUtil.putCompressedUnicode(username, data, pos);
			pos += username.length();
		}
		System.arraycopy(padding, 0, data, pos, padding.length);
		return 4 + DATA_SIZE;
	}

