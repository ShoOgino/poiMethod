	public int serialize(int offset, byte [] data) {

		int dataSize = getDataSize();
		int recSize = 4 + dataSize;
		LittleEndianOutput out = new LittleEndianByteArrayOutputStream(data, offset, recSize);
		out.writeShort(sid);
		out.writeShort(dataSize);
		out.writeShort(getRow());
		out.writeShort(getColumn());
		out.writeShort(getXFIndex());

		if (specialCachedValue == null) {
			out.writeDouble(field_4_value);
		} else {
			specialCachedValue.serialize(out);
		}

		out.writeShort(getOptions());

		out.writeInt(field_6_zero); // may as well write original data back so as to minimise differences from original
		field_8_parsed_expr.serialize(out);
		return recSize;
	}

