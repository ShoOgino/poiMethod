   /**
    * Check if the specified cell range has a shared border with the current range.
    * 
    * @return true if the ranges have a shared border.
    */
   	public boolean hasSharedBorder(CellRange range)
   	{
		int   firstRow = range.getFirstRow();
		int   lastRow  = range.getLastRow();
		short firstCol = range.getFirstColumn();
		short lastCol  = range.getLastColumn();
		return 
			(this.getFirstRow()>0 && this.getFirstRow() - 1 == lastRow || firstRow>0 &&this.getLastRow() == firstRow -1)&& 
			(this.getFirstColumn() == firstCol) && 
			(this.getLastColumn() == lastCol) 			||
			(this.getFirstColumn()>0 && this.getFirstColumn() - 1 == lastCol || firstCol>0 && this.getLastColumn() == firstCol -1) && 
			(this.getFirstRow() == firstRow) && 
			(this.getLastRow() == lastRow)
		;
   	}

