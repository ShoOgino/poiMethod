    protected int getDataSize() {
        int size = 0;
        size += 2 + 2 + 2 + 2;  //rwFirst, rwLast, colFirst, colLast
        size += guid.length;
        size += 4;  //label_opts
        size += 4;  //link_opts
        if ((link_opts & HLINK_LABEL) != 0){
            size += 4;  //link length
            size += label.length()*2;
        }
        if ((link_opts & HLINK_URL) != 0){
            size += moniker.length;  //moniker length
            if(Arrays.equals(URL_MONIKER, moniker)){
                size += 4;  //address length
                size += address.length()*2;
                size += tail.length;
            } else if (Arrays.equals(FILE_MONIKER, moniker)){
                size += 2;  //file_opts
                size += 4;  //address length
                size += address.length();
                size += tail.length;
            }
        } else if((link_opts & HLINK_PLACE) != 0){
            size += 4;  //address length
            size += address.length()*2;
        }
        return size;
    }

