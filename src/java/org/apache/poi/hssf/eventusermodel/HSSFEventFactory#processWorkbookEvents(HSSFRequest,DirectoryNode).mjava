   /**
    * Processes a file into essentially record events.
    *
    * @param req an Instance of HSSFRequest which has your registered listeners
    * @param dir  a DirectoryNode containing your workbook
    */
    public void processWorkbookEvents(HSSFRequest req, DirectoryNode dir) throws IOException {
        // some old documents have "WORKBOOK" or "BOOK"
        final String name;
        Set<String> entryNames = dir.getEntryNames();
        if (entryNames.contains("Workbook")) {
            name = "Workbook";
        } else if (entryNames.contains("WORKBOOK")) {
            name = "WORKBOOK";
        } else if (entryNames.contains("BOOK")) {
            name = "BOOK";
        } else {
            name = "Workbook";
        }

        InputStream in = dir.createDocumentInputStream(name);

        processEvents(req, in);
    }

