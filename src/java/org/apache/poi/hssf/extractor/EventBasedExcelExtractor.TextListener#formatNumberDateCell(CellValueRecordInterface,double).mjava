		/**
		 * Formats a number or date cell, be that a real number, or the
		 *  answer to a formula
		 */
		private String formatNumberDateCell(CellValueRecordInterface cell, double value) {
			// Get the built in format, if there is one
			int formatIndex = ft.getFormatIndex(cell);
			String formatString = ft.getFormatString(cell);

			if(formatString == null) {
				return Double.toString(value);
			} else {
				// Is it a date?
				if(HSSFDateUtil.isADateFormat(formatIndex,formatString) &&
						HSSFDateUtil.isValidExcelDate(value)) {
					// Java wants M not m for month
					formatString = formatString.replace('m','M');
					// Change \- into -, if it's there
					formatString = formatString.replaceAll("\\\\-","-");

					// Format as a date
					Date d = HSSFDateUtil.getJavaDate(value, false);
					DateFormat df = new SimpleDateFormat(formatString);
					return df.format(d);
				} else {
					if(formatString == "General") {
						// Some sort of wierd default
						return Double.toString(value);
					}

					// Format as a number
					DecimalFormat df = new DecimalFormat(formatString);
					return df.format(value);
				}
			}
		}

