    public OldExcelExtractor(File f) throws IOException {
        NPOIFSFileSystem poifs = null;
        try {
            poifs = new NPOIFSFileSystem(f);
            open(poifs);
            toClose = poifs;
            return;
        } catch (OldExcelFormatException e) {
            // will be handled by workaround below
        } catch (NotOLE2FileException e) {
            // will be handled by workaround below
        } catch (IOException e) {
            // ensure streams are closed correctly
            throw e;
        } catch (RuntimeException e) {
            // ensure streams are closed correctly
            throw e;
        } finally {
            if (toClose == null) {
                IOUtils.closeQuietly(poifs);
            }
        }

        @SuppressWarnings("resource")
        FileInputStream biffStream = new FileInputStream(f); // NOSONAR
        try {
            open(biffStream);
        } catch (IOException e)  {
            // ensure that the stream is properly closed here if an Exception
            // is thrown while opening
            biffStream.close();
            throw e;
        } catch (RuntimeException e)  {
            // ensure that the stream is properly closed here if an Exception
            // is thrown while opening
            biffStream.close();
            throw e;
        }
    }

