    /**
     * Retrieves the text contents of the file, as best we can
     *  for these old file formats
     */
    public String getText() {
        StringBuffer text = new StringBuffer();

        RecordInputStream ris = new RecordInputStream(input);
        while (ris.hasNextRecord()) {
            int sid = ris.getNextSid();
            ris.nextRecord();

            switch (sid) {
                // label - 5.63 - TODO Needs codepages
                case OldLabelRecord.biff2_sid:
                case OldLabelRecord.biff345_sid:
                    OldLabelRecord lr = new OldLabelRecord(ris);
                    text.append(lr.getValue());
                    text.append('\n');
                    break;
                // string - 5.102 - TODO Needs codepages
                case OldStringRecord.biff2_sid:
                case OldStringRecord.biff345_sid:
                    OldStringRecord sr = new OldStringRecord(ris);
                    text.append(sr.getString());
                    text.append('\n');
                    break;
                // number - 5.71 - TODO Needs format strings
                case NumberRecord.sid:
                    NumberRecord nr = new NumberRecord(ris);
                    text.append(nr.getValue());
                    text.append('\n');
                    break;
/*                    
                case OldFormulaRecord.sid:
                    FormulaRecord fr = new FormulaRecord(ris);
System.out.println(fr.getCachedResultType());                    
                    if (fr.getCachedResultType() == Cell.CELL_TYPE_NUMERIC) {
                        text.append(fr.getValue());
                        text.append('\n');
                    }
*/
                case RKRecord.sid:
                    RKRecord rr = new RKRecord(ris);
                    text.append(rr.getRKNumber());
                    text.append('\n');
                    break;
                default:
                    ris.readFully(new byte[ris.remaining()]);
      //              text.append(" = " + ris.getSid() + " = \n");
            }
        }

        return text.toString();
    }

