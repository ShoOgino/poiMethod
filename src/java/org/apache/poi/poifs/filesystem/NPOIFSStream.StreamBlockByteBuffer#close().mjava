        public void close() throws IOException {
            // If we're overwriting, free any remaining blocks
            NPOIFSStream toFree = new NPOIFSStream(blockStore, nextBlock);
            toFree.free(loopDetector);
            
            // Mark the end of the stream
            blockStore.setNextBlock(prevBlock, POIFSConstants.END_OF_CHAIN);
        }

