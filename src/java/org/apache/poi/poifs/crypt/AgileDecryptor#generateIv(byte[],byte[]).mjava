    protected byte[] generateIv(byte[] salt, byte[] blockKey)
        throws NoSuchAlgorithmException {


        if (blockKey == null)
            return getBlock(salt, getBlockSizeInBytes());

        MessageDigest sha1 = MessageDigest.getInstance("SHA-1");
        sha1.update(salt);
        return getBlock(sha1.digest(blockKey), getBlockSizeInBytes());
    }

