    public ChunkedCipherInputStream(LittleEndianInput stream, long size, int chunkSize, int initialPos)
    throws GeneralSecurityException {
        super((InputStream)stream);
        _size = size;
        _pos = initialPos;
        this._chunkSize = chunkSize;
        if (chunkSize == -1) {
            _chunk = new byte[4096];
        } else {
            _chunk = new byte[chunkSize];
        }
        _chunkBits = Integer.bitCount(_chunk.length-1);
        _lastIndex = (int)(_pos >> _chunkBits);
        _cipher = initCipherForBlock(null, _lastIndex);
    }

