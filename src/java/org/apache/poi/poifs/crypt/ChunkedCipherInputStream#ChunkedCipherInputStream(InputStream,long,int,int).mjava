    public ChunkedCipherInputStream(InputStream stream, long size, int chunkSize, int initialPos)
    throws GeneralSecurityException {
        super(stream);
        _size = size;
        _pos = initialPos;
        this._chunkSize = chunkSize;
        int cs = chunkSize == -1 ? 4096 : chunkSize;
        _chunk = new byte[cs];
        _plain = new byte[cs];
        _chunkBits = Integer.bitCount(_chunk.length-1);
        _lastIndex = (int)(_pos >> _chunkBits);
        _cipher = initCipherForBlock(null, _lastIndex);
    }

