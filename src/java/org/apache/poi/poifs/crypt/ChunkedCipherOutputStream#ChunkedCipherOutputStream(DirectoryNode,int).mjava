    public ChunkedCipherOutputStream(DirectoryNode dir, int chunkSize) throws IOException, GeneralSecurityException {
        super(null);
        this._chunkSize = chunkSize;
        int cs = chunkSize == STREAMING ? 4096 : chunkSize;
        _chunk = new byte[cs];
        _chunkBits = Integer.bitCount(cs-1);
        _fileOut = TempFile.createTempFile("encrypted_package", "crypt");
        _fileOut.deleteOnExit();
        this.out = new FileOutputStream(_fileOut);
        this._dir = dir;
        _cipher = initCipherForBlock(null, 0, false);
    }

