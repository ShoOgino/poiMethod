    @Override
    public void close() throws IOException {
        try {
            writeChunk(false);

            super.close();

            if (_fileOut != null) {
                int oleStreamSize = (int)(_fileOut.length()+LittleEndianConsts.LONG_SIZE);
                calculateChecksum(_fileOut, (int)_pos);
                _dir.createDocument(DEFAULT_POIFS_ENTRY, oleStreamSize, new EncryptedPackageWriter());
                createEncryptionInfoEntry(_dir, _fileOut);
            }
        } catch (GeneralSecurityException e) {
            throw new IOException(e);
        }
    }

