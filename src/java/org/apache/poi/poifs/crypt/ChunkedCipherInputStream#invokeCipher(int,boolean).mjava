    /**
     * Helper function for overriding the cipher invocation, i.e. XOR doesn't use a cipher
     * and uses it's own implementation
     *
     * @throws BadPaddingException
     * @throws IllegalBlockSizeException
     * @throws ShortBufferException
     */
    protected int invokeCipher(int totalBytes, boolean doFinal) throws GeneralSecurityException {
        if (doFinal) {
            return _cipher.doFinal(_chunk, 0, totalBytes, _chunk);
        } else {
            return _cipher.update(_chunk, 0, totalBytes, _chunk);
        }
    }

