    /**
     * Used when BIFF header fields (sid, size) are being read. The internal
     * {@link Cipher} instance must step even when unencrypted bytes are read
     */
    public int readPlain(byte b[], int off, int len) throws IOException {
        if (len <= 0) {
            return len;
        }

        int readBytes, total = 0;
        do {
            readBytes = read(b, off, len, true);
            total += Math.max(0, readBytes);
        } while (readBytes > -1 && total < len);

        return total;
    }

