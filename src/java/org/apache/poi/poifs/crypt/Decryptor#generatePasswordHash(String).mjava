    private void generatePasswordHash(String password) throws NoSuchAlgorithmException {
        MessageDigest sha1 = MessageDigest.getInstance("SHA-1");

        sha1.update(info.getVerifier().getSalt());
        byte[] hash = sha1.digest(password.getBytes(Charset.forName("UTF-16LE")));

        byte[] iterator = new byte[4];
        for (int i = 0; i<50000; i++) {
            sha1.reset();

            LittleEndian.putInt(iterator, i);
            sha1.update(iterator);
            hash = sha1.digest(hash);
        }

        passwordHash = hash;
    }

