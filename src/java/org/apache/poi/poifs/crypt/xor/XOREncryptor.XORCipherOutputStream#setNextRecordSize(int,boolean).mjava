        @Override
        public void setNextRecordSize(int recordSize, boolean isPlain) {
            if (_recordEnd > 0 && !_isPlain) {
                // encrypt last record
                invokeCipher((int)getPos(), true);
            }
            _recordStart = (int)getTotalPos()+4;
            _recordEnd = _recordStart+recordSize;
            _isPlain = isPlain;
        }

