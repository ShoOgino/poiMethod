    private Cipher getCipher(int algorithm, int mode, SecretKey key, byte[] vec)
        throws GeneralSecurityException {
        String name = null;
        String chain = null;

        if (algorithm == EncryptionHeader.ALGORITHM_AES_128 ||
            algorithm == EncryptionHeader.ALGORITHM_AES_192 ||
            algorithm == EncryptionHeader.ALGORITHM_AES_256)
            name = "AES";

        if (mode == EncryptionHeader.MODE_CBC)
            chain = "CBC";
        else if (mode == EncryptionHeader.MODE_CFB)
            chain = "CFB";

        Cipher cipher = Cipher.getInstance(name + "/" + chain + "/NoPadding");
        IvParameterSpec iv = new IvParameterSpec(vec);
        cipher.init(Cipher.DECRYPT_MODE, key, iv);
        return cipher;
    }

