    public ChunkedCipherOutputStream(OutputStream stream, int chunkSize) throws IOException, GeneralSecurityException {
        super(stream);
        this._chunkSize = chunkSize;
        int cs = chunkSize == STREAMING ? 4096 : chunkSize;
        _chunk = new byte[cs];
        _chunkBits = Integer.bitCount(cs-1);
        _fileOut = null;
        _dir = null;
        _cipher = initCipherForBlock(null, 0, false);
    }

