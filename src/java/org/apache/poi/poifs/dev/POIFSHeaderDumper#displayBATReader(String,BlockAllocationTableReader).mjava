    public static void displayBATReader(String type, BlockAllocationTableReader batReader) throws Exception {
        System.out.println("Sectors, as referenced from the "+type+" FAT:");
        Field entriesF = batReader.getClass().getDeclaredField("_entries");
        entriesF.setAccessible(true);
        IntList entries = (IntList)entriesF.get(batReader);

        for(int i=0; i<entries.size(); i++) {
            int bn = entries.get(i);
            String bnS = Integer.toString(bn);
            if(bn == POIFSConstants.END_OF_CHAIN) {
                bnS = "End Of Chain";
            } else if(bn == POIFSConstants.DIFAT_SECTOR_BLOCK) {
                bnS = "DI Fat Block";
            } else if(bn == POIFSConstants.FAT_SECTOR_BLOCK) {
                bnS = "Normal Fat Block";
            } else if(bn == POIFSConstants.UNUSED_BLOCK) {
                bnS = "Block Not Used (Free)";
            }

            System.out.println("  Block  # " + i + " -> " + bnS);
        }

        System.out.println("");
    }

