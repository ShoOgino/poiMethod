    /**
     * Calculates the maximum size of a file which is addressable given the
     *  number of FAT (BAT and XBAT) sectors specified.
     * The actual file size will be between [size of fatCount-1 blocks] and
     *  [size of fatCount blocks].
     * For 512 byte block sizes, this means we may over-estimate by up to 65kb.
     * For 4096 byte block sizes, this means we may over-estimate by up to 4mb
     */
    public static int calculateMaximumSize(final POIFSBigBlockSize bigBlockSize,
          final int numBAT, final int numXBAT) {
       int size = 1; // Header isn't FAT addressed
       size += (numBAT * bigBlockSize.getBATEntriesPerBlock());
       size += (numXBAT * bigBlockSize.getXBATEntriesPerBlock());
       return size * bigBlockSize.getBigBlockSize();
    }

