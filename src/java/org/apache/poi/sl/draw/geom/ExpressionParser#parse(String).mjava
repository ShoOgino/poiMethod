    public static Expression parse(String str) {
        ExpressionEntry ee = impls.get(op(str));
        Matcher m = (ee == null) ? null : ee.regex.matcher(str);
        if (m == null || !m.matches()) {
            throw new RuntimeException("Unsupported formula: " + str);
        }
        
        try {
            return ee.con.newInstance(m);
        } catch (Exception e) {
            throw new RuntimeException("Unsupported formula: " + str, e);
        }
    }

