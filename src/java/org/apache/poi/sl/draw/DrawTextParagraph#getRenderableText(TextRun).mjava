    String getRenderableText(TextRun tr) {
        String txt = tr.getRawText();
        txt = txt.replace("\t", tab2space(tr)).replace("\u000b", "\n");

        switch (tr.getTextCap()) {
            case ALL: txt = txt.toUpperCase(LocaleUtil.getUserLocale()); break;
            case SMALL: txt = txt.toLowerCase(LocaleUtil.getUserLocale()); break;
            case NONE: break;
        }

        return txt;
    }

