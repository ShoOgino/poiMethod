    /**
     * This copied over from ooxml, because we can't rely on these classes in the main package
     * 
     * @see org.apache.poi.POIXMLDocument#hasOOXMLHeader(InputStream)
     */
    protected static boolean hasOOXMLHeader(InputStream inp) throws IOException {
        // We want to peek at the first 4 bytes
        inp.mark(4);

        byte[] header = new byte[4];
        int bytesRead = IOUtils.readFully(inp, header);

        // Wind back those 4 bytes
        if(inp instanceof PushbackInputStream) {
            PushbackInputStream pin = (PushbackInputStream)inp;
            pin.unread(header, 0, bytesRead);
        } else {
            inp.reset();
        }

        // Did it match the ooxml zip signature?
        return (
            bytesRead == 4 &&
            header[0] == OOXML_FILE_HEADER[0] &&
            header[1] == OOXML_FILE_HEADER[1] &&
            header[2] == OOXML_FILE_HEADER[2] &&
            header[3] == OOXML_FILE_HEADER[3]
        );
    }

