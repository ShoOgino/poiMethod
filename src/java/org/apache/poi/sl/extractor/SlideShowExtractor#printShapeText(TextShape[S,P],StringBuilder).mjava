    private void printShapeText(final TextShape<S,P> shape, final StringBuilder sb) {
        final List<P> paraList = shape.getTextParagraphs();
        if (paraList.isEmpty()) {
            sb.append('\n');
            return;
        }
        for (final P para : paraList) {
            final int oldLen = sb.length();
            for (final TextRun tr : para) {
                final String str = tr.getRawText().replace("\r", "");
                final String newStr;
                switch (tr.getTextCap()) {
                    case ALL:
                        newStr = str.toUpperCase(LocaleUtil.getUserLocale());
                        break;
                    case SMALL:
                        newStr = str.toLowerCase(LocaleUtil.getUserLocale());
                        break;
                    default:
                    case NONE:
                        newStr = str;
                        break;
                }
                sb.append(newStr);
            }
            sb.append('\n');
        }
    }

