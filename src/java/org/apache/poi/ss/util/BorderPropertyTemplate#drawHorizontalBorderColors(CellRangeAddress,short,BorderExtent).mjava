    /**
     * <p>
     * Sets the color of the horizontal borders for a range of cells.
     * </p>
     *
     * @param range  range of cells on which colors are set.
     * @param color  Color index from {@link IndexedColors} used to draw the borders.
     * @param extent  BorderExtent of the borders for which colors are set. Valid Values are:
     *            <ul>
     *            <li>Extent.ALL</li>
     *            <li>Extent.INSIDE</li>
     *            </ul>
     */
    private void drawHorizontalBorderColors(CellRangeAddress range, short color, BorderExtent extent) {
        int firstRow = range.getFirstRow();
        int lastRow = range.getLastRow();
        int firstCol = range.getFirstColumn();
        int lastCol = range.getLastColumn();
        switch (extent) {
            case ALL:
                for (int i = firstRow; i <= lastRow; i++) {
                    CellRangeAddress row = new CellRangeAddress(i, i, firstCol, lastCol);
                    drawTopBorderColor(row, color);
                    drawBottomBorderColor(row, color);
                }
                break;
            case INSIDE:
                for (int i = firstRow; i <= lastRow; i++) {
                    CellRangeAddress row = new CellRangeAddress(i, i, firstCol, lastCol);
                    if (i > firstRow) drawTopBorderColor(row, color);
                    if (i < lastRow) drawBottomBorderColor(row, color);
                }
                break;
            default:
                throw new IllegalArgumentException("Illegal BorderExtent. Allowed: ALL and INSIDE");
        }
    }

