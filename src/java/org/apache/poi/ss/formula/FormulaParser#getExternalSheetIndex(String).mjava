    private int getExternalSheetIndex(String name) {
        if (name.charAt(0) == '[') {
            // we have a sheet name qualified with workbook name e.g. '[MyData.xls]Sheet1'
            int pos = name.lastIndexOf(']'); // safe because sheet names never have ']'
            String wbName = name.substring(1, pos);
            String sheetName = name.substring(pos+1);
            return book.getExternalSheetIndex(wbName, sheetName);
        }
        return book.getExternalSheetIndex(name);
    }

