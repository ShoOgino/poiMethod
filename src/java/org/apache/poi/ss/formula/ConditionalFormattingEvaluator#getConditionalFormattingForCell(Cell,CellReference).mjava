    /**
     * We need both, and can derive one from the other, but this is to avoid duplicate work
     * 
     * @param cell
     * @param ref
     * @return unmodifiable list of matching rules
     */
    private List<EvaluationConditionalFormatRule> getConditionalFormattingForCell(Cell cell, CellReference ref) {
        List<EvaluationConditionalFormatRule> rules = values.get(ref);
        
        if (rules == null) {
            // compute and cache them
            rules = new ArrayList<EvaluationConditionalFormatRule>();
            /*
             * Per Excel help:
             * https://support.office.com/en-us/article/Manage-conditional-formatting-rule-precedence-e09711a3-48df-4bcb-b82c-9d8b8b22463d#__toc269129417
             * stopIfTrue is true for all rules from HSSF files, and an explicit value for XSSF files.
             * thus the explicit ordering of the rule lists in #getFormattingRulesForSheet(Sheet)
             */
            boolean stopIfTrue = false;
            for (EvaluationConditionalFormatRule rule : getRules(cell.getSheet())) {
                
                if (stopIfTrue) {
                    continue; // a previous rule matched and wants no more evaluations
                }

                if (rule.matches(cell)) {
                    rules.add(rule);
                    stopIfTrue = rule.getRule().getStopIfTrue();
                }
            }
            Collections.sort(rules);
            values.put(ref, rules);
        }
        
        return Collections.unmodifiableList(rules);
    }

