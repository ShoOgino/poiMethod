    /**
     * Takes a ValueEval and tries to retrieve a String value from it.
     * It tries to resolve references if there are any.
     *
     * @param value ValueEval to retrieve the string from.
     * @return String corresponding to the given ValueEval.
     * @throws EvaluationException If it's not possible to retrieve a String value.
     */
    private static String getStringFromValueEval(ValueEval value)
            throws EvaluationException {
        value = solveReference(value);
        if(!(value instanceof StringValueEval))
            throw new EvaluationException(ErrorEval.VALUE_INVALID);
        return ((StringValueEval)value).getStringValue();
    }

