    private double getValue(ValueEval arg) throws EvaluationException {
        if (arg instanceof NumberEval) {
            return ((NumberEval) arg).getNumberValue();
        }
        if (arg instanceof RefEval) {
            ValueEval innerValueEval = ((RefEval) arg).getInnerValueEval();
            return ((NumberEval) innerValueEval).getNumberValue();
        }
        throw new EvaluationException(ErrorEval.REF_INVALID);
    }

