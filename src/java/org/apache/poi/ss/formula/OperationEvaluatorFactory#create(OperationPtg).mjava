	/**
	 * returns the OperationEval concrete impl instance corresponding
	 * to the supplied operationPtg
	 */
	public static OperationEval create(OperationPtg ptg) {
		if(ptg == null) {
			throw new IllegalArgumentException("ptg must not be null");
		}
		OperationEval result;

		Class ptgClass = ptg.getClass();

		result = _instancesByPtgClass.get(ptgClass);
		if (result != null) {
			return  result;
		}
		
		if (ptgClass == FuncPtg.class) {
			return new FuncVarEval((FuncPtg)ptg);
		}
		if (ptgClass == FuncVarPtg.class) {
			return new FuncVarEval((FuncVarPtg)ptg);
		}
		if (ptgClass == ConcatPtg.class) {
			return new ConcatEval((ConcatPtg)ptg);
		}
		if(ptgClass == ExpPtg.class) {
			// ExpPtg is used for array formulas and shared formulas.
			// it is currently unsupported, and may not even get implemented here
			throw new RuntimeException("ExpPtg currently not supported");
		}
		throw new RuntimeException("Unexpected operation ptg class (" + ptgClass.getName() + ")");
	}

