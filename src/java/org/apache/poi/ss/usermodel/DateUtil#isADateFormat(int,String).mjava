    /**
     * Given a format ID and its format String, will check to see if the
     *  format represents a date format or not.
     * Firstly, it will check to see if the format ID corresponds to an
     *  internal excel date format (eg most US date formats)
     * If not, it will check to see if the format string only contains
     *  date formatting characters (ymd-/), which covers most
     *  non US date formats.
     *
     * @param formatIndex The index of the format, eg from ExtendedFormatRecord.getFormatIndex
     * @param formatString The format string, eg from FormatRecord.getFormatString
     * @see #isInternalDateFormat(int)
     */
    public static boolean isADateFormat(int formatIndex, String formatString) {
        // First up, is this an internal date format?
        if(isInternalDateFormat(formatIndex)) {
            return true;
        }

        // If we didn't get a real string, it can't be
        if(formatString == null || formatString.length() == 0) {
            return false;
        }

        String fs = formatString;

        // Translate \- into just -, before matching
        fs = fs.replaceAll("\\\\-","-");
        // And \, into ,
        fs = fs.replaceAll("\\\\,",",");
        // And \. into .
        fs = fs.replaceAll("\\\\.",".");
        // And '\ ' into ' '
        fs = fs.replaceAll("\\\\ "," ");

        // If it end in ;@, that's some crazy dd/mm vs mm/dd
        //  switching stuff, which we can ignore
        fs = fs.replaceAll(";@", "");

        // If it starts with [$-...], then could be a date, but
        //  who knows what that starting bit is all about
        fs = fs.replaceAll("^\\[\\$\\-.*?\\]", "");

        // If it starts with something like [Black] or [Yellow],
        //  then it could be a date
        fs = fs.replaceAll("^\\[[a-zA-Z]+\\]", "");

        // Otherwise, check it's only made up, in any case, of:
        //  y m d h s - / , . :
        // optionally followed by AM/PM
        if(fs.matches("^[yYmMdDhHsS\\-/,. :]+[ampAMP/]*$")) {
            return true;
        }

        return false;
    }

