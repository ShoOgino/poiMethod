    private Format getFormat(double cellValue, int formatIndex, String formatStr) {
        Format format = (Format)formats.get(formatStr);
        if (format != null) {
            return format;
        }
        if (formatStr.equals("General") || formatStr.equals("@")) {
            if (DataFormatter.isWholeNumber(cellValue)) {
                return generalWholeNumFormat;
            }
            return generalDecimalNumFormat;
        }
        format = createFormat(cellValue, formatIndex, formatStr);
        formats.put(formatStr, format);
        return format;
    }

