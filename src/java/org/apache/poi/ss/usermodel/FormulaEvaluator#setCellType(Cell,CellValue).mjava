    private static void setCellType(Cell cell, CellValue cv) {
        int cellType = cv.getCellType();
        switch (cellType) {
            case Cell.CELL_TYPE_BOOLEAN:
            case Cell.CELL_TYPE_ERROR:
            case Cell.CELL_TYPE_NUMERIC:
            case Cell.CELL_TYPE_STRING:
                cell.setCellType(cellType);
                return;
            case Cell.CELL_TYPE_BLANK:
                // never happens - blanks eventually get translated to zero
            case Cell.CELL_TYPE_FORMULA:
                // this will never happen, we have already evaluated the formula
        }
        throw new IllegalStateException("Unexpected cell value type (" + cellType + ")");
    }

