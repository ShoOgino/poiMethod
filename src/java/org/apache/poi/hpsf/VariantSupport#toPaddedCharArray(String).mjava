    /**
     * <p>Converts a string into a 0x00-terminated character sequence padded 
     * with 0x00 bytes to a multiple of 4.</p>
     *
     * @param value The string to convert
     * @return The padded character array
     */
    private static char[] toPaddedCharArray(final String s)
    {
        final int PADDING = 4;
        int dl = s.length() + 1;
        final int r = dl % 4;
        if (r > 0)
            dl += PADDING - r;
        char[] buffer = new char[dl];
        s.getChars(0, s.length(), buffer, 0);
        for (int i = s.length(); i < dl; i++)
            buffer[i] = (char) 0;
        return buffer;
    }

