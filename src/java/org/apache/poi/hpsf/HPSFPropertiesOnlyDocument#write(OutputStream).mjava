    /**
     * Write out, with any properties changes, but nothing else
     */
    public void write(OutputStream out) throws IOException {
        NPOIFSFileSystem fs = new NPOIFSFileSystem();

        // For tracking what we've written out, so far
        List<String> excepts = new ArrayList<String>(1);

        // Write out our HPFS properties, with any changes
        writeProperties(fs, excepts);
        
        // Copy over everything else unchanged
        EntryUtils.copyNodes(directory, fs.getRoot(), excepts);
        
        // Save the resultant POIFSFileSystem to the output stream
        fs.writeFilesystem(out);
    }

