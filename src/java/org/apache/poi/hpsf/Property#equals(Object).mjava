    /**
     * @see Object#equals(java.lang.Object)
     */
    public boolean equals(final Object o)
    {
        if (!(o instanceof Property))
            return false;
        final Property p = (Property) o;
        final Object pValue = p.getValue();
        if (id != p.getID() || type != p.getType())
            return false;
        if (value == null && pValue == null)
            return true;
        if (value == null || pValue == null)
            return false;
        
        /* It's clear now that both values are non-null. */
        final Class valueClass = value.getClass();
        final Class pValueClass = pValue.getClass();
        if (!(valueClass.isAssignableFrom(pValueClass)) &&
            !(pValueClass.isAssignableFrom(valueClass)))
            return false;

        if (value instanceof byte[])
            return Util.equal((byte[]) value, (byte[]) pValue);

        return value.equals(pValue);
    }

