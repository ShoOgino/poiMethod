    /**
     * Checks to see if the specified length seems valid,
     *  given the amount of data available still to read,
     *  and the requirement that the string be NULL-terminated
     */
    boolean validLength(int length, byte[] data, int offset) {
        if (length == 0) {
            return true;
        }

        int endOffset = offset + (length * 2);
        if (endOffset <= data.length) {
            // Data Length is OK, ensure it's null terminated too
            if (data[endOffset-1] == 0 && data[endOffset-2] == 0) {
                // Length looks plausible
                return true;
            }
        }

        // Something's up/invalid with that length for the given data+offset
        return false;
    }

