    @Override
    public final String toString() {
        final String nl = System.getProperty( "line.separator" );
        StringBuilder sb = new StringBuilder(1000);
        sb.append(getClass().getName()).append(" (").append(getRecordName()).append("):").append(nl)
          .append("  RecordId: 0x").append(HexDump.toHex( getRecordId() )).append(nl)
          .append("  Version: 0x").append(HexDump.toHex( getVersion() )).append(nl)
          .append("  Instance: 0x").append(HexDump.toHex( getInstance() )).append(nl)
          .append("  Options: 0x").append(HexDump.toHex( getOptions() )).append(nl)
          .append("  Record Size: ").append( getRecordSize() );

        Object[][] attrList = getAttributeMap();
        if (attrList != null && attrList.length > 0) {
            String childTab = "  ";
            for (Object[] attrs : attrList) {
                for (int i=0; i<attrs.length; i+=2) {
                    Object value = attrs[i+1];
                    if (value == null) {
                        // ignore null values
                        continue;
                    }
                    String name = (String)attrs[i+0];
                    sb.append(nl).append(childTab).append(name).append(": ");
                    appendValue(sb, value, false, childTab);
                }
            }
        }

        return sb.toString();
    }

