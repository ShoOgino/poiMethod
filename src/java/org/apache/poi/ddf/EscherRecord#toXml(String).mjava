    /**
     * @param tab - each children must be indented right relative to its parent
     * @return xml representation of this record
     */
    public final String toXml(String tab){
        final String nl = System.getProperty( "line.separator" );
        String clsNm = getClass().getSimpleName();
        StringBuilder sb = new StringBuilder(1000);
        sb.append(tab).append("<").append(clsNm)
          .append(" recordId=\"0x").append(HexDump.toHex(getRecordId()))
          .append("\" version=\"0x").append(HexDump.toHex(getVersion()))
          .append("\" instance=\"0x").append(HexDump.toHex(getInstance()))
          .append("\" options=\"0x").append(HexDump.toHex(getOptions()))
          .append("\" recordSize=\"").append(getRecordSize());
        Object[][] attrList = getAttributeMap();
        if (attrList == null || attrList.length == 0) {
            sb.append("\" />").append(nl);
        } else {
            sb.append("\">").append(nl);
            String childTab = tab+"   ";
            for (Object[] attrs : attrList) {
                String tagName = capitalizeAndTrim((String)attrs[0]);
                boolean hasValue = false;
                boolean lastChildComplex = false;
                for (int i=0; i<attrs.length; i+=2) {
                    Object value = attrs[i+1];
                    if (value == null) {
                        // ignore null values
                        continue;
                    }
                    if (!hasValue) {
                        // only add tagname, when there was a value
                        sb.append(childTab).append("<").append(tagName).append(">");
                    }
                    // add names for optional attributes
                    String optName = capitalizeAndTrim((String)attrs[i+0]);
                    if (i>0) {
                        sb.append(nl).append(childTab).append("  <").append(optName).append(">");
                    }
                    lastChildComplex = appendValue(sb, value, true, childTab);
                    if (i>0) {
                        sb.append(nl).append(childTab).append("  </").append(optName).append(">");
                    }
                    hasValue = true;
                }
                if (hasValue) {
                    if (lastChildComplex) {
                        sb.append(nl).append(childTab);
                    }
                    sb.append("</").append(tagName).append(">").append(nl);
                }
            }
            sb.append(tab).append("</").append(clsNm).append(">");
        }
        return sb.toString();
    }

