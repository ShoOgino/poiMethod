    /**
     * @return true, if value was a complex record, false otherwise
     */
    private static boolean appendValue(StringBuilder sb, Object value, boolean toXML, String childTab) {
        final String nl = System.getProperty( "line.separator" );
        boolean isComplex = false;
        if (value instanceof String) {
            if (toXML) {
                escapeXML((String)value, sb);
            } else {
                sb.append((String)value);
            }
        } else if (value instanceof Byte) {
            sb.append("0x").append(HexDump.toHex((Byte)value));
        } else if (value instanceof Short) {
            sb.append("0x").append(HexDump.toHex((Short)value));
        } else if (value instanceof Integer) {
            sb.append("0x").append(HexDump.toHex((Integer)value));
        } else if (value instanceof byte[]) {
            sb.append(nl).append(HexDump.toHex((byte[])value, 32).replaceAll("(?m)^",childTab+"   "));
        } else if (value instanceof Boolean) {
            sb.append(((Boolean)value).booleanValue());
        } else if (value instanceof EscherRecord) {
            EscherRecord er = (EscherRecord)value;
            if (toXML) {
                sb.append(nl).append(er.toXml(childTab+"    "));
            } else {
                sb.append(er.toString().replaceAll("(?m)^",childTab));
            }
            isComplex = true;
        } else if (value instanceof EscherProperty) {
            EscherProperty ep = (EscherProperty)value;
            if (toXML) {
                sb.append(nl).append(ep.toXml(childTab+"  "));
            } else {
                sb.append(ep.toString().replaceAll("(?m)^",childTab));
            }
            isComplex = true;
        } else {
            throw new IllegalArgumentException("unknown attribute type "+value.getClass().getSimpleName());
        }
        return isComplex;
    }

