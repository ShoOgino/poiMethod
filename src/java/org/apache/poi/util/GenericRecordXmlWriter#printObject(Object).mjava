    private void printObject(Object o) {
        final Matcher m = ESC_CHARS.matcher(o.toString());
        final StringBuffer sb = new StringBuffer();
        while (m.find()) {
            String repl;
            String match = m.group();
            switch (match) {
                case "<":
                    repl = "&lt;";
                    break;
                case ">":
                    repl = "&gt;";
                    break;
                case "&":
                    repl = "&amp;";
                    break;
                case "\'":
                    repl = "&apos;";
                    break;
                case "\"":
                    repl = "&quot;";
                    break;
                default:
                    repl = "&#x" + Long.toHexString(match.codePointAt(0)) + ";";
                    break;
            }
            m.appendReplacement(sb, repl);
        }
        m.appendTail(sb);
        fw.write(sb.toString());
    }

