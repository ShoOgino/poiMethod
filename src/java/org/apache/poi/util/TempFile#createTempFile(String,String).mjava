    /**
     * Creates a temporary file.  Files are collected into one directory and by default are
     * deleted on exit from the VM.  Files can be kept by defining the system property
     * <code>poi.keep.tmp.files</code>.
     * <p>
     * Don't forget to close all files or it might not be possible to delete them.
     */
    public static File createTempFile(String prefix, String suffix) {
        // Identify and create our temp dir, if needed
        if (dir == null)
        {
            dir = new File(System.getProperty("java.io.tmpdir"), "poifiles");
            dir.mkdir();
            if (System.getProperty("poi.keep.tmp.files") == null)
                dir.deleteOnExit();
        }

        // Generate a unique new filename 
        File newFile = new File(dir, prefix + rnd.nextInt() + suffix);
        if (newFile.exists())
        {
           // That name is already taken, try another
           newFile = createTempFile(prefix, suffix);
        }

        // Set the delete on exit flag, unless explicitly disabled
        if (System.getProperty("poi.keep.tmp.files") == null)
            newFile.deleteOnExit();

        // All done
        return newFile;
    }

