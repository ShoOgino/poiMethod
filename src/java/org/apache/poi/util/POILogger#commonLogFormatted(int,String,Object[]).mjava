    private void commonLogFormatted(final int logLevel, final String message,
                                    final Object [] unflatParams)
    {
        Priority priority = Priority.toPriority(logLevel);

        if (log.isEnabledFor(priority))
        {
            Object[] params = flattenArrays(unflatParams);

            if (params[ params.length - 1 ] instanceof Throwable)
            {
                log(logLevel, StringUtil.format(message, params),
                    ( Throwable ) params[ params.length - 1 ]);
            }
            else
            {
                log(logLevel, StringUtil.format(message, params));
            }
        }
    }

