    public static void main(String[] args) throws IOException {

        //create a new workbook
        XSSFWorkbook wb = new XSSFWorkbook();

        //add a picture in this workbook.
        InputStream is = new FileInputStream("lilies.jpg");
        int pictureIdx = wb.addPicture(is, XSSFWorkbook.PICTURE_TYPE_JPEG);
        is.close();

        //create sheet
        XSSFSheet sheet = wb.createSheet();

        //create drawing
        XSSFDrawing drawing = sheet.createDrawingPatriarch();

        //add a picture shape
        XSSFPicture pict = drawing.createPicture(new XSSFClientAnchor(), pictureIdx);

        //auto-size picture
        pict.resize();

        //save workbook
        FileOutputStream fileOut = new FileOutputStream("xssf-picture.xlsx");
        wb.write(fileOut);
        fileOut.close();

    }

