    public static void main(String[]args) throws Exception {
        Workbook wb = new XSSFWorkbook();

        /**
         * It's possible to set up repeating rows and columns in your printouts by using the setRepeatingRowsAndColumns() function in the Workbook object.
         *
         * This function Contains 5 parameters:
         * The first parameter is the index to the sheet (0 = first sheet).
         * The second and third parameters specify the range for the columns to repreat.
         * To stop the columns from repeating pass in -1 as the start and end column.
         * The fourth and fifth parameters specify the range for the rows to repeat.
         * To stop the columns from repeating pass in -1 as the start and end rows.
         */
        Sheet sheet1 = wb.createSheet("new sheet");
        Sheet sheet2 = wb.createSheet("second sheet");

        // Set the columns to repeat from column 0 to 2 on the first sheet
        Row row1 = sheet1.createRow(0);
        row1.createCell(0).setCellValue(1);
        row1.createCell(1).setCellValue(2);
        row1.createCell(2).setCellValue(3);
        Row row2 = sheet1.createRow(1);
        row2.createCell(1).setCellValue(4);
        row2.createCell(2).setCellValue(5);


        Row row3 = sheet2.createRow(1);
        row3.createCell(0).setCellValue(2.1);
        row3.createCell(4).setCellValue(2.2);
        row3.createCell(5).setCellValue(2.3);
        Row row4 = sheet2.createRow(2);
        row4.createCell(4).setCellValue(2.4);
        row4.createCell(5).setCellValue(2.5);

        // Set the columns to repeat from column 0 to 2 on the first sheet
        wb.setRepeatingRowsAndColumns(0,0,2,-1,-1);
        // Set the the repeating rows and columns on the second sheet.
        wb.setRepeatingRowsAndColumns(1,4,5,1,2);

        // Set the the repeating rows and columns on the second sheet
        wb.setRepeatingRowsAndColumns(1, 4, 5, 1, 2);



        //set the print area for the first sheet
        wb.setPrintArea(0, 1, 2, 0, 3);


        FileOutputStream fileOut = new FileOutputStream("ooxml-printsetup.xlsx");
        wb.write(fileOut);
        fileOut.close();
    }

