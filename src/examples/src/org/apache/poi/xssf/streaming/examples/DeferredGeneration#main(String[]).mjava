    public static void main(String[] args) throws Exception {
        String filename;
        if(args.length == 0) {
            filename = "deferred-generation.xlsx";
        } else {
            filename = args[0];
        }
        try (DeferredSXSSFWorkbook wb = new DeferredSXSSFWorkbook()){
            for(int i = 0; i < 10; i++) {
                DeferredSXSSFSheet sheet = wb.createSheet("Sheet" + i);
                sheet.setRowGenerator((sh) -> {
                    for (int r = 0; r < 1000; r++) {
                        SXSSFRow row = sheet.createRow(r);
                        for (int c = 0; c < 100; c++) {
                            SXSSFCell cell = row.createCell(c);
                            cell.setCellValue("abcd");
                        }
                    }
                });
            }
            wb.write(new FileOutputStream(filename));
            System.out.println("wrote " + filename);
        }
    }

