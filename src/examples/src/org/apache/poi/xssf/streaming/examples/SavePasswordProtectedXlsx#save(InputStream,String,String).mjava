    public static void save(final InputStream inputStream, final String filename, final String pwd)
            throws InvalidFormatException, IOException, GeneralSecurityException {
        POIFSFileSystem fs = null;
        FileOutputStream fos = null;
        OPCPackage opc = null;
        try {
            fs = new POIFSFileSystem();
            EncryptionInfo info = new EncryptionInfo(EncryptionMode.agile);
            Encryptor enc = Encryptor.getInstance(info);
            enc.confirmPassword(pwd);
            opc = OPCPackage.open(inputStream);
            fos = new FileOutputStream(filename);
            opc.save(enc.getDataStream(fs));
            fs.writeFilesystem(fos);
        } finally {
            IOUtils.closeQuietly(fos);
            IOUtils.closeQuietly(opc);
            IOUtils.closeQuietly(fs);
            IOUtils.closeQuietly(inputStream);
        }
    }

