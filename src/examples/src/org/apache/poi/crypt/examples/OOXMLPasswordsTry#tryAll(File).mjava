    public String tryAll(File wordfile) throws IOException, GeneralSecurityException {
        String valid = null;
        // Load
        try (BufferedReader r = new BufferedReader(new FileReader(wordfile))) {
            long start = System.currentTimeMillis();
            int count = 0;

            // Try each password in turn, reporting progress
            String password;
            while ((password = r.readLine()) != null) {
                if (isValid(password)) {
                    valid = password;
                    break;
                }
                count++;

                if (count % 1000 == 0) {
                    int secs = (int) ((System.currentTimeMillis() - start) / 1000);
                    System.out.println("Done " + count + " passwords, " +
                                               secs + " seconds, last password " + password);
                }
            }

        }
        // Tidy and return (null if no match)
        return valid;
    }

