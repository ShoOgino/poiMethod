    public String tryAll(File wordfile) throws IOException, GeneralSecurityException {
        // Load
        BufferedReader r = new BufferedReader(new FileReader(wordfile));
        long start = System.currentTimeMillis();
        int count = 0;
        
        // Try each password in turn, reporting progress
        String valid = null;
        String password;
        while ((password = r.readLine()) != null) {
            if (isValid(password)) {
                valid = password;
                break;
            }
            count++;
            
            if (count % 1000 == 0) {
                int secs = (int)((System.currentTimeMillis() - start) / 1000);
                System.out.println("Done " + count + " passwords, " +
                                   secs + " seconds, last password " + password);
            }
        }
        
        // Tidy and return (null if no match)
        r.close();
        return valid;
    }

