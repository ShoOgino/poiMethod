    private static void setBarData(XSLFChart chart, String chartTitle, String[] categories, Double[] values) {
        final List<XDDFChartData> series = chart.getChartSeries();
        final XDDFBarChartData bar = (XDDFBarChartData) series.get(0);

        final int numOfPoints = categories.length;
        final String categoryDataRange = chart.formatRange(new CellRangeAddress(1, numOfPoints, 0, 0));
        final String valuesDataRange = chart.formatRange(new CellRangeAddress(1, numOfPoints, 1, 1));
        final XDDFDataSource<?> categoriesData = XDDFDataSourcesFactory.fromArray(categories, categoryDataRange);
        final XDDFNumericalDataSource<? extends Number> valuesData = XDDFDataSourcesFactory.fromArray(values, valuesDataRange);

        bar.getSeries().get(0).replaceData(categoriesData, valuesData);
        bar.getSeries().get(0).setTitle(chartTitle, chart.setSheetTitle(chartTitle));
        chart.plot(bar);
    }

