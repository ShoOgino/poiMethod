	/**
	 * Processes a single attachment: reads it from the Outlook MSG file and
	 * writes it to disk as an individual file.
	 * 
	 * @param dir the directory in which to write the attachment file
	 * @param fileName the name of the attachment file
	 * @param fileIn the input stream that contains the attachment's data
	 * @throws IOException when any of the file operations fails
	 */
	public void processAttachment(File dir, String fileName,
			ByteArrayInputStream fileIn) throws IOException {
		File f = new File(dir, fileName);
		OutputStream fileOut = null;
		try {
			fileOut = new FileOutputStream(f);
			byte[] buffer = new byte[2048];
			int bNum = fileIn.read(buffer);
			while(bNum > 0) {
				fileOut.write(buffer);
				bNum = fileIn.read(buffer);
			}
		} finally {
			try {
				if(fileIn != null) {
					fileIn.close();
				}
			} finally {
				if(fileOut != null) {
					fileOut.close();
				}
			}
		}
	}

