	public void testPreferEventBased() throws Exception {
	   assertFalse(ExtractorFactory.getPreferEventExtractor());
	   assertFalse(ExtractorFactory.getThreadPrefersEventExtractors());
	   assertNull(ExtractorFactory.getAllThreadsPreferEventExtractors());
	   
	   ExtractorFactory.setThreadPrefersEventExtractors(true);
	   
      assertTrue(ExtractorFactory.getPreferEventExtractor());
      assertTrue(ExtractorFactory.getThreadPrefersEventExtractors());
      assertNull(ExtractorFactory.getAllThreadsPreferEventExtractors());
      
      ExtractorFactory.setAllThreadsPreferEventExtractors(false);
      
      assertFalse(ExtractorFactory.getPreferEventExtractor());
      assertTrue(ExtractorFactory.getThreadPrefersEventExtractors());
      assertEquals(Boolean.FALSE, ExtractorFactory.getAllThreadsPreferEventExtractors());
      
      ExtractorFactory.setAllThreadsPreferEventExtractors(null);
      
      assertTrue(ExtractorFactory.getPreferEventExtractor());
      assertTrue(ExtractorFactory.getThreadPrefersEventExtractors());
      assertNull(ExtractorFactory.getAllThreadsPreferEventExtractors());
      
      
      // Check we get the right extractors now
      assertTrue(
            ExtractorFactory.createExtractor(new POIFSFileSystem(new FileInputStream(xls)))
            instanceof EventBasedExcelExtractor
      );
      assertTrue(
            ExtractorFactory.createExtractor(new POIFSFileSystem(new FileInputStream(xls))).getText().length() > 200
      );
      
      assertTrue(
            ExtractorFactory.createExtractor(OPCPackage.open(xlsx.toString()))
            instanceof XSSFEventBasedExcelExtractor
      );
      assertTrue(
            ExtractorFactory.createExtractor(OPCPackage.open(xlsx.toString())).getText().length() > 200
      );
      
      
      // Put back to normal
      ExtractorFactory.setThreadPrefersEventExtractors(false);
      assertFalse(ExtractorFactory.getPreferEventExtractor());
      assertFalse(ExtractorFactory.getThreadPrefersEventExtractors());
      assertNull(ExtractorFactory.getAllThreadsPreferEventExtractors());
      
      // And back
      assertTrue(
            ExtractorFactory.createExtractor(new POIFSFileSystem(new FileInputStream(xls)))
            instanceof ExcelExtractor
      );
      assertTrue(
            ExtractorFactory.createExtractor(new POIFSFileSystem(new FileInputStream(xls))).getText().length() > 200
      );
      
      assertTrue(
            ExtractorFactory.createExtractor(OPCPackage.open(xlsx.toString()))
            instanceof XSSFExcelExtractor
      );
      assertTrue(
            ExtractorFactory.createExtractor(OPCPackage.open(xlsx.toString())).getText().length() > 200
      );
	}

