	/**
	 * Test embeded docs text extraction. For now, only
	 *  does poifs embeded, but will do ooxml ones 
	 *  at some point.
	 */
	public void testEmbeded() throws Exception {
		POIOLE2TextExtractor ext;
		POITextExtractor[] embeds;
		File f;
		
		// No embedings
		ext = (POIOLE2TextExtractor)
				ExtractorFactory.createExtractor(xls);
		embeds = ExtractorFactory.getEmbededDocsTextExtractors(ext);
		assertEquals(0, embeds.length);
		
		// Excel
		f = new File(poifs_dir, "excel_with_embeded.xls");
		ext = (POIOLE2TextExtractor)
				ExtractorFactory.createExtractor(f);
		embeds = ExtractorFactory.getEmbededDocsTextExtractors(ext);

		assertEquals(6, embeds.length);
		int numWord = 0, numXls = 0, numPpt = 0;
        for(int i=0; i<embeds.length; i++) {
			assertTrue(embeds[i].getText().length() > 20);

            if(embeds[i] instanceof PowerPointExtractor) numPpt++;
            else if(embeds[i] instanceof ExcelExtractor) numXls++;
            else if(embeds[i] instanceof WordExtractor) numWord++;
        }
		assertEquals(2, numPpt);
        assertEquals(2, numXls);
        assertEquals(2, numWord);

        // Word
		f = new File(poifs_dir, "word_with_embeded.doc");
		ext = (POIOLE2TextExtractor)
				ExtractorFactory.createExtractor(f);
		embeds = ExtractorFactory.getEmbededDocsTextExtractors(ext);
		
        numWord = 0; numXls = 0; numPpt = 0;
		assertEquals(4, embeds.length);
		for(int i=0; i<embeds.length; i++) {
			assertTrue(embeds[i].getText().length() > 20);
            if(embeds[i] instanceof PowerPointExtractor) numPpt++;
            else if(embeds[i] instanceof ExcelExtractor) numXls++;
            else if(embeds[i] instanceof WordExtractor) numWord++;
		}
        assertEquals(1, numPpt);
        assertEquals(2, numXls);
        assertEquals(1, numWord);

		// TODO - PowerPoint
		// TODO - Visio
	}

