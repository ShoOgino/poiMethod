    @Test
    public void testInvalidGeometry() throws Exception {
        XMLSlideShow ppt = new XMLSlideShow();
        XSLFSlide slide = ppt.createSlide();

        XSLFSimpleShape shape = slide.createAutoShape();
        CTShapeProperties spPr = getSpPr(shape);
        
        CTPresetGeometry2D prstGeom = CTPresetGeometry2D.Factory.newInstance();
        prstGeom.setPrst(STShapeType.Enum.forInt(1));
        
        assertNotNull(prstGeom.getPrst());
        assertNotNull(prstGeom.getPrst().toString());
        assertNotNull(spPr.getPrstGeom());
        spPr.setPrstGeom(prstGeom);
        assertNotNull(spPr.getPrstGeom().getPrst());
        assertNotNull(spPr.getPrstGeom().getPrst().toString());
        
        try {
            // cause the geometries to be not found
            TestPresetGeometries.clearPreset();
            try {
                shape.getGeometry();
                fail("Should fail without the geometry");
            } catch (IllegalStateException e) {
                assertTrue(e.getMessage(), e.getMessage().contains("line"));
            }
        } finally {
            // reset to not affect other tests
            TestPresetGeometries.resetPreset();
        }
        
        ppt.close();
    }

