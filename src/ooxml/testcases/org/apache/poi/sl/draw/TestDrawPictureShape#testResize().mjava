    @Test
    public void testResize() throws Exception {
        String files[] = { "pictures.ppt", "shapes.pptx" };
        for (String file : files) {
            SlideShow<?,?> ss = SlideShowFactory.create(ssSamples.getFile(file));
            Slide<?,?> slide = ss.getSlides().get(0);
            PictureShape<?,?> picShape = null;
            for (Shape<?,?> shape : slide.getShapes()) {
                if (shape instanceof PictureShape) {
                    picShape = (PictureShape<?,?>)shape;
                    break;
                }
            }
            assertNotNull(picShape);
            PictureData pd = picShape.getPictureData();
            Dimension dimPd = pd.getImageDimension();
            new DrawPictureShape(picShape).resize();
            Dimension dimShape = picShape.getAnchor().getSize();
            assertEquals(dimPd, dimShape);
            
            int newWidth = (int)(dimPd.getWidth()*(100d/dimPd.getHeight()));
            // ... -1 is a rounding error
            Rectangle expRect = new Rectangle(50+300-newWidth-1, 50, newWidth, 100);
            Rectangle target = new Rectangle(50,50,300,100);
            new DrawPictureShape(picShape).resize(target, RectAlign.BOTTOM_RIGHT);
            Rectangle actRect = picShape.getAnchor();
            assertEquals(expRect, actRect);
        }
    }

