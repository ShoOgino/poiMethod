    private TextBox<?,?> resizeToFitText(SlideShow<?,?> slideshow) throws IOException {
        Slide<?,?> sld = slideshow.createSlide();
        TextBox<?,?> tb = sld.createTextBox();
        tb.setAnchor(new Rectangle(50, 50, 200, 50));
        tb.setStrokeStyle(Color.black, LineDash.SOLID, 3);
        tb.setText(JPTEXT);
        
        setFont(tb, "NoSuchFont");

        Dimension pgsize = slideshow.getPageSize();
        int width = (int)pgsize.getWidth();
        int height = (int)pgsize.getHeight();
        
        BufferedImage img = new BufferedImage(width, height, BufferedImage.TYPE_INT_ARGB);
        Graphics2D graphics = img.createGraphics();

        Map<String,String> fallbackMap = new HashMap<String,String>();
        fallbackMap.put("NoSuchFont", "Mona");
        graphics.setRenderingHint(Drawable.FONT_FALLBACK, fallbackMap);
        graphics.setRenderingHint(RenderingHints.KEY_FRACTIONALMETRICS, RenderingHints.VALUE_FRACTIONALMETRICS_ON);
        
        DrawFactory.getInstance(graphics).fixFonts(graphics);
        
        tb.resizeToFitText(graphics);
        graphics.dispose();
        
        return tb;
    }

