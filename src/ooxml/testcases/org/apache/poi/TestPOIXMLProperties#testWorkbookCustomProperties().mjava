	public void testWorkbookCustomProperties() {
		XSSFWorkbook workbook = new XSSFWorkbook();
		POIXMLProperties props = workbook.getProperties();
		assertNotNull(props);

		org.apache.poi.POIXMLProperties.CustomProperties properties =
				props.getCustomProperties();

		org.openxmlformats.schemas.officeDocument.x2006.customProperties.CTProperties
				ctProps = properties.getUnderlyingProperties();


		org.openxmlformats.schemas.officeDocument.x2006.customProperties.CTProperty
				property = ctProps.addNewProperty();


		String fmtid =
				"{A1A1A1A1A1A1A1A1-A1A1A1A1-A1A1A1A1-A1A1A1A1-A1A1A1A1A1A1A1A1}";
		int pId = 1;
		String name = "testProperty";
		String stringValue = "testValue";


		property.setFmtid(fmtid);
		property.setPid(pId);
		property.setName(name);
		property.setBstr(stringValue);


		property = null;
		ctProps = null;
		properties = null;
		props = null;

		XSSFWorkbook newWorkbook =
				XSSFTestDataSamples.writeOutAndReadBack(workbook);

		assertTrue(workbook != newWorkbook);


		POIXMLProperties newProps = newWorkbook.getProperties();
		assertNotNull(newProps);
		org.apache.poi.POIXMLProperties.CustomProperties newProperties =
				newProps.getCustomProperties();

		org.openxmlformats.schemas.officeDocument.x2006.customProperties.CTProperties
				newCtProps = newProperties.getUnderlyingProperties();

		assertEquals(1, newCtProps.getPropertyArray().length);


		org.openxmlformats.schemas.officeDocument.x2006.customProperties.CTProperty
				newpProperty = newCtProps.getPropertyArray()[0];

		assertEquals(fmtid, newpProperty.getFmtid());
		assertEquals(pId, newpProperty.getPid());
		assertEquals(name, newpProperty.getName());
		assertEquals(stringValue, newpProperty.getBstr());


	}

