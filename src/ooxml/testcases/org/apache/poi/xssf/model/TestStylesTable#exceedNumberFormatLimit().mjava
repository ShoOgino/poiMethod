    @Test
    public void exceedNumberFormatLimit() throws IOException {
        XSSFWorkbook wb = new XSSFWorkbook();
        try {
            StylesTable styles = wb.getStylesSource();
            for (int i = 0; i < styles.getMaxNumberOfDataFormats(); i++) {
                wb.getStylesSource().putNumberFormat("\"test" + i + " \"0");
            }
            try {
                wb.getStylesSource().putNumberFormat("\"anotherformat \"0");
            } catch (final IllegalStateException e) {
                if (e.getMessage().startsWith("The maximum number of Data Formats was exceeded.")) {
                    //expected
                }
                else {
                    throw e;
                }
            }
        } finally {
            wb.close();
        }
    }

