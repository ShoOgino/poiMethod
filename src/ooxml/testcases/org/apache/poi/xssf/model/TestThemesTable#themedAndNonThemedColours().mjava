    /**
     * Ensure that, for a file with themes, we can correctly
     *  read both the themed and non-themed colours back.
     * Column A = Theme Foreground
     * Column B = Theme Foreground
     * Column C = Explicit Colour Foreground
     * Column E = Explicit Colour Background, Black Foreground
     * Column G = Conditional Formatting Backgrounds
     */
    @Test
    public void themedAndNonThemedColours() {
        XSSFWorkbook wb = XSSFTestDataSamples.openSampleWorkbook(testFileComplex);
        XSSFSheet sheet = wb.getSheetAt(0);
        XSSFCellStyle style;
        XSSFColor color;
        XSSFCell cell;
        
        String[] names = {"White","Black","Grey","Dark Blue","Blue","Red","Green"};
        assertEquals(7, names.length);
        
        // Check the non-CF colours in Columns A, B, C and E
        for (int rn=1; rn<8; rn++) {
            int idx = rn-1;
            XSSFRow row = sheet.getRow(rn);
            assertNotNull("Missing row " + rn, row);
            
            // Theme cells come first
            XSSFCell themeCell = row.getCell(0);
            ThemeElement themeElem = ThemeElement.byId(idx);
            assertCellContents(themeElem.name, themeCell);

            // Sanity check names
            assertCellContents(names[idx], row.getCell(1));
            assertCellContents(names[idx], row.getCell(2));
            assertCellContents(names[idx], row.getCell(4));
            
            // Check the colours
            //  A: Theme Based, Foreground
            style = themeCell.getCellStyle();
            color = style.getFont().getXSSFColor();
            assertEquals(true, color.isThemed());
            assertEquals(idx, color.getTheme());
            assertEquals(rgbExpected[idx], Hex.encodeHexString(color.getRGB()));
            //  B: Theme Based, Foreground
            cell = row.getCell(1);
            style = cell.getCellStyle();
            color = style.getFont().getXSSFColor();
            assertEquals(true, color.isThemed());
            // TODO Fix the grey theme color in Column B
            if (idx != 2) {
                assertEquals(idx, color.getTheme());
                assertEquals(rgbExpected[idx], Hex.encodeHexString(color.getRGB()));
            }
        }
        
        // Check the CF colours
        // TODO
    }

