    @SuppressWarnings("resource")
    @Test
    public void testIntegration() throws Exception {
        XSSFWorkbook wb = new XSSFWorkbook();
        wb.createSheet("Testing purpose sheet");
        assertFalse(wb.isRevisionLocked());

        wb.lockRevision();
        wb.setRevisionsPassword("test", null);

        wb = writeOutAndReadBack(wb);
        
        assertTrue(wb.isRevisionLocked());
        assertTrue(wb.validateRevisionsPassword("test"));
    }

