   /**
    * Test text extraction from text box using getShapes()
    * @throws Exception
    */
   public void testShapes() throws Exception{
       OPCPackage pkg =  XSSFTestDataSamples.openSamplePackage("WithTextBox.xlsx");
       XSSFReader r = new XSSFReader(pkg);
       XSSFReader.SheetIterator it = (XSSFReader.SheetIterator)r.getSheetsData();
       
       StringBuilder sb = new StringBuilder();
       while(it.hasNext())
       {    
          it.next();
          List<XSSFShape> shapes = it.getShapes();
          if (shapes != null){
              for (XSSFShape shape : shapes){
                  if (shape instanceof XSSFSimpleShape){
                      String t = ((XSSFSimpleShape)shape).getText();
                      sb.append(t).append('\n');
                  }
              }
          }
       }
       String text = sb.toString();
       assertTrue(text.indexOf("Line 1") > -1);
       assertTrue(text.indexOf("Line 2") > -1);
       assertTrue(text.indexOf("Line 3") > -1);

   }

