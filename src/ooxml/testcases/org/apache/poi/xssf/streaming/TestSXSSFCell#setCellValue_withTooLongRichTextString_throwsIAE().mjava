    @Test(expected = IllegalArgumentException.class)
    public void setCellValue_withTooLongRichTextString_throwsIAE() {
        Cell cell = spy(new SXSSFCell(null, CellType.BLANK));
        RichTextString string = spy(new XSSFRichTextString(""));
        doReturn(SpreadsheetVersion.EXCEL2007.getMaxTextLength() + 1).when(string).length();
        cell.setCellValue(string);
    }

