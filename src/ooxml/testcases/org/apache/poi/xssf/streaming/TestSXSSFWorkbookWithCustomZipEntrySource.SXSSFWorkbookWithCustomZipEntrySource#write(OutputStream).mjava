        @Override
        public void write(OutputStream stream) throws IOException {
            flushSheets();
            ByteArrayOutputStream os = new ByteArrayOutputStream();
            getXSSFWorkbook().write(os);
            ZipEntrySource source = null;
            try {
                // provide ZipEntrySource to poi which decrypts on the fly
                source = AesZipFileZipEntrySource.createZipEntrySource(new ByteArrayInputStream(os.toByteArray()));
                injectData(source, stream);
            } catch (GeneralSecurityException e) {
                throw new IOException(e);
            } finally {
                source.close();
            }
        }

