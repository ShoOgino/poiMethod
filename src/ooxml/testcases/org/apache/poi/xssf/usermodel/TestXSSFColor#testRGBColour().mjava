   public void testRGBColour() throws Exception {
      XSSFWorkbook wb = XSSFTestDataSamples.openSampleWorkbook("50299.xlsx");

      // Check the CTColor is as expected
      XSSFColor rgb3 = wb.getCellStyleAt((short)25).getFillForegroundXSSFColor();
      assertEquals(false, rgb3.getCTColor().isSetIndexed());
      assertEquals(0,     rgb3.getCTColor().getIndexed());
      assertEquals(true,  rgb3.getCTColor().isSetTint());
      assertEquals(-0.34999, rgb3.getCTColor().getTint(), 0.00001);
      assertEquals(true,  rgb3.getCTColor().isSetRgb());
      assertEquals(3,     rgb3.getCTColor().getRgb().length);

      // Now check the XSSFColor
      assertEquals(0, rgb3.getIndexed());
      assertEquals(-0.34999, rgb3.getTint(), 0.00001);

      assertEquals("FFFFFFFF", rgb3.getARGBHex());
      assertEquals(3, rgb3.getRgb().length);
      assertEquals(-1, rgb3.getRgb()[0]);
      assertEquals(-1, rgb3.getRgb()[1]);
      assertEquals(-1,  rgb3.getRgb()[2]);

      assertEquals(4, rgb3.getARgb().length);
      assertEquals(-1, rgb3.getARgb()[0]);
      assertEquals(-1, rgb3.getARgb()[1]);
      assertEquals(-1,  rgb3.getARgb()[2]);
      assertEquals(-1,  rgb3.getARgb()[3]);

      // Tint doesn't have the alpha
      // tint = -0.34999
      // 255 * (1 + tint) = 165 truncated
      // or (byte) -91 (which is 165 - 256)
      assertEquals(3, rgb3.getRgbWithTint().length);
      assertEquals(-91, rgb3.getRgbWithTint()[0]);
      assertEquals(-91,  rgb3.getRgbWithTint()[1]);
      assertEquals(-91,  rgb3.getRgbWithTint()[2]);

      // Set the color to black (no theme).
      rgb3.setRgb(new byte[] {0, 0, 0});
      assertEquals("FF000000", rgb3.getARGBHex());
      assertEquals(0, rgb3.getCTColor().getRgb()[0]);
      assertEquals(0, rgb3.getCTColor().getRgb()[1]);
      assertEquals(0, rgb3.getCTColor().getRgb()[2]);

      // Set another, is fine
      rgb3.setRgb(new byte[] {16,17,18});
      assertEquals("FF101112", rgb3.getARGBHex());
      assertEquals(0x10, rgb3.getCTColor().getRgb()[0]);
      assertEquals(0x11, rgb3.getCTColor().getRgb()[1]);
      assertEquals(0x12, rgb3.getCTColor().getRgb()[2]);
   }

