	/**
	 * We should carry vba macros over after save
	 */
	public void test45431() throws Exception {
		Package pkg = Package.open(getFilePath("45431.xlsm"));
		XSSFWorkbook wb = new XSSFWorkbook(pkg);
		
		// Check the various macro related bits can be found
		PackagePart vba = pkg.getPart(
				PackagingURIHelper.createPartName("/xl/vbaProject.bin")
		);
		assertNotNull(vba);
		
		// Save and re-open, is still there
		Package nPkg = saveAndOpen(wb);
		XSSFWorkbook nwb = new XSSFWorkbook(nPkg);
		vba = nPkg.getPart(
				PackagingURIHelper.createPartName("/xl/vbaProject.bin")
		);
		assertNotNull(vba);
		
		// And again, just to be sure
		nPkg = saveAndOpen(nwb);
		nwb = new XSSFWorkbook(nPkg);
		vba = nPkg.getPart(
				PackagingURIHelper.createPartName("/xl/vbaProject.bin")
		);
		assertNotNull(vba);
		
		FileOutputStream fout = new FileOutputStream("/tmp/foo.xlsm");
		nwb.write(fout);
		fout.close();
		
		// For testing with excel
//		FileOutputStream fout = new FileOutputStream("/tmp/foo.xlsm");
//		nwb.write(fout);
//		fout.close();
	}

