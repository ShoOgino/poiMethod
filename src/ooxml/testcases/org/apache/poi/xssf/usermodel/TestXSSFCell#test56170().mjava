    @Test
    public void test56170() throws IOException {
        final Workbook wb = XSSFTestDataSamples.openSampleWorkbook("56170.xlsx");
        final XSSFSheet sheet = (XSSFSheet) wb.getSheetAt(0);

        Workbook wbRead = XSSFTestDataSamples.writeOutAndReadBack(wb);
        Cell cell;
        
        // add some contents to table so that the table will need expansion
        Row row = sheet.getRow(0);
        wbRead = XSSFTestDataSamples.writeOutAndReadBack(wb);
        cell = row.createCell(0);
        wbRead = XSSFTestDataSamples.writeOutAndReadBack(wb);
        cell.setCellValue("demo1");
        wbRead = XSSFTestDataSamples.writeOutAndReadBack(wb);
        cell = row.createCell(1);
        wbRead = XSSFTestDataSamples.writeOutAndReadBack(wb);
        cell.setCellValue("demo2");
        wbRead = XSSFTestDataSamples.writeOutAndReadBack(wb);
        cell = row.createCell(2);
        wbRead = XSSFTestDataSamples.writeOutAndReadBack(wb);
        cell.setCellValue("demo3");

        wbRead = XSSFTestDataSamples.writeOutAndReadBack(wb);
        
        row = sheet.getRow(1);
        cell = row.createCell(0);
        cell.setCellValue("demo1");
        cell = row.createCell(1);
        cell.setCellValue("demo2");
        cell = row.createCell(2);
        cell.setCellValue("demo3");

        wbRead = XSSFTestDataSamples.writeOutAndReadBack(wb);
        
        // expand table
        XSSFTable table = sheet.getTables().get(0);
        final CellReference startRef = table.getStartCellReference();
        final CellReference endRef = table.getEndCellReference();
        table.getCTTable().setRef(new CellRangeAddress(startRef.getRow(), 1, startRef.getCol(), endRef.getCol()).formatAsString());

        wbRead = XSSFTestDataSamples.writeOutAndReadBack(wb);
        assertNotNull(wbRead);

        /*FileOutputStream stream = new FileOutputStream("c:\\temp\\output.xlsx");
        workbook.write(stream);
        stream.close();*/
    }

