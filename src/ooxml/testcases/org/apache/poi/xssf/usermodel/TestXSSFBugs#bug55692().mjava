    /**
     * Password Protected .xlsx files should give a helpful
     *  error message when called via WorkbookFactory.
     * (You need to supply a password explicitly for them)
     */
    @Test
    public void bug55692() throws Exception {
    	InputStream inpA = POIDataSamples.getPOIFSInstance().openResourceAsStream("protect.xlsx");
    	InputStream inpB = POIDataSamples.getPOIFSInstance().openResourceAsStream("protect.xlsx");
    	InputStream inpC = POIDataSamples.getPOIFSInstance().openResourceAsStream("protect.xlsx");

    	// Directly on a Stream
    	try {
    		WorkbookFactory.create(inpA);
    		fail("Should've raised a EncryptedDocumentException error");
    	} catch (EncryptedDocumentException e) {}
    	
    	// Via a POIFSFileSystem
    	POIFSFileSystem fsP = new POIFSFileSystem(inpB);
    	try {
    		WorkbookFactory.create(fsP);
    		fail("Should've raised a EncryptedDocumentException error");
    	} catch (EncryptedDocumentException e) {}

    	// Via a NPOIFSFileSystem
    	NPOIFSFileSystem fsNP = new NPOIFSFileSystem(inpC);
    	try {
    		WorkbookFactory.create(fsNP);
    		fail("Should've raised a EncryptedDocumentException error");
    	} catch (EncryptedDocumentException e) {}
    }

