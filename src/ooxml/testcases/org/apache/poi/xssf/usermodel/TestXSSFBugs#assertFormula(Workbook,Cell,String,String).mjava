    private void assertFormula(Workbook wb, Cell intF, String expectedFormula, String expectedResultOrNull) {
        assertEquals(Cell.CELL_TYPE_FORMULA, intF.getCellType());
        if (null == expectedResultOrNull) {
            assertEquals(Cell.CELL_TYPE_ERROR, intF.getCachedFormulaResultType());
            expectedResultOrNull = "#VALUE!";
        }
        else {
            assertEquals(Cell.CELL_TYPE_NUMERIC, intF.getCachedFormulaResultType());
        }
        
        assertEquals(expectedFormula, intF.getCellFormula());

        // Check we can evaluate it correctly
        FormulaEvaluator eval = wb.getCreationHelper().createFormulaEvaluator();
        assertEquals(expectedResultOrNull, eval.evaluate(intF).formatAsString());
    }

