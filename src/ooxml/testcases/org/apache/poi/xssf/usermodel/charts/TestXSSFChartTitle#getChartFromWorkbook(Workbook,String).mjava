    /**
     * Gets the first chart from the named sheet in the workbook.
     */
    private XSSFChart getChartFromWorkbook(Workbook wb, String sheetName) {
        Sheet sheet = wb.getSheet(sheetName);
        if (sheet instanceof XSSFSheet) {
            XSSFSheet xsheet = (XSSFSheet) sheet;
            XSSFDrawing drawing = xsheet.getDrawingPatriarch();
            if (drawing != null) {
                List<XSSFChart> charts = drawing.getCharts();
                if (charts != null && charts.size() > 0) {
                    return charts.get(0);
                }
            }
        }
        return null;
    }

