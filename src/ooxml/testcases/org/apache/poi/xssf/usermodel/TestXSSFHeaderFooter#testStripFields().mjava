	public void testStripFields() {
		String simple = "I am a test header";
		String withPage = "I am a&P test header";
		String withLots = "I&A am&N a&P test&T header&U";
		String withFont = "I&22 am a&\"Arial,bold\" test header";
		String withOtherAnds = "I am a&P test header&&";
		String withOtherAnds2 = "I am a&P test header&a&b";
		
		assertEquals(simple, XSSFOddHeader.stripFields(simple));
		assertEquals(simple, XSSFOddHeader.stripFields(withPage));
		assertEquals(simple, XSSFOddHeader.stripFields(withLots));
		assertEquals(simple, XSSFOddHeader.stripFields(withFont));
		assertEquals(simple + "&&", XSSFOddHeader.stripFields(withOtherAnds));
		assertEquals(simple + "&a&b", XSSFOddHeader.stripFields(withOtherAnds2));
		
		// Now test the default strip flag
		XSSFEvenHeader head = new XSSFEvenHeader(CTHeaderFooter.Factory.newInstance());
		head.setCenter("Center");
		head.setLeft("In the left");
    
    	assertEquals("In the left", head.getLeft());
    	assertEquals("Center", head.getCenter());
    	assertEquals("", head.getRight());
    	
    	head.setLeft("Top &P&F&D Left");
    	assertEquals("Top &P&F&D Left", head.getLeft());
    	assertFalse(head.areFieldsStripped());
    	
    	head.setAreFieldsStripped(true);
    	assertEquals("Top  Left", head.getLeft());
    	assertTrue(head.areFieldsStripped());
    	
    	// Now even more complex
    	head.setCenter("HEADER TEXT &P&N&D&T&Z&F&F&A&G");
    	assertEquals("HEADER TEXT &G", head.getCenter());
	}

