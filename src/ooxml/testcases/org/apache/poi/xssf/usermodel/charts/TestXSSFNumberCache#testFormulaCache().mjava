    public void testFormulaCache() {
	Workbook wb = new XSSFWorkbook();
	Sheet sheet = new SheetBuilder(wb, plotData).build();
	Drawing drawing = sheet.createDrawingPatriarch();
	ClientAnchor anchor = drawing.createAnchor(0, 0, 0, 0, 1, 1, 10, 30);
	Chart chart = drawing.createChart(anchor);

	ChartAxis bottomAxis = chart.getChartAxisFactory().createValueAxis(AxisPosition.BOTTOM);
	ChartAxis leftAxis = chart.getChartAxisFactory().createValueAxis(AxisPosition.LEFT);

	ScatterChartData scatterChartData =
	    chart.getChartDataFactory().createScatterChartData();

	DataMarker xMarker = new DataMarker(sheet, CellRangeAddress.valueOf("A1:E1"));
	DataMarker yMarker = new DataMarker(sheet, CellRangeAddress.valueOf("A2:E2"));
	ScatterChartSerie serie = scatterChartData.addSerie(xMarker, yMarker);

	chart.plot(scatterChartData, bottomAxis, leftAxis);

	XSSFScatterChartData.Serie xssfScatterSerie =
	    (XSSFScatterChartData.Serie) serie;
	XSSFNumberCache yCache = xssfScatterSerie.getLastCalculatedYCache();

	assertEquals(5, yCache.getPointCount());
	assertEquals(4.0, yCache.getValueAt(3), 0.00001);
	assertEquals(16.0, yCache.getValueAt(5), 0.00001);
    }

