    /**
     * See https://stackoverflow.com/questions/44407111/apache-poi-cant-format-filled-cells-as-numeric
     */
    @Test
    public void testNumericCellsInTable() throws IOException {
        XSSFWorkbook wb = new XSSFWorkbook();
        XSSFSheet s = wb.createSheet();

        //Setting up the CTTable
        XSSFTable t = s.createTable();
        CTTable ctt = t.getCTTable();
        ctt.setId(1);
        ctt.setName("CT Table Test");
        ctt.setRef("A1:B2");
        CTTableColumns cttcs = ctt.addNewTableColumns();
        CTTableColumn cttc1 = cttcs.addNewTableColumn();
        cttc1.setId(1);
        CTTableColumn cttc2 = cttcs.addNewTableColumn();
        cttc2.setId(2);

        //Creating the cells
        Cell c1 = s.createRow(0).createCell(0);
        XSSFCell c2 = s.getRow(0).createCell(1);
        XSSFCell c3 = s.createRow(1).createCell(0);
        XSSFCell c4 = s.getRow(1).createCell(1);

        // Inserting values; some numeric strings, some alphabetical strings
        c1.setCellValue(12);
        c2.setCellValue(34); 
        c3.setCellValue("AB");
        c4.setCellValue("CD");

        // Save and re-load
        wb = XSSFTestDataSamples.writeOutAndReadBack(wb);
        s = wb.getSheetAt(0);
        
        // Check
        assertEquals(1, s.getTables().size());
        t = s.getTables().get(0);
        assertEquals("A1", t.getStartCellReference().formatAsString());
        assertEquals("B2", t.getEndCellReference().formatAsString());
        
        // Done
        wb.close();
    }

