    @Test
    public void testAddPivotTableToWorkbookWithLoadedPivotTable() throws Exception {
        File file = TempFile.createTempFile("ooxml-pivottable", ".xlsx");

        XSSFWorkbook wb = new XSSFWorkbook();
        try {
            setPivotData(wb);

            FileOutputStream fileOut = new FileOutputStream(file);
            try {
                wb.write(fileOut);
            } finally {
                fileOut.close();
            }
        } finally {
            wb.close();
        }

        XSSFWorkbook wb2 = (XSSFWorkbook) WorkbookFactory.create(file);
        try {
            setPivotData(wb2);
            assertTrue(wb2.getPivotTables().size() == 2);
        } finally {
            wb2.close();
        }

        assertTrue(file.delete());
    }

