    public void testSetGetStringShared() {
        XSSFRow row = createParentObjects();
        XSSFCell cell = row.createCell(0);
        //we return empty string for blank cells
        assertEquals("", cell.getStringCellValue());

        cell.setCellValue(new XSSFRichTextString("test"));
        assertEquals(Cell.CELL_TYPE_STRING, cell.getCellType());
        assertEquals("test", cell.getRichStringCellValue().getString());

        cell.setCellValue(new XSSFRichTextString("Foo"));
        assertEquals(Cell.CELL_TYPE_STRING, cell.getCellType());
        assertEquals("Foo", cell.getRichStringCellValue().getString());

        cell.setCellValue((String)null);
        assertEquals(Cell.CELL_TYPE_BLANK, cell.getCellType());

        XSSFCell fcell = row.createCell(1);
        fcell.setCellFormula("SUM(C4:E4)");
        assertEquals(Cell.CELL_TYPE_FORMULA, fcell.getCellType());
        fcell.setCellValue("36.6");
        assertEquals(Cell.CELL_TYPE_FORMULA, fcell.getCellType());
        assertEquals("36.6", fcell.getStringCellValue());

    }

