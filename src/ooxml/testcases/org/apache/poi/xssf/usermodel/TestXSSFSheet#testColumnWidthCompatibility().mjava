    public void testColumnWidthCompatibility() {
        Workbook wb1 = new HSSFWorkbook();
        Workbook wb2 = new XSSFWorkbook();

        Sheet sh1 = wb1.createSheet();
        Sheet sh2 = wb2.createSheet();

        assertEquals(sh1.getDefaultColumnWidth(), sh2.getDefaultColumnWidth());

        //if column width is not set, HSSF returns a wrong value which does not take into account
        //margins and borders, it is always less than the actual column width
        assertEquals(2048, sh1.getColumnWidth(0));
        assertEquals(2340, sh2.getColumnWidth(0));

        sh1.setDefaultColumnWidth(1000);
        sh2.setDefaultColumnWidth(1000);
        assertEquals(1000, sh2.getDefaultColumnWidth());
        assertEquals(sh1.getDefaultColumnWidth(), sh2.getDefaultColumnWidth());

        sh1.setColumnWidth(0, 500);
        sh2.setColumnWidth(0, 500);
        assertEquals(500, sh2.getColumnWidth(0));
        assertEquals(sh1.getColumnWidth(0), sh2.getColumnWidth(0));
    }

