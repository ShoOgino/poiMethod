    @Test
    public void testSetColor() throws IOException {
        Workbook wb = new XSSFWorkbook();
        Sheet sheet = wb.createSheet();
        Row row = sheet.createRow(0);
        
        DataFormat format = wb.createDataFormat();
        Cell cell = row.createCell(1);
        cell.setCellValue("somevalue");
        CellStyle cellStyle2 = wb.createCellStyle();


        cellStyle2.setDataFormat(format.getFormat("###0"));

        cellStyle2.setFillBackgroundColor(IndexedColors.DARK_BLUE.getIndex());
        cellStyle2.setFillForegroundColor(IndexedColors.DARK_BLUE.getIndex());
        cellStyle2.setFillPattern(CellStyle.SOLID_FOREGROUND);

        cellStyle2.setAlignment(CellStyle.ALIGN_RIGHT);
        cellStyle2.setVerticalAlignment(CellStyle.VERTICAL_TOP);

        cell.setCellStyle(cellStyle2);

        Workbook wbBack = XSSFTestDataSamples.writeOutAndReadBack(wb);
        Cell cellBack = wbBack.getSheetAt(0).getRow(0).getCell(1);
        assertNotNull(cellBack);
        CellStyle styleBack = cellBack.getCellStyle();
        assertEquals(IndexedColors.DARK_BLUE.getIndex(), styleBack.getFillBackgroundColor());
        assertEquals(IndexedColors.DARK_BLUE.getIndex(), styleBack.getFillForegroundColor());
        assertEquals(CellStyle.ALIGN_RIGHT, styleBack.getAlignment());
        assertEquals(CellStyle.VERTICAL_TOP, styleBack.getVerticalAlignment());
        assertEquals(CellStyle.SOLID_FOREGROUND, styleBack.getFillPattern());
        
        wbBack.close();
        
        wb.close();
    }

