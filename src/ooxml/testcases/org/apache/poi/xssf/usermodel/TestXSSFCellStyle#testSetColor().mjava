    @Test
    public void testSetColor() throws IOException {
        Workbook wb = new XSSFWorkbook();
        Sheet sheet = wb.createSheet();
        Row row = sheet.createRow(0);
        
        //CreationHelper ch = wb.getCreationHelper();
        DataFormat format = wb.createDataFormat();
        Cell cell = row.createCell(1);
        cell.setCellValue("somevalue");
        CellStyle cellStyle = wb.createCellStyle();


        cellStyle.setDataFormat(format.getFormat("###0"));

        cellStyle.setFillBackgroundColor(IndexedColors.DARK_BLUE.getIndex());
        cellStyle.setFillForegroundColor(IndexedColors.DARK_BLUE.getIndex());
        cellStyle.setFillPattern(CellStyle.SOLID_FOREGROUND);

        cellStyle.setAlignment(CellStyle.ALIGN_RIGHT);
        cellStyle.setVerticalAlignment(CellStyle.VERTICAL_TOP);

        cell.setCellStyle(cellStyle);

        /*OutputStream stream = new FileOutputStream("C:\\temp\\CellColor.xlsx");
        try {
            wb.write(stream);
        } finally {
            stream.close();
        }*/
        
        Workbook wbBack = XSSFTestDataSamples.writeOutAndReadBack(wb);
        Cell cellBack = wbBack.getSheetAt(0).getRow(0).getCell(1);
        assertNotNull(cellBack);
        CellStyle styleBack = cellBack.getCellStyle();
        assertEquals(IndexedColors.DARK_BLUE.getIndex(), styleBack.getFillBackgroundColor());
        assertEquals(IndexedColors.DARK_BLUE.getIndex(), styleBack.getFillForegroundColor());
        assertEquals(CellStyle.ALIGN_RIGHT, styleBack.getAlignment());
        assertEquals(CellStyle.VERTICAL_TOP, styleBack.getVerticalAlignment());
        assertEquals(CellStyle.SOLID_FOREGROUND, styleBack.getFillPattern());
        
        wbBack.close();
        
        wb.close();
    }

