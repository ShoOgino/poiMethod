    /**
     * Test that XSSFRow.getLastCellNum is consistent with HSSFRow.getLastCellNum
     */
    public void testLastCellNum() {
        HSSFWorkbook wb1 = new HSSFWorkbook();
        XSSFWorkbook wb2 = new XSSFWorkbook();

        HSSFSheet sheet1 = wb1.createSheet();
        XSSFSheet sheet2 = wb2.createSheet();

        for (int i = 0; i < 10; i++) {
            HSSFRow row1 = sheet1.createRow(i);
            XSSFRow row2 = sheet2.createRow(i);

            for (int j = 0; j < 5; j++) {
                //before adding a cell
                assertEquals(row1.getLastCellNum(), row2.getLastCellNum());

                HSSFCell cell1 = row1.createCell(j);
                XSSFCell cell2 = row2.createCell(j);

                //after adding a cell
                assertEquals(row1.getLastCellNum(), row2.getLastCellNum());
            }
        }
    }

