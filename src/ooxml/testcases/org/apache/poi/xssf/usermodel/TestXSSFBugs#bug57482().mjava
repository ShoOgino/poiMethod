    /**
     * A .xlsx file with no Shared Strings table should open fine
     *  in read-only mode
     */
    @SuppressWarnings("resource")
    @Test
    public void bug57482() throws Exception {
        for (PackageAccess access : new PackageAccess[] {
                PackageAccess.READ_WRITE, PackageAccess.READ
        }) {
            File file = HSSFTestDataSamples.getSampleFile("57482-OnlyNumeric.xlsx");
            OPCPackage pkg = OPCPackage.open(file, access);
            try {
                // Try to open it and read the contents
                XSSFWorkbook wb = new XSSFWorkbook(pkg);
                assertNotNull(wb.getSharedStringSource());
                assertEquals(0, wb.getSharedStringSource().getCount());
                
                DataFormatter fmt = new DataFormatter();
                XSSFSheet s = wb.getSheetAt(0);
                assertEquals("1",  fmt.formatCellValue(s.getRow(0).getCell(0)));
                assertEquals("11", fmt.formatCellValue(s.getRow(0).getCell(1)));
                assertEquals("5",  fmt.formatCellValue(s.getRow(4).getCell(0)));
                
                // Add a text cell
                s.getRow(0).createCell(3).setCellValue("Testing");
                assertEquals("Testing",  fmt.formatCellValue(s.getRow(0).getCell(3)));
                
                // Try to write-out and read again, should only work
                //  in read-write mode, not read-only mode
                try {
                    wb = XSSFTestDataSamples.writeOutAndReadBack(wb);
                    if (access == PackageAccess.READ)
                        fail("Shouln't be able to write from read-only mode");
                } catch (InvalidOperationException e) {
                    if (access == PackageAccess.READ) {
                        // Expected
                    } else {
                        // Shouldn't occur in write-mode
                        throw e;
                    }
                }
                
                // Check again
                s = wb.getSheetAt(0);
                assertEquals("1",  fmt.formatCellValue(s.getRow(0).getCell(0)));
                assertEquals("11", fmt.formatCellValue(s.getRow(0).getCell(1)));
                assertEquals("5",  fmt.formatCellValue(s.getRow(4).getCell(0)));
                assertEquals("Testing",  fmt.formatCellValue(s.getRow(0).getCell(3)));
            } finally {
                pkg.revert();
            }
        }
    }

