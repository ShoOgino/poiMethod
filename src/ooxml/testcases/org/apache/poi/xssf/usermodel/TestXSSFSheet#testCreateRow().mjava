	public void testCreateRow() throws Exception {
		XSSFWorkbook workbook = new XSSFWorkbook();
		Sheet sheet = workbook.createSheet("Sheet 1");
		
		// Test row creation with consecutive indexes
		Row row1 = sheet.createRow(0);
		Row row2 = sheet.createRow(1);
		assertEquals(0, row1.getRowNum());
		Iterator<Row> it = sheet.rowIterator();
		assertTrue(it.hasNext());
		assertEquals(row1, it.next());
		assertTrue(it.hasNext());
		assertEquals(row2, it.next());
		
		// Test row creation with non consecutive index
		Row row101 = sheet.createRow(100);
		assertNotNull(row101);
		
		// Test overwriting an existing row
		Row row2_ovrewritten = sheet.createRow(1);
		Cell cell = row2_ovrewritten.createCell((short) 0);
		cell.setCellType(Cell.CELL_TYPE_NUMERIC);
		cell.setCellValue((double) 100);
		Iterator<Row> it2 = sheet.rowIterator();
		assertTrue(it2.hasNext());
		assertEquals(row1, it2.next());
		assertTrue(it2.hasNext());
		Row row2_overwritten_copy = it2.next();
		assertEquals(row2_ovrewritten, row2_overwritten_copy);
		assertEquals(row2_overwritten_copy.getCell((short) 0).getNumericCellValue(), (double) 100);
	}

