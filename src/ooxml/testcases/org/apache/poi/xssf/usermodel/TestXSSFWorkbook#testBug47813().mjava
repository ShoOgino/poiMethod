	/**
	 * Problems with XSSFWorkbook.removeSheetAt when workbook contains charts
	 */
	public void testBug47813() {
		XSSFWorkbook wb = XSSFTestDataSamples.openSampleWorkbook("47813.xlsx");
		assertEquals(3, wb.getNumberOfSheets());
		assertNotNull(wb.getCalculationChain());

		assertEquals("Numbers", wb.getSheetName(0));
		//the second sheet is of type 'chartsheet'
		assertEquals("Chart", wb.getSheetName(1));
		assertTrue(wb.getSheetAt(1) instanceof XSSFChartSheet);
		assertEquals("SomeJunk", wb.getSheetName(2));

		wb.removeSheetAt(2);
		assertEquals(2, wb.getNumberOfSheets());
		assertNull(wb.getCalculationChain());

		wb = XSSFTestDataSamples.writeOutAndReadBack(wb);
		assertEquals(2, wb.getNumberOfSheets());
		assertNull(wb.getCalculationChain());

		assertEquals("Numbers", wb.getSheetName(0));
		assertEquals("Chart", wb.getSheetName(1));
	}

