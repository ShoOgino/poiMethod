    public void testApplyFont() throws Exception {

        XSSFRichTextString rt = new XSSFRichTextString();
        rt.append("123");
        rt.append("4567");
        rt.append("89");

        XSSFFont font1 = new XSSFFont();
        font1.setBold(true);

        rt.applyFont(2, 5, font1);

        assertEquals(5, rt.numFormattingRuns());
        assertEquals(0, rt.getIndexOfFormattingRun(0));
        assertEquals(2, rt.getLengthOfFormattingRun(0));

        assertEquals(2, rt.getIndexOfFormattingRun(1));
        assertEquals(3, rt.getLengthOfFormattingRun(1));

        assertEquals(5, rt.getIndexOfFormattingRun(2));
        assertEquals(3, rt.getLengthOfFormattingRun(2));

        assertEquals(8, rt.getIndexOfFormattingRun(3));
        assertEquals(1, rt.getLengthOfFormattingRun(3));
    }

