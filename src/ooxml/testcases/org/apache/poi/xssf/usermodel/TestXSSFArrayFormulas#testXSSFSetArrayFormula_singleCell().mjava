    public void testXSSFSetArrayFormula_singleCell() {
        XSSFWorkbook workbook = getTestDataProvider().createWorkbook();
        XSSFSheet sheet = workbook.createSheet();

        // row 3 does not yet exist
        assertNull(sheet.getRow(2));
        CellRangeAddress range = new CellRangeAddress(2, 2, 2, 2);
        XSSFCell[] cells = sheet.setArrayFormula("SUM(C11:C12*D11:D12)", range);
        assertEquals(1, cells.length);

        // sheet.setArrayFormula creates rows and cells for the designated range
        assertNotNull(sheet.getRow(2));
        XSSFCell cell = sheet.getRow(2).getCell(2);
        assertNotNull(cell);

        assertTrue(cell.isPartOfArrayFormulaGroup());
        assertSame(cells[0], sheet.getFirstCellInArrayFormula(cells[0]));
        //retrieve the range and check it is the same
        assertEquals(range.formatAsString(), cell.getArrayFormulaRange().formatAsString());

        //check the CTCellFormula bean
        CTCellFormula f = cell.getCTCell().getF();
        assertEquals("SUM(C11:C12*D11:D12)", f.getStringValue());
        assertEquals("C3", f.getRef());
        assertEquals(STCellFormulaType.ARRAY, f.getT());

    }

