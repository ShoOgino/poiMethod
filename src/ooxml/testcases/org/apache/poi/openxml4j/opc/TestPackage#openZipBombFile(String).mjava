	private void openZipBombFile(String file) throws IOException, OpenXML4JException, XmlException {
    	try {
			Workbook wb = XSSFTestDataSamples.openSampleWorkbook(file);
			wb.close();

			try (POITextExtractor extractor = ExtractorFactory.createExtractor(HSSFTestDataSamples.getSampleFile("poc-shared-strings.xlsx"))) {
				assertNotNull(extractor);
				extractor.getText();
			}

			fail("Should catch an exception because of a ZipBomb");
		} catch (IllegalStateException e) {
    		if(!e.getMessage().contains("The text would exceed the max allowed overall size of extracted text.")) {
				throw e;
			}
		} catch (POIXMLException e) {
    		checkForZipBombException(e);
		}
	}

