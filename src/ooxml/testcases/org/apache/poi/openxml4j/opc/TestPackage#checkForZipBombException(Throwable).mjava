    private void checkForZipBombException(Throwable e) {
        if(e instanceof InvocationTargetException) {
            InvocationTargetException t = (InvocationTargetException)e;
            IOException t2 = (IOException)t.getTargetException();
            if(t2.getMessage().startsWith("Zip bomb detected!")) {
                return;
            }
        }
        
        String msg = e.getMessage();
        if(msg != null && msg.startsWith("Zip bomb detected!")) {
            return;
        }
        
        // recursively check the causes for the message as it can be nested further down in the exception-tree
        if(e.getCause() != null && e.getCause() != e) {
            checkForZipBombException(e.getCause());
            return;
        }

        throw new IllegalStateException("Expected to catch an Exception because of a detected Zip Bomb, but did not find the related error message in the exception", e);        
    }

