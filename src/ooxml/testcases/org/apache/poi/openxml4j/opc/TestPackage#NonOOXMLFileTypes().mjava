    /**
     * Verify we give helpful exceptions (or as best we can) when
     *  supplied with non-OOXML file types (eg OLE2, ODF)
     */
    @Test
    public void NonOOXMLFileTypes() throws Exception {
        // Spreadsheet has a good mix of alternate file types
        POIDataSamples files = POIDataSamples.getSpreadSheetInstance();
        
        // OLE2 - Stream
        try {
            OPCPackage.open(files.openResourceAsStream("SampleSS.xls"));
            fail("Shouldn't be able to open OLE2");
        } catch (OLE2NotOfficeXmlFileException e) {
            assertTrue(e.getMessage().indexOf("The supplied data appears to be in the OLE2 Format") > -1);
            assertTrue(e.getMessage().indexOf("You are calling the part of POI that deals with OOXML") > -1);
        }
        // OLE2 - File
        try {
            OPCPackage.open(files.getFile("SampleSS.xls"));
            fail("Shouldn't be able to open OLE2");
        } catch (OLE2NotOfficeXmlFileException e) {
            assertTrue(e.getMessage().indexOf("The supplied data appears to be in the OLE2 Format") > -1);
            assertTrue(e.getMessage().indexOf("You are calling the part of POI that deals with OOXML") > -1);
        }
        
        // Raw XML - Stream
        try {
            OPCPackage.open(files.openResourceAsStream("SampleSS.xml"));
            fail("Shouldn't be able to open XML");
        } catch (NotOfficeXmlFileException e) {
            assertTrue(e.getMessage().indexOf("The supplied data appears to be a raw XML file") > -1);
            assertTrue(e.getMessage().indexOf("Formats such as Office 2003 XML") > -1);
        }
        // Raw XML - File
        try {
            OPCPackage.open(files.getFile("SampleSS.xml"));
            fail("Shouldn't be able to open XML");
        } catch (NotOfficeXmlFileException e) {
            assertTrue(e.getMessage().indexOf("The supplied data appears to be a raw XML file") > -1);
            assertTrue(e.getMessage().indexOf("Formats such as Office 2003 XML") > -1);
        }
        
        // ODF / ODS - Stream
        try {
            OPCPackage.open(files.openResourceAsStream("SampleSS.ods"));
            fail("Shouldn't be able to open ODS");
        } catch (ODFNotOfficeXmlFileException e) {
            assertTrue(e.toString().contains("The supplied data appears to be in ODF"));
            assertTrue(e.toString().contains("Formats like these (eg ODS"));
        }
        // ODF / ODS - File
        try {
            OPCPackage.open(files.getFile("SampleSS.ods"));
            fail("Shouldn't be able to open ODS");
        } catch (ODFNotOfficeXmlFileException e) {
            assertTrue(e.toString().contains("The supplied data appears to be in ODF"));
            assertTrue(e.toString().contains("Formats like these (eg ODS"));
        }
        
        // Plain Text - Stream
        try {
            OPCPackage.open(files.openResourceAsStream("SampleSS.txt"));
            fail("Shouldn't be able to open Plain Text");
        } catch (NotOfficeXmlFileException e) {
            assertTrue(e.getMessage().indexOf("No valid entries or contents found") > -1);
            assertTrue(e.getMessage().indexOf("not a valid OOXML") > -1);
        }
        // Plain Text - File
        try {
            OPCPackage.open(files.getFile("SampleSS.txt"));
            fail("Shouldn't be able to open Plain Text");
        } catch (UnsupportedFileFormatException e) {
            // Unhelpful low-level error, sorry
        }
    }

