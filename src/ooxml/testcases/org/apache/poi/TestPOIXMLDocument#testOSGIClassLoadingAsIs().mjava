    @Test(expected=IllegalStateException.class)
    public void testOSGIClassLoadingAsIs() throws IOException {
        Thread thread = Thread.currentThread();
        ClassLoader cl = thread.getContextClassLoader();
        InputStream is = POIDataSamples.getSlideShowInstance().openResourceAsStream("table_test.pptx");
        try {
            thread.setContextClassLoader(cl.getParent());
            XMLSlideShow ppt = new XMLSlideShow(is);
            ppt.getSlides().get(0).getShapes();
        } finally {
            thread.setContextClassLoader(cl);
            is.close();
        }
    }

