    public void testBug51770() throws IOException {
        try (XWPFDocument doc = XWPFTestDataSamples.openSampleDocument("Bug51170.docx")) {
            XWPFHeaderFooterPolicy policy = doc.getHeaderFooterPolicy();
            XWPFHeader header = policy.getDefaultHeader();
            for (XWPFParagraph paragraph : header.getParagraphs()) {
                for (XWPFRun run : paragraph.getRuns()) {
                    for (XWPFPicture picture : run.getEmbeddedPictures()) {
                        if (paragraph.getDocument() != null) {
                            XWPFPictureData data = picture.getPictureData();
                            if (data != null) {
                                fail("Should have returned null: " + data.getFileName());
                            }
                        }
                    }
                }
            }
        }
    }

