	public void testGIFSupport() throws Exception
	{
	    XWPFDocument doc = XWPFTestDataSamples.openSampleDocument("WithGIF.docx");
	    ArrayList<PackagePart> gifParts = doc.getPackage().getPartsByContentType(XWPFRelation.IMAGE_GIF.getContentType());
	    assertEquals("Expected exactly one GIF part in package.",1,gifParts.size());
	    PackagePart gifPart = gifParts.get(0);
	    
	    List<POIXMLDocumentPart> relations = doc.getRelations();
	    POIXMLDocumentPart gifDocPart = null;
	    for (POIXMLDocumentPart docPart : relations)
        {
            if (gifPart == docPart.getPackagePart())
            {
                assertNull("More than one POIXMLDocumentPart for GIF PackagePart.",gifDocPart);
                gifDocPart = docPart;
            }
        }
	    assertNotNull("GIF part not related to document.xml PackagePart",gifDocPart);
	    assertTrue("XWPFRelation for GIF image was not recognized properly, as the POIXMLDocumentPart created was of a wrong type.",XWPFRelation.IMAGE_GIF.getRelationClass().isInstance(gifDocPart));
	}

