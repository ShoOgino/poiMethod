    @Test
    public void testOSGIClassLoadingFixed() throws IOException {
        Thread thread = Thread.currentThread();
        ClassLoader cl = thread.getContextClassLoader();
        InputStream is = POIDataSamples.getSlideShowInstance().openResourceAsStream("table_test.pptx");
        try {
            thread.setContextClassLoader(cl.getParent());
            POIXMLTypeLoader.setClassLoader(cl);
            XMLSlideShow ppt = new XMLSlideShow(is);
            ppt.getSlides().get(0).getShapes();
            ppt.close();
        } finally {
            thread.setContextClassLoader(cl);
            POIXMLTypeLoader.setClassLoader(null);
            is.close();
        }
    }

