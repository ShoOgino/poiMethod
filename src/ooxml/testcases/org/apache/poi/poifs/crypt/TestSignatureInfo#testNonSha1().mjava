    @Test
    public void testNonSha1() throws Exception {
        String testFile = "hello-world-unsigned.xlsx";
        initKeyPair("Test", "CN=Test");

        SignatureConfig signatureConfig = new SignatureConfig();
        signatureConfig.setKey(keyPair.getPrivate());
        signatureConfig.setSigningCertificateChain(Collections.singletonList(x509));

        HashAlgorithm testAlgo[] = { HashAlgorithm.sha224, HashAlgorithm.sha256
            , HashAlgorithm.sha384, HashAlgorithm.sha512, HashAlgorithm.ripemd160 }; 
        
        for (HashAlgorithm ha : testAlgo) {
            signatureConfig.setDigestAlgo(ha);
            OPCPackage pkg = OPCPackage.open(copy(testdata.getFile(testFile)), PackageAccess.READ_WRITE);
            signatureConfig.setOpcPackage(pkg);
            
            SignatureInfo si = new SignatureInfo();
            si.setSignatureConfig(signatureConfig);
    
            si.confirmSignature();
            boolean b = si.verifySignature();
            pkg.close();
    
            assertTrue(b);
        }
    }

