    @Test
    public void embedHSSF() throws IOException {
        try {
            Class.forName("org.apache.poi.hslf.usermodel.HSLFSlideShow");
        } catch (Exception e) {
            assumeTrue(false);
        }

        Workbook wb1 = new HSSFWorkbook();
        Sheet sh = wb1.createSheet();
        int picIdx = wb1.addPicture(getSamplePng(), Workbook.PICTURE_TYPE_PNG);
        byte samplePPT[] = getSamplePPT(false);
        int oleIdx = wb1.addOlePackage(samplePPT, "dummy.ppt", "dummy.ppt", "dummy.ppt");

        Drawing<?> pat = sh.createDrawingPatriarch();
        ClientAnchor anchor = pat.createAnchor(0, 0, 0, 0, 1, 1, 3, 6);
        pat.createObjectData(anchor, oleIdx, picIdx);

        Workbook wb2 = HSSFTestDataSamples.writeOutAndReadBack((HSSFWorkbook)wb1);

        pat = wb2.getSheetAt(0).getDrawingPatriarch();
        assertTrue(pat.iterator().next() instanceof ObjectData);

        EmbeddedExtractor ee = new EmbeddedExtractor();
        EmbeddedData ed = ee.extractAll(wb2.getSheetAt(0)).get(0);
        assertArrayEquals(samplePPT, ed.getEmbeddedData());

        wb2.close();
        wb1.close();
    }

