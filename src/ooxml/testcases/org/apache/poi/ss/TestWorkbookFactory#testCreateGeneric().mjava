	/**
	 * Creates the appropriate kind of Workbook, but
	 *  checking the mime magic at the start of the
	 *  InputStream, then creating what's required.
	 */
	public void testCreateGeneric() throws Exception {
		Workbook wb;

		// InputStream -> either
		wb = WorkbookFactory.create(
				HSSFTestDataSamples.openSampleFileStream(xls)
		);
		assertNotNull(wb);
		assertTrue(wb instanceof HSSFWorkbook);

		wb = WorkbookFactory.create(
				HSSFTestDataSamples.openSampleFileStream(xlsx)
		);
		assertNotNull(wb);
		assertTrue(wb instanceof XSSFWorkbook);
		
		// File -> either
      wb = WorkbookFactory.create(
            HSSFTestDataSamples.getSampleFile(xls)
      );
      assertNotNull(wb);
      assertTrue(wb instanceof HSSFWorkbook);

      wb = WorkbookFactory.create(
            HSSFTestDataSamples.getSampleFile(xlsx)
      );
      assertNotNull(wb);
      assertTrue(wb instanceof XSSFWorkbook);

		// Invalid type -> exception
		try {
			wb = WorkbookFactory.create(
					HSSFTestDataSamples.openSampleFileStream(txt)
			);
			fail();
		} catch(IllegalArgumentException e) {
			// Good
		}
	}

