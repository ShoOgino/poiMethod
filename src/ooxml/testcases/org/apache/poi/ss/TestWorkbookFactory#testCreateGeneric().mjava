    /**
     * Creates the appropriate kind of Workbook, but
     *  checking the mime magic at the start of the
     *  InputStream, then creating what's required.
     */
    public void testCreateGeneric() throws Exception {
        Workbook wb;

        // InputStream -> either
        wb = WorkbookFactory.create(
                HSSFTestDataSamples.openSampleFileStream(xls)
        );
        assertNotNull(wb);
        assertTrue(wb instanceof HSSFWorkbook);
        wb.close();

        wb = WorkbookFactory.create(
                HSSFTestDataSamples.openSampleFileStream(xlsx)
        );
        assertNotNull(wb);
        assertTrue(wb instanceof XSSFWorkbook);
        // TODO: this re-writes the sample-file?! wb.close();
        revert(wb);

        // File -> either
        wb = WorkbookFactory.create(
                HSSFTestDataSamples.getSampleFile(xls)
        );
        assertNotNull(wb);
        assertTrue(wb instanceof HSSFWorkbook);
        wb.close();

        wb = WorkbookFactory.create(
                HSSFTestDataSamples.getSampleFile(xlsx)
        );
        assertNotNull(wb);
        assertTrue(wb instanceof XSSFWorkbook);
        // TODO: close() re-writes the sample-file?! Resort to revert() for now to close file handle...
        revert(wb);

        // Invalid type -> exception
        try {
            InputStream stream = HSSFTestDataSamples.openSampleFileStream(txt);
            try {
                wb = WorkbookFactory.create(stream);
            } finally {
                stream.close();
            }
            fail();
        } catch(InvalidFormatException e) {
            // Good
        }
    }

