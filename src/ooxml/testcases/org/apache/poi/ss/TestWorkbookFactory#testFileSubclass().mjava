    /**
     * See Bugzilla bug #62831 - #WorkbookFactory.create(File) needs
     *  to work for sub-classes of File too, eg JFileChooser
     */
    @Test(expected = ClassCastException.class)
    public void testFileSubclass() throws Exception {
        File normalXLS = HSSFTestDataSamples.getSampleFile(xls);
        File normalXLSX = HSSFTestDataSamples.getSampleFile(xlsx);
        File altXLS = new TestFile(normalXLS.getAbsolutePath());
        File altXLSX = new TestFile(normalXLSX.getAbsolutePath());
        assertTrue(altXLS.exists());
        assertTrue(altXLSX.exists());

        Workbook wb = WorkbookFactory.create(altXLS);
        assertNotNull(wb);
        assertTrue(wb instanceof HSSFWorkbook);
        closeOrRevert(wb);

        wb = WorkbookFactory.create(altXLSX);
        assertNotNull(wb);
        assertTrue(wb instanceof XSSFWorkbook);
        closeOrRevert(wb);

        // check what happens if the file is passed as "Object"

        //noinspection deprecation
        WorkbookFactory.create((Object)altXLSX);
        // expected a ClassCastException here because create() in this case expects an object of type "OPCPackage"
    }

