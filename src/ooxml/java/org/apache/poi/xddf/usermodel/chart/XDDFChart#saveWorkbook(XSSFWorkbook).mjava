    /**
     * this method write the XSSFWorkbook object data into embedded excel file
     *
     * @param workbook XSSFworkbook object
     * @throws IOException
     * @throws InvalidFormatException
     * @since POI 4.0.0
     */
    public void saveWorkbook(XSSFWorkbook workbook) throws IOException, InvalidFormatException {
        PackagePart worksheetPart = getWorksheetPart(true);
        if (worksheetPart == null) {
            POIXMLRelation chartRelation = null;
            POIXMLRelation chartWorkbookRelation = null;
            POIXMLFactory chartFactory = null;
            if (this instanceof XSLFChart) {
                chartRelation = XSLFRelation.CHART;
                chartWorkbookRelation = XSLFRelation.WORKBOOK_RELATIONSHIP;
                chartFactory = XSLFFactory.getInstance();
            } else {
                chartRelation = XWPFRelation.CHART;
                chartRelation = XWPFRelation.WORKBOOK_RELATIONSHIP;
                chartFactory = XWPFFactory.getInstance();
            }
            worksheetPart = createWorksheetPart(chartRelation, chartWorkbookRelation, chartFactory);
        }
        try (OutputStream xlsOut = worksheetPart.getOutputStream()) {
            workbook.write(xlsOut);
        }
    }

