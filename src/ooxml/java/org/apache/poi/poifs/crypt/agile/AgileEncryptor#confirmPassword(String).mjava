    public void confirmPassword(String password) {
        // see [MS-OFFCRYPTO] - 2.3.3 EncryptionVerifier
        Random r = new SecureRandom();
        int blockSize = builder.getHeader().getBlockSize();
        int keySize = builder.getHeader().getKeySize()/8;
        int hashSize = builder.getHeader().getHashAlgorithmEx().hashSize;
        
        byte[] verifierSalt = new byte[blockSize]
             , verifier = new byte[blockSize]
             , keySalt = new byte[blockSize]
             , keySpec = new byte[keySize]
             , integritySalt = new byte[hashSize];
        r.nextBytes(verifierSalt); // blocksize
        r.nextBytes(verifier); // blocksize
        r.nextBytes(keySalt); // blocksize
        r.nextBytes(keySpec); // keysize
        r.nextBytes(integritySalt); // hashsize
        
        confirmPassword(password, keySpec, keySalt, verifierSalt, verifier, integritySalt);
    }

