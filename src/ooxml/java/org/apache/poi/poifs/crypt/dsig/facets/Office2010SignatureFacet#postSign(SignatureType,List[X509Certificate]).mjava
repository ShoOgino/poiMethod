    public void postSign(SignatureType signatureElement, List<X509Certificate> signingCertificateChain) {
        QualifyingPropertiesType qualProps = null;
        
        // check for XAdES-BES
        String qualPropXQuery =
                "declare namespace xades='http://uri.etsi.org/01903/v1.3.2#'; "
              + "declare namespace ds='http://www.w3.org/2000/09/xmldsig#'; "
              + "$this/ds:Object/xades:QualifyingProperties";
        XmlObject xoList[] = signatureElement.selectPath(qualPropXQuery);
        if (xoList.length == 1) {
            qualProps = (QualifyingPropertiesType)xoList[0];
        }
        
        if (qualProps == null) {
            throw new IllegalArgumentException("no XAdES-BES extension present");
        }

        // create basic XML container structure
        UnsignedPropertiesType unsignedProps = qualProps.getUnsignedProperties();
        if (unsignedProps == null) {
            unsignedProps = qualProps.addNewUnsignedProperties();
        }
        UnsignedSignaturePropertiesType unsignedSigProps = unsignedProps.getUnsignedSignatureProperties();
        if (unsignedSigProps == null) {
            unsignedSigProps = unsignedProps.addNewUnsignedSignatureProperties();
        }
    }

