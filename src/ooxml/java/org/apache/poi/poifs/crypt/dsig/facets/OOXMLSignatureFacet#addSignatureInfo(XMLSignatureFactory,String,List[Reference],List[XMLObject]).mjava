    private void addSignatureInfo(XMLSignatureFactory signatureFactory,
            String signatureId, List<Reference> references,
            List<XMLObject> objects) throws NoSuchAlgorithmException,
            InvalidAlgorithmParameterException {
        List<XMLStructure> objectContent = new LinkedList<XMLStructure>();

        SignatureInfoV1Document sigV1 = SignatureInfoV1Document.Factory.newInstance();
        CTSignatureInfoV1 ctSigV1 = sigV1.addNewSignatureInfoV1();
        ctSigV1.setManifestHashAlgorithm("http://www.w3.org/2000/09/xmldsig#sha1");
        Node n = ctSigV1.getDomNode();
        ((Element)n).setAttributeNS(Constants.NamespaceSpecNS, "xmlns", "http://schemas.microsoft.com/office/2006/digsig");
        
        List<XMLStructure> signatureInfoContent = new LinkedList<XMLStructure>();
        signatureInfoContent.add(new DOMStructure(n));
        SignatureProperty signatureInfoSignatureProperty = signatureFactory
                .newSignatureProperty(signatureInfoContent, "#" + signatureId,
                        "idOfficeV1Details");

        List<SignatureProperty> signaturePropertyContent = new LinkedList<SignatureProperty>();
        signaturePropertyContent.add(signatureInfoSignatureProperty);
        SignatureProperties signatureProperties = signatureFactory
                .newSignatureProperties(signaturePropertyContent, null);
        objectContent.add(signatureProperties);

        String objectId = "idOfficeObject";
        objects.add(signatureFactory.newXMLObject(objectContent, objectId,
                null, null));

        DigestMethod digestMethod = signatureFactory.newDigestMethod(this.hashAlgo.xmlSignUri, null);
        Reference reference = signatureFactory.newReference("#" + objectId,
                digestMethod, null, "http://www.w3.org/2000/09/xmldsig#Object",
                null);
        references.add(reference);
    }

