    public void initialize(EncryptionInfo info, DocumentInputStream dis) throws IOException {
        this.info = info;
        
        EncryptionDocument ed = parseDescriptor(dis);
        header = new AgileEncryptionHeader(ed);
        verifier = new AgileEncryptionVerifier(ed);
        if (info.getVersionMajor() == EncryptionMode.agile.versionMajor
            && info.getVersionMinor() == EncryptionMode.agile.versionMinor) {
            decryptor = new AgileDecryptor(this);
        }
    }

