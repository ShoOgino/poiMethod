    /**
     * Gives back the output stream to which to write the signed XML document.
     * 
     * @return
     */
    // protected abstract OutputStream getSignedDocumentOutputStream();
    @Override
    public DigestInfo preSign(Document document, List<DigestInfo> digestInfos)
    throws NoSuchAlgorithmException {
        SignatureInfo.initXmlProvider();

        LOG.log(POILogger.DEBUG, "preSign");
        HashAlgorithm hashAlgo = this.signatureConfig.getDigestAlgo();

        byte[] digestValue;
        try {
            digestValue = getXmlSignatureDigestValue(document, digestInfos);
        } catch (Exception e) {
            throw new RuntimeException("XML signature error: " + e.getMessage(), e);
        }

        String description = getSignatureDescription();
        return new DigestInfo(digestValue, hashAlgo, description);
    }

