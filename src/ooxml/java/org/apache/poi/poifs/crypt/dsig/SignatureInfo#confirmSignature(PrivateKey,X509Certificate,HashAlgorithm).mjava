    public void confirmSignature(PrivateKey key, X509Certificate x509, HashAlgorithm hashAlgo)
    throws NoSuchAlgorithmException, IOException, MarshalException, ParserConfigurationException, XmlException {
        SignatureInfoConfig signatureConfig = new SignatureInfoConfig();
        signatureConfig.setOpcPackage(pkg);
        signatureConfig.setDigestAlgo(hashAlgo);
        signatureConfig.setSigningCertificateChain(Collections.singletonList(x509));
        signatureConfig.setKey(key);
        signatureConfig.addDefaultFacets();
        XmlSignatureService signatureService = new XmlSignatureService(signatureConfig);

        Document document = DocumentHelper.createDocument();
        
        // operate
        DigestInfo digestInfo = signatureService.preSign(document, null);

        // setup: key material, signature value
        byte[] signatureValue = signDigest(key, hashAlgo, digestInfo.digestValue);
        
        // operate: postSign
        signatureService.postSign(document, signatureValue);
    }

