    private String getSignatureMethod(HashAlgorithm hashAlgo) {
        if (null == hashAlgo) {
            throw new RuntimeException("digest algo is null");
        }

        XMLSignatureIf XmlSignature;
        try {
            XmlSignature = HorribleProxy.newProxy(XMLSignatureIf.class);
        } catch (Exception e) {
            throw new RuntimeException("JDK doesn't support XmlSignature", e);
        }
            
        switch (hashAlgo) {
        case sha1:   return XmlSignature.ALGO_ID_SIGNATURE_RSA_SHA1();
        case sha256: return XmlSignature.ALGO_ID_SIGNATURE_RSA_SHA256();
        case sha384: return XmlSignature.ALGO_ID_SIGNATURE_RSA_SHA384();
        case sha512: return XmlSignature.ALGO_ID_SIGNATURE_RSA_SHA512();
        case ripemd160: return XmlSignature.ALGO_ID_MAC_HMAC_RIPEMD160();
        default: break;
        }

        throw new RuntimeException("unsupported sign algo: " + hashAlgo);
    }

