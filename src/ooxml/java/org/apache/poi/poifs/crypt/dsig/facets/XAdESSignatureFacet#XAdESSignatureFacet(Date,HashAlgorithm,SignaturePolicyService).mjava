    /**
     * Main constructor.
     * 
     * @param clock
     *            the clock to be used for determining the xades:SigningTime,
     *            defaults to now when null
     * @param hashAlgo
     *            the digest algorithm to be used for all required XAdES digest
     *            operations. Possible values: "SHA-1", "SHA-256", or "SHA-512",
     *            defaults to SHA-1 when null
     * @param signaturePolicyService
     *            the optional signature policy service used for XAdES-EPES.
     */
    public XAdESSignatureFacet(Date clock, HashAlgorithm hashAlgo,
            SignaturePolicyService signaturePolicyService) {
        this.clock = (clock == null ? new Date() : clock);
        this.hashAlgo = (hashAlgo == null ? HashAlgorithm.sha1 : hashAlgo);
        this.signaturePolicyService = signaturePolicyService;
        this.dataObjectFormatMimeTypes = new HashMap<String, String>();
    }

