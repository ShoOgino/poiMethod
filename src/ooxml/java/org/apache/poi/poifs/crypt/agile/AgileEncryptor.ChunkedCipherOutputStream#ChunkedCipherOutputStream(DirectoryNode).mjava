        public ChunkedCipherOutputStream(DirectoryNode dir) throws IOException {
            super(null);
            fileOut = TempFile.createTempFile("encrypted_package", "crypt");
            this.out = new FileOutputStream(fileOut);
            this.dir = dir;
            EncryptionHeader header = builder.getHeader();
            _cipher = getCipher(getSecretKey(), header.getCipherAlgorithm(), header.getChainingMode(), null, Cipher.ENCRYPT_MODE);
        }

