    /**
     * Main constructor.
     * 
     * @param timeStampService
     *            the time-stamp service used for XAdES-T and XAdES-X.
     * @param revocationDataService
     *            the optional revocation data service used for XAdES-C and
     *            XAdES-X-L. When <code>null</code> the signature will be
     *            limited to XAdES-T only.
     * @param digestAlgorithm
     *            the digest algorithm to be used for construction of the
     *            XAdES-X-L elements.
     */
    public XAdESXLSignatureFacet(TimeStampService timeStampService,
            RevocationDataService revocationDataService,
            HashAlgorithm digestAlgorithm) {
        this.c14nAlgoId = CanonicalizationMethod.EXCLUSIVE;
        this.hashAlgo = digestAlgorithm;
        this.timeStampService = timeStampService;
        this.revocationDataService = revocationDataService;

        try {
            this.certificateFactory = CertificateFactory.getInstance("X.509");
        } catch (CertificateException e) {
            throw new RuntimeException("X509 JCA error: " + e.getMessage(), e);
        }
    }

