    public void confirmSignature(Key key, X509Certificate x509, HashAlgorithm hashAlgo)
    throws NoSuchAlgorithmException, IOException {
        XmlSignatureService signatureService = createSignatureService(hashAlgo, pkg);
        
        // operate
        List<X509Certificate> x509Chain = Collections.singletonList(x509);
        DigestInfo digestInfo = signatureService.preSign(null, x509Chain, null, null, null);

        // setup: key material, signature value
        byte[] signatureValue = signDigest(key, hashAlgo, digestInfo.digestValue);
        
        // operate: postSign
        signatureService.postSign(signatureValue, Collections.singletonList(x509));
    }

