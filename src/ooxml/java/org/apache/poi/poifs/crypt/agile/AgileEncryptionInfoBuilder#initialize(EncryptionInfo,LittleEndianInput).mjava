    @Override
    public void initialize(EncryptionInfo ei, LittleEndianInput dis) throws IOException {
        this.info = ei;
        
        EncryptionDocument ed = parseDescriptor((InputStream)dis);
        header = new AgileEncryptionHeader(ed);
        verifier = new AgileEncryptionVerifier(ed);
        if (ei.getVersionMajor() == EncryptionMode.agile.versionMajor
            && ei.getVersionMinor() == EncryptionMode.agile.versionMinor) {
            decryptor = new AgileDecryptor(this);
            encryptor = new AgileEncryptor(this);
        }
    }

