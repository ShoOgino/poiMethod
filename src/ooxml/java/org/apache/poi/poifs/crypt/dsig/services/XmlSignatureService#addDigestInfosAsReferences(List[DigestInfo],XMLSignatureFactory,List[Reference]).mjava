    private void addDigestInfosAsReferences(List<DigestInfo> digestInfos, XMLSignatureFactory signatureFactory, List<Reference> references)
    throws NoSuchAlgorithmException, InvalidAlgorithmParameterException, MalformedURLException {
        for (DigestInfo digestInfo : safe(digestInfos)) {
            byte[] documentDigestValue = digestInfo.digestValue;

            DigestMethod digestMethod = signatureFactory.newDigestMethod(
                            digestInfo.hashAlgo.xmlSignUri, null);

            String uri = new File(digestInfo.description).getName();

            Reference reference = signatureFactory.newReference(uri,
                            digestMethod, null, null, null, documentDigestValue);
            references.add(reference);
        }
    }

