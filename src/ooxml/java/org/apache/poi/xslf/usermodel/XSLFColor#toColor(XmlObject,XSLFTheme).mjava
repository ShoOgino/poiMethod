    private Color toColor(XmlObject obj, XSLFTheme theme) {
        Color color = null;
        List<XmlObject> xo = new ArrayList<>();
        xo.add(obj);
        xo.addAll(Arrays.asList(obj.selectPath("*")));
        boolean isFirst = true;
        for (XmlObject ch : xo) {
            if (ch instanceof CTHslColor) {
                color = toColor((CTHslColor)ch);
            } else if (ch instanceof CTPresetColor) {
                color = toColor((CTPresetColor)ch);
            } else if (ch instanceof CTSchemeColor) {
                color = toColor((CTSchemeColor)ch, theme);
            } else if (ch instanceof CTScRgbColor) {
                color = toColor((CTScRgbColor)ch);
            } else if (ch instanceof CTSRgbColor) {
                color = toColor((CTSRgbColor)ch);
            } else if (ch instanceof CTSystemColor) {
                color = toColor((CTSystemColor)ch);
            } else if (!(ch instanceof CTFontReference)) {
                if (!isFirst) {
                    throw new IllegalArgumentException("Unexpected color choice: " + ch.getClass());
                }
            }
            if (color != null) {
                break;
            }
            isFirst = false;
        }
        return color;
    }

