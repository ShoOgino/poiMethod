    /**
     * fetch shape fill as a java.awt.Paint
     *
     * @return either Color or GradientPaint or TexturePaint or null
     */
    @Override
    public FillStyle getFillStyle() {
        return new FillStyle() {
            public PaintStyle getPaint() {
                PropertyFetcher<PaintStyle> fetcher = new PropertyFetcher<PaintStyle>() {
                    public boolean fetch(XSLFShape shape) {
                        CTShapeProperties spPr = shape.getSpPr();
                        if (spPr.isSetNoFill()) {
                            setValue(TRANSPARENT_PAINT);
                            return true;
                        }
                        
                        PaintStyle paint = null;
                        for (XmlObject obj : spPr.selectPath("*")) {
                            paint = selectPaint(obj, null, getSheet().getPackagePart());
                            if (paint != null) break;
                        }
                        
                        if (paint == null) return false;
                        
                        setValue(paint);
                        return true;
                    }
                };
                fetchShapeProperty(fetcher);

                PaintStyle paint = fetcher.getValue();

                if (paint != null) return paint;
                
                // fill color was not found, check if it is defined in the theme
                CTShapeStyle style = getSpStyle();
                if (style != null) {
                    // get a reference to a fill style within the style matrix.
                    CTStyleMatrixReference fillRef = style.getFillRef();
                    // The idx attribute refers to the index of a fill style or
                    // background fill style within the presentation's style matrix, defined by the fmtScheme element.
                    // value of 0 or 1000 indicates no background,
                    // values 1-999 refer to the index of a fill style within the fillStyleLst element
                    // values 1001 and above refer to the index of a background fill style within the bgFillStyleLst element.
                    int idx = (int)fillRef.getIdx();
                    CTSchemeColor phClr = fillRef.getSchemeClr();
                    XSLFSheet sheet = _sheet;
                    XSLFTheme theme = sheet.getTheme();
                    XmlObject fillProps = null;
                    CTStyleMatrix matrix = theme.getXmlObject().getThemeElements().getFmtScheme();
                    if(idx >= 1 && idx <= 999){
                        fillProps = matrix.getFillStyleLst().selectPath("*")[idx - 1];
                    } else if (idx >= 1001 ){
                        fillProps = matrix.getBgFillStyleLst().selectPath("*")[idx - 1001];
                    }
                    if(fillProps != null) {
                        paint = selectPaint(fillProps, phClr, sheet.getPackagePart());
                    }
                }
                return paint == RenderableShape.NO_PAINT ? null : paint;
            }
        };
    }

