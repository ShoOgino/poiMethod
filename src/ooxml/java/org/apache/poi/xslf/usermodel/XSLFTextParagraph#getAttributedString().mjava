    public AttributedString getAttributedString(){
        String text = getText();

        AttributedString string = new AttributedString(text);

        int startIndex = 0;
        for (XSLFTextRun run : _runs){
            int length = run.getText().length();
            if(length == 0) {
                // skip empty runs
                continue;
            }
            int endIndex = startIndex + length;

            string.addAttribute(TextAttribute.FOREGROUND, run.getFontColor(), startIndex, endIndex);
            string.addAttribute(TextAttribute.FAMILY, run.getFontFamily(), startIndex, endIndex);
            string.addAttribute(TextAttribute.SIZE, run.getFontSize(), startIndex, endIndex);
            if(run.isBold()) {
                string.addAttribute(TextAttribute.WEIGHT, TextAttribute.WEIGHT_BOLD, startIndex, endIndex);
            }
            if(run.isItalic()) {
                string.addAttribute(TextAttribute.POSTURE, TextAttribute.POSTURE_OBLIQUE, startIndex, endIndex);
            }
            if(run.isUnderline()) {
                string.addAttribute(TextAttribute.UNDERLINE, TextAttribute.UNDERLINE_ON, startIndex, endIndex);
            }
            if(run.isStrikethrough()) {
                string.addAttribute(TextAttribute.STRIKETHROUGH, TextAttribute.STRIKETHROUGH_ON, startIndex, endIndex);
            }

            startIndex = endIndex;
        }

        return string;
    }

