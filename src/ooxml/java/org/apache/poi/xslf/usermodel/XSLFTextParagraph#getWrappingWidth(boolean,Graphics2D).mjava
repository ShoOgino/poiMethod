    /**
     * Returns wrapping width to break lines in this paragraph
     *
     * @param firstLine whether the first line is breaking
     *
     * @return  wrapping width in points
     */
    double getWrappingWidth(boolean firstLine, Graphics2D graphics){
        // internal margins for the text box
        double leftInset = _shape.getLeftInset();
        double rightInset = _shape.getRightInset();

        RenderableShape rShape = new RenderableShape(_shape);
        Rectangle2D anchor = rShape.getAnchor(graphics);

        double leftMargin = getLeftMargin();
        double indent = getIndent();

        double width;
        if(!_shape.getWordWrap()) {
            // if wordWrap == false then we return the advance to the right border of the sheet
            width = _shape.getSheet().getSlideShow().getPageSize().getWidth() - anchor.getX();
        } else {
            width = anchor.getWidth() -  leftInset - rightInset - leftMargin;
            if(firstLine) {
                if(isBullet()){
                    if(indent > 0) width -= indent;
                } else {
                    if(indent > 0) width -= indent; // first line indentation
                    else if (indent < 0) { // hanging indentation: the first line start at the left margin
                        width += leftMargin;
                    }
                }
            }
        }

        return width;
    }

