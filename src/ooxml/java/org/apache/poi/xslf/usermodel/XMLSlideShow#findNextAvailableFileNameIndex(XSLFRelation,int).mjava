    private int findNextAvailableFileNameIndex(XSLFRelation relationType, int idx) {
        // Bug 55791: We also need to check that the resulting file name is not already taken
        // this can happen when removing/adding slides, notes or charts
        while(true) {
            String fileName = relationType.getFileName(idx);
            boolean found = false;
            for (POIXMLDocumentPart relation : getRelations()) {
                if (relation.getPackagePart() != null &&
                        fileName.equals(relation.getPackagePart().getPartName().getName())) {
                    // name is taken => try next one
                    found = true;
                    break;
                }
            }

            if(!found &&
                    getPackage().getPartsByName(Pattern.compile(Pattern.quote(fileName))).size() > 0) {
                // name is taken => try next one
                found = true;
            }

            if (!found) {
                break;
            }
            idx++;
        }
        return idx;
    }

