	public POIXMLProperties(Package docPackage) throws IOException, OpenXML4JException, XmlException {
		this.pkg = docPackage;
		
		// Core properties
		PackageRelationshipCollection coreRel =
			pkg.getRelationshipsByType(POIXMLDocument.CORE_PROPERTIES_REL_TYPE);
		if(coreRel.size() == 1) {
			core = new CoreProperties( (PackagePropertiesPart)
					pkg.getPart(coreRel.getRelationship(0)) );
		} else {
			throw new IllegalArgumentException("A document must always have core properties defined!");
		}
		
		// Extended properties
		PackageRelationshipCollection extRel =
			pkg.getRelationshipsByType(POIXMLDocument.EXTENDED_PROPERTIES_REL_TYPE);
		if(extRel.size() == 1) {
			PropertiesDocument props = PropertiesDocument.Factory.parse(
					pkg.getPart( extRel.getRelationship(0) ).getInputStream()
			);
			ext = new ExtendedProperties(props);
		} else {
			ext = new ExtendedProperties(PropertiesDocument.Factory.newInstance());
		}
	}

