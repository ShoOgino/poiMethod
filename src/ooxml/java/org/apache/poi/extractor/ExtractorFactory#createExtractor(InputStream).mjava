	public static POITextExtractor createExtractor(InputStream inp) throws IOException, InvalidFormatException, OpenXML4JException, XmlException {
		// Figure out the kind of stream
		// If clearly doesn't do mark/reset, wrap up
		if(! inp.markSupported()) {
			inp = new PushbackInputStream(inp, 8);
		}
		
		if(POIFSFileSystem.hasPOIFSHeader(inp)) {
			return createExtractor(new POIFSFileSystem(inp));
		}

		if(POIXMLDocument.hasOOXMLHeader(inp)) {
            File file = TempFile.createTempFile("poi-ooxml-", ".tmp");

            try {
                FileOutputStream out = new FileOutputStream(file);
                IOUtils.copy(inp, out);
                out.close();

                return createExtractor(OPCPackage.open(file.getPath()));
            } finally {
                if (file.exists()) {
                    file.delete();
                }
            }
        }
		throw new IllegalArgumentException("Your InputStream was neither an OLE2 stream, nor an OOXML stream");
	}

