	public static POITextExtractor createExtractor(File f) throws IOException, InvalidFormatException, OpenXML4JException, XmlException {
		InputStream inp = null;
        try {
            inp = new PushbackInputStream(
                new FileInputStream(f), 8);

            if(POIFSFileSystem.hasPOIFSHeader(inp)) {
                return createExtractor(new POIFSFileSystem(inp));
            }
            if(POIXMLDocument.hasOOXMLHeader(inp)) {
                return createExtractor(OPCPackage.open(f.toString(), PackageAccess.READ));
            }
            throw new IllegalArgumentException("Your File was neither an OLE2 file, nor an OOXML file");
        } finally {
            if(inp != null) inp.close();
        }
    }

