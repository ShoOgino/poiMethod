    private static List<PackagePart> getSignatureParts(URL url) throws IOException, InvalidFormatException {
        List<PackagePart> packageParts = new LinkedList<PackagePart>();
        OPCPackage pkg = POIXMLDocument.openPackage(url.getPath());
        PackageRelationshipCollection sigOrigRels = pkg.getRelationshipsByType(PackageRelationshipTypes.DIGITAL_SIGNATURE_ORIGIN);
        for (PackageRelationship rel : sigOrigRels) {
            PackagePartName relName = PackagingURIHelper.createPartName(rel.getTargetURI());
            PackagePart sigPart = pkg.getPart(relName);
            if (LOG.isDebugEnabled()) {
                LOG.debug("Digital Signature Origin part = " + sigPart);
            }

            PackageRelationshipCollection sigRels = sigPart.getRelationshipsByType(PackageRelationshipTypes.DIGITAL_SIGNATURE);
            for (PackageRelationship sigRel : sigRels) {
                PackagePartName sigRelName = PackagingURIHelper.createPartName(sigRel.getTargetURI());
                PackagePart sigRelPart = pkg.getPart(sigRelName);
                if (LOG.isDebugEnabled()) {
                    LOG.debug("XML Signature part = " + sigRelPart);
                }
                packageParts.add(sigRelPart);
            }
        }
        return packageParts;
    }

