    public static boolean verifySignature(URL url) throws InvalidFormatException, IOException, ParserConfigurationException, SAXException, MarshalException,
                                    XMLSignatureException {
        PackagePart signaturePart = getSignaturePart(url);
        if (signaturePart == null) {
            LOG.info(url + " does not contain a signature");
            return false;
        }
        LOG.debug("signature resource name: " + signaturePart.getPartName());

        OOXMLProvider.install();

        Document signatureDocument = loadDocument(signaturePart);
        LOG.debug("signature loaded");
        NodeList signatureNodeList = signatureDocument.getElementsByTagNameNS(XMLSignature.XMLNS, "Signature");
        Node signatureNode = signatureNodeList.item(0);
        KeyInfoKeySelector keySelector = new KeyInfoKeySelector();
        DOMValidateContext domValidateContext = new DOMValidateContext(keySelector, signatureNode);
        domValidateContext.setProperty("org.jcp.xml.dsig.validateManifests", Boolean.TRUE);

        OOXMLURIDereferencer dereferencer = new OOXMLURIDereferencer(url);
        domValidateContext.setURIDereferencer(dereferencer);

        XMLSignatureFactory xmlSignatureFactory = CryptoFactoryFactory.getSignatureFactory();
        XMLSignature xmlSignature = xmlSignatureFactory.unmarshalXMLSignature(domValidateContext);
        return xmlSignature.validate(domValidateContext);
    }

