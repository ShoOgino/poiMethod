    public XWPFParagraph(CTP prgrph, XWPFDocument docRef)
    {
        super(prgrph);
        
        this.docRef = docRef; 
        CTR[] rs = paragraph.getRArray();
    
        // Get text of the paragraph
        for (int j = 0; j < rs.length; j++) {
            // Grab the text and tabs of the paragraph
        	// Do so in a way that preserves the ordering
        	XmlCursor c = rs[j].newCursor();
        	c.selectPath( "./*" );
        	while(c.toNextSelection()) {
        		XmlObject o = c.getObject();
        		if(o instanceof CTText) {
        			text.append( ((CTText)o).getStringValue() );
        		}
        		if(o instanceof CTPTab) {
        			text.append("\t");
        		}
        	}
        	
            // Loop over pictures inside our
            //  paragraph, looking for text in them
            CTPicture[] picts = rs[j].getPictArray();
            for (int k = 0; k < picts.length; k++) {
                XmlObject[] t = picts[k].selectPath("declare namespace w='http://schemas.openxmlformats.org/wordprocessingml/2006/main' .//w:t");
                for (int m = 0; m < t.length; m++) {
                    NodeList kids = t[m].getDomNode().getChildNodes();
                    for (int n = 0; n < kids.getLength(); n++) {
                        if (kids.item(n) instanceof Text) {
                            pictureText.append("\n" + kids.item(n).getNodeValue());
                        }
                    }
                }
            }
        }
    }

