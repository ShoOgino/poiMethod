     /**
     * Adds a picture to the document. Users should normally call
     *  {@link XWPFRun#addPicture(InputStream, int)}
     *   
     *
     * @param is                The stream to read image from
     * @param format            The format of the picture, eg {@link Document#PICTURE_TYPE_JPEG}

     *
     * @return the index to this picture (0 based), the added picture can be obtained from {@link #getAllPictures()} .
     * @throws InvalidFormatException 
     */
    public int addPicture(InputStream is, int format) throws IOException, InvalidFormatException {
        int imageNumber = getNextPicNameNumber(format);
        XWPFPictureData img = (XWPFPictureData)createRelationship(XWPFPictureData.RELATIONS[format], XWPFFactory.getInstance(), imageNumber, false);
        OutputStream out = img.getPackagePart().getOutputStream();
        IOUtils.copy(is, out);
        out.close();
        pictures.add(img);
        return getAllPictures().size()-1;
    }

