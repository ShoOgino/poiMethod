	/**
	 * Read this shared styles table from an XML file.
	 *
	 * @param is The input stream containing the XML document.
	 * @throws IOException if an error occurs while reading.
	 */
	protected void readFrom(InputStream is) throws IOException {
		try {
			doc = StyleSheetDocument.Factory.parse(is);
			// Grab all the different bits we care about
			if(doc.getStyleSheet().getNumFmts() != null)
			for (CTNumFmt nfmt : doc.getStyleSheet().getNumFmts().getNumFmtArray()) {
				numberFormats.put((int)nfmt.getNumFmtId(), nfmt.getFormatCode());
			}
			if(doc.getStyleSheet().getFonts() != null){
				int idx = 0;
				for (CTFont font : doc.getStyleSheet().getFonts().getFontArray()) {
					XSSFFont f = new XSSFFont(font, idx);
					fonts.add(f);
					idx++;
				}
			}
			if(doc.getStyleSheet().getFills() != null)
			for (CTFill fill : doc.getStyleSheet().getFills().getFillArray()) {
				fills.add(new XSSFCellFill(fill));
			}
			if(doc.getStyleSheet().getBorders() != null)
			for (CTBorder border : doc.getStyleSheet().getBorders().getBorderArray()) {
				borders.add(new XSSFCellBorder(border));
			}
            CTCellXfs cellXfs = doc.getStyleSheet().getCellXfs();
            if(cellXfs != null) xfs.addAll(Arrays.asList(cellXfs.getXfArray()));

            CTCellStyleXfs cellStyleXfs = doc.getStyleSheet().getCellStyleXfs();
            if(cellStyleXfs != null) styleXfs.addAll(Arrays.asList(cellStyleXfs.getXfArray()));

            CTDxfs styleDxfs = doc.getStyleSheet().getDxfs();
			if(styleDxfs != null) dxfs.addAll(Arrays.asList(styleDxfs.getDxfArray()));

		} catch (XmlException e) {
			throw new IOException(e.getLocalizedMessage());
		}
	}

