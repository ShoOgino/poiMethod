	public int putNumberFormat(String fmt) {
		if (numberFormats.containsValue(fmt)) {
			// Find the key, and return that
			for (Entry<Integer,String> numFmt : numberFormats.entrySet()) {
				if(numFmt.getValue().equals(fmt)) {
					return numFmt.getKey();
				}
			}
			throw new IllegalStateException("Found the format, but couldn't figure out where - should never happen!");
		}

		// Find a spare key, and add that
		for (int i=FIRST_CUSTOM_STYLE_ID; i<usedNumberFormats.length; i++) {
		    if (!usedNumberFormats[i]) {
                usedNumberFormats[i] = true;
		        numberFormats.put(i, fmt);
		        return i;
		    }
		}
		throw new IllegalStateException("The maximum number of Data Formats was exceeded. " +
              "You can define up to " + usedNumberFormats.length + " formats in a .xlsx Workbook");
	}

