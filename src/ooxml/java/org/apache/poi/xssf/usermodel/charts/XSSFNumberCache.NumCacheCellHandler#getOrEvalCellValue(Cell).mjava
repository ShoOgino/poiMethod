	private double getOrEvalCellValue(Cell cell) {
	    int cellType = cell.getCellType();

	    if (cellType == Cell.CELL_TYPE_NUMERIC) {
		return cell.getNumericCellValue();
	    } else if (cellType == Cell.CELL_TYPE_FORMULA) {
		CellValue value = evaluator.evaluate(cell);
		if (value.getCellType() == Cell.CELL_TYPE_NUMERIC) {
		    return value.getNumberValue();
		}
	    }
	    return Double.NaN;
	}

