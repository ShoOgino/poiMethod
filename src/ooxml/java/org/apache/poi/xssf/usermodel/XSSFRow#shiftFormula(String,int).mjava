    /**
     * Shift a formula by the specified number of rows
     * <p>
     * Example: shiftFormula("A1+B1+C1", 3) will return "A4+B4+C4"
     * </p>
     *
     * @param formula the formula to shift
     * @param n the number of rows to shift
     * @return the shifted formula
     */
    private String shiftFormula(String formula, int n){
        XSSFSheet sheet = getSheet();
        XSSFWorkbook wb = sheet.getWorkbook();
        int sheetIndex = wb.getSheetIndex(sheet);
        XSSFEvaluationWorkbook fpb = XSSFEvaluationWorkbook.create(wb);
        Ptg[] ptgs = FormulaParser.parse(formula, fpb, FormulaType.CELL, sheetIndex);
        Ptg[] fmla = SharedFormulaRecord.convertSharedFormulas(ptgs, n, 0);
        return FormulaRenderer.toFormulaString(fpb, fmla);
    }

