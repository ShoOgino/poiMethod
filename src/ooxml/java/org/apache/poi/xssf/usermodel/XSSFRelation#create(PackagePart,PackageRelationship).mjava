	/**
	 * Does the actual Model creation
	 */
	private W create(PackagePart thisPart, PackageRelationship rel) 
			throws IOException, InvalidFormatException {
		
		if (_constructor == null) {
			throw new IllegalStateException("Model class not set");
		}
		// Instantiate, if we can
		InputStream inp = thisPart.getInputStream();
		if (inp == null) {
			return null; // TODO - is this valid?
		}
		Object[] args;
		if (_constructorTakesTwoArgs) {
			args = new Object[] { inp, rel.getId(), };
		} else {
			args = new Object[] { inp, };
		}
		W result;
        try {
        	try {
				result = _constructor.newInstance(args);
			} catch (IllegalArgumentException e) {
				throw new RuntimeException(e);
			} catch (InstantiationException e) {
				throw new RuntimeException(e);
			} catch (IllegalAccessException e) {
				throw new RuntimeException(e);
			} catch (InvocationTargetException e) {
				Throwable t = e.getTargetException();
				if (t instanceof IOException) {
					throw (IOException)t;
				}
				if (t instanceof RuntimeException) {
					throw (RuntimeException)t;
				}
				throw new RuntimeException(t);
			}
        } finally {
        	inp.close();
        }
        
		// Do children, if required
		if(result instanceof XSSFChildContainingModel) {
			XSSFChildContainingModel ccm = 
				(XSSFChildContainingModel)result;
			for(String relType : ccm.getChildrenRelationshipTypes()) {
				for(PackageRelationship cRel : thisPart.getRelationshipsByType(relType)) {
					PackagePart childPart = XSSFWorkbook.getTargetPart(thisPart.getPackage(), cRel);
					ccm.generateChild(childPart, cRel.getId());
				}
			}
		}
 		
		
        return result;
	}

