    /**
     * Sets formula for this cell.
     * <p>
     * Note, this method only sets the formula string and does not calculate the formula value.
     * To set the precalculated value use {@link #setCellValue(double)} or {@link #setCellValue(String)}
     * </p>
     *
     * @param formula the formula to set, e.g. <code>SUM(C4:E4)</code>.
     *  If the argument is <code>null</code> then the current formula is removed.
     * @throws IllegalArgumentException if the formula is invalid
     */
    public void setCellFormula(String formula) {
        if (formula == null && cell.isSetF()) {
            cell.unsetF();
            return;
        }

        XSSFEvaluationWorkbook fpb = XSSFEvaluationWorkbook.create(row.getSheet().getWorkbook());
        try {
            Ptg[] ptgs = FormulaParser.parse(formula, fpb, FormulaType.CELL);
        } catch (RuntimeException e) {
            if (e.getClass().getName().startsWith(FormulaParser.class.getName())) {
                throw new IllegalArgumentException("Unparsable formula '" + formula + "'", e);
            }
            throw e;
        }

        CTCellFormula f =  CTCellFormula.Factory.newInstance();
        f.setStringValue(formula);
        cell.setF(f);
        if(cell.isSetV()) cell.unsetV();
    }

