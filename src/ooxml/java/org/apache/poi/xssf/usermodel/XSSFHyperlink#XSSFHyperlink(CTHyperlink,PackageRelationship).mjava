	protected XSSFHyperlink(CTHyperlink ctHyperlink, PackageRelationship hyperlinkRel) {
		this.ctHyperlink = ctHyperlink;
		this.externalRel = hyperlinkRel;
		
		// Figure out the Hyperlink type
		
		// If it has a location, it's internal
		if(ctHyperlink.getLocation() != null) {
			type = Hyperlink.LINK_DOCUMENT;
			location = ctHyperlink.getLocation();
		} else {
			// Otherwise it's somehow external, check
			//  the relation to see how
			if(externalRel == null) {
				if(ctHyperlink.getId() != null) {
					throw new IllegalStateException("The hyperlink for cell " + ctHyperlink.getRef() + " references relation " + ctHyperlink.getId() + ", but that didn't exist!");
				} else {
					throw new IllegalStateException("A sheet hyperlink must either have a location, or a relationship. Found:\n" + ctHyperlink);
				}
			}
			// TODO
			
			//URI target = externalRel.getTargetURI();
			//location = target.toString();
		}
	}

