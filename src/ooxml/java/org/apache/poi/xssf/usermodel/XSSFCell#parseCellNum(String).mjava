    /**
     * Converts A1 style reference into 0-based column index
     *
     * @param r an A1 style reference to the location of this cell
     * @return 0-based column index
     */
    protected static short parseCellNum(String r) {
        r = r.split("\\d+")[0];
        if (r.length() == 1) {
            return (short) (r.charAt(0) - 'A');
        } else {
            return (short) (r.charAt(1) - 'A' + 26 * (r.charAt(0) - '@'));
        }
    }

