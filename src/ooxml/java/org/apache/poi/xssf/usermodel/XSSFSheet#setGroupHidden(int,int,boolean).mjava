    /**
     * Sets all adjacent columns of the same outline level to the specified
     * hidden status.
     *
     * @param pIdx
     *                the col info index of the start of the outline group
     * @return the column index of the last column in the outline group
     */
    private int setGroupHidden(int pIdx, int level, boolean hidden) {
    	CTCols cols = worksheet.getColsArray(0);
    	int idx = pIdx;
    	CTCol columnInfo = cols.getColArray(idx);
    	while (idx < cols.sizeOfColArray()) {
    		columnInfo.setHidden(hidden);
    		if (idx + 1 < cols.sizeOfColArray()) {
    			CTCol nextColumnInfo = cols.getColArray(idx + 1);

    			if (!isAdjacentBefore(columnInfo, nextColumnInfo)) {
    				break;
    			}

    			if (nextColumnInfo.getOutlineLevel() < level) {
    				break;
    			}
    			columnInfo = nextColumnInfo;
    		}
    		idx++;
    	}
    	return (int) columnInfo.getMax();
    }

