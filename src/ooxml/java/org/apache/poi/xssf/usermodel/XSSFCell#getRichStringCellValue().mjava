    /**
     * Get the value of the cell as a XSSFRichTextString
     * <p>
     * For numeric cells we throw an exception. For blank cells we return an empty string.
     * For formula cells we return the pre-calculated value.
     * </p>
     * @return the value of the cell as a XSSFRichTextString
     */
    public XSSFRichTextString getRichStringCellValue() {
        int cellType = getCellType();
        XSSFRichTextString rt;
        switch (cellType) {
            case CELL_TYPE_BLANK:
                rt = new XSSFRichTextString("");
                break;
            case CELL_TYPE_STRING:
                if (!cell.isSetV()) rt = new XSSFRichTextString("");
                else {
                    if (cell.getT() == STCellType.INLINE_STR) {
                        return new XSSFRichTextString(cell.getV());
                    } else {
                        int idx = Integer.parseInt(cell.getV());
                        rt = new XSSFRichTextString(sharedStringSource.getEntryAt(idx));
                    }
                }
                break;
            case CELL_TYPE_FORMULA:
                rt = new XSSFRichTextString(cell.isSetV() ? cell.getV() : "");
                break;
            default:
                throw typeMismatch(CELL_TYPE_STRING, cellType, false);
        }
        rt.setStylesTableReference(stylesSource);
        return rt;
    }

