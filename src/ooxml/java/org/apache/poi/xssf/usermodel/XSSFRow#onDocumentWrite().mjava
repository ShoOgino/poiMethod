    /**
     * Fired when the document is written to an output stream.
     *
     * @see org.apache.poi.xssf.usermodel.XSSFSheet#write(java.io.OutputStream) ()
     */
    protected void onDocumentWrite(){
        CTCell[] cArray = new CTCell[_cells.size()];
        int i = 0;
        for (XSSFCell xssfCell : _cells.values()) {
            cArray[i] = (CTCell) xssfCell.getCTCell().copy();
            
            // we have to copy and re-create the XSSFCell here because the 
            // elements as otherwise setCArray below invalidates all the columns!
            // see Bug 56170, XMLBeans seems to always release previous objects
            // in the CArray, so we need to provide completely new ones here!
            //_cells.put(entry.getKey(), new XSSFCell(this, cArray[i]));
            xssfCell.setCTCell(cArray[i]);
            i++;
        }

        _row.setCArray(cArray);
    }

