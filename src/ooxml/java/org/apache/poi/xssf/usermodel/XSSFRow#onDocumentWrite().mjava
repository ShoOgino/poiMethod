    /**
     * Fired when the document is written to an output stream.
     * <p>
     * Attaches CTCell beans to the underlying CTRow bean
     * </p>
     * @see org.apache.poi.xssf.usermodel.XSSFSheet#commit()
     */
    protected void onDocumentWrite(){
        ArrayList<CTCell> cArray = new ArrayList<CTCell>(_cells.size());
        //create array of CTCell objects.
        //TreeMap's value iterator ensures that the cells are ordered by columnIndex in the ascending order
        for (Cell cell : _cells.values()) {
            XSSFCell c = (XSSFCell)cell;
            cArray.add(c.getCTCell());
        }
        _row.setCArray(cArray.toArray(new CTCell[cArray.size()]));
    }

