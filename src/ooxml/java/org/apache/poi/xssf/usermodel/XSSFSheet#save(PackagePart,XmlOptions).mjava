    /**
     * Tweaks the CTWorksheet to fit with what Excel
     *  will accept without a massive huff, and write into
     *  the OutputStream supplied.
     */
    protected void save(PackagePart sheetPart, XmlOptions xmlOptions) throws IOException {
    	// Excel objects to <cols/>
    	if(worksheet.getColsArray().length == 1) {
    		CTCols col = worksheet.getColsArray(0);
    		if(col.getColArray().length == 0) {
    			worksheet.setColsArray(null);
    		}
    	}
    	
    	// Now re-generate our CTHyperlinks, if needed
    	if(hyperlinks.size() > 0) {
	    	if(worksheet.getHyperlinks() == null) {
	    		worksheet.addNewHyperlinks();
	    	}
	    	CTHyperlink[] ctHls = new CTHyperlink[hyperlinks.size()];
	    	for(int i=0; i<ctHls.length; i++) {
	            // If our sheet has hyperlinks, have them add
	            //  any relationships that they might need
	    		XSSFHyperlink hyperlink = hyperlinks.get(i);
	    		hyperlink.generateRelationIfNeeded(sheetPart);
	    		// Now grab their underling object
	    		ctHls[i] = hyperlink.getCTHyperlink();
	    	}
	    	worksheet.getHyperlinks().setHyperlinkArray(ctHls);
    	}

    	// Save
    	OutputStream out = sheetPart.getOutputStream();
        worksheet.save(out, xmlOptions);
        out.close();
    }

