    /**
     * Write out this workbook to an Outputstream.
     *
     * @param stream - the java OutputStream you wish to write to
     * @exception IOException if anything can't be written.
     */
    public void write(OutputStream stream) throws IOException
    {
    	for (SXSSFSheet sheet : _xFromSxHash.values())
    	{
    		sheet.flushRows();
    	}
    	
        //Save the template
        File tmplFile = File.createTempFile("poi-sxssf-template", ".xlsx");
        tmplFile.deleteOnExit();
        FileOutputStream os = new FileOutputStream(tmplFile);
        _wb.write(os);
        os.close();

        //Substitute the template entries with the generated sheet data files
        injectData(tmplFile, stream);
        tmplFile.delete();
    }

