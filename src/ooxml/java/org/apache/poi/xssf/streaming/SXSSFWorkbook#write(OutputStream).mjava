    /**
     * Write out this workbook to an Outputstream.
     *
     * @param stream - the java OutputStream you wish to write to
     * @exception IOException if anything can't be written.
     */
    public void write(OutputStream stream) throws IOException
    {
    	for (SXSSFSheet sheet : _xFromSxHash.values())
    	{
    		sheet.flushRows();
    	}
    	
        //Save the template
        File tmplFile = TempFile.createTempFile("poi-sxssf-template", ".xlsx");
        try
        {
            FileOutputStream os = new FileOutputStream(tmplFile);
            try
            {
                _wb.write(os);
            }
            finally
            {
                os.close();
            }

            //Substitute the template entries with the generated sheet data files
            injectData(tmplFile, stream);
        }
        finally
        {
            tmplFile.delete();
        }
    }

