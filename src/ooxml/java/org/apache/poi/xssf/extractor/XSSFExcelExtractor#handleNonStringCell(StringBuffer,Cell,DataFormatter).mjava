   private void handleNonStringCell(StringBuffer text, Cell cell, DataFormatter formatter) {
      int type = cell.getCellType();
      if (type == Cell.CELL_TYPE_FORMULA) {
         type = cell.getCachedFormulaResultType();
      }

      if (type == Cell.CELL_TYPE_NUMERIC) {
         CellStyle cs = cell.getCellStyle();

         if (cs.getDataFormatString() != null) {
            text.append(formatter.formatRawCellContents(
                  cell.getNumericCellValue(), cs.getDataFormat(), cs.getDataFormatString()
            ));
            return;
         }
      }

      // No supported styling applies to this cell
      XSSFCell xcell = (XSSFCell)cell;
      text.append( xcell.getRawValue() );
   }

