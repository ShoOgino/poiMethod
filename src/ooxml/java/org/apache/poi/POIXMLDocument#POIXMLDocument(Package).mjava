    protected POIXMLDocument(Package pkg) throws IOException {
    	try {
	    	this.pkg = pkg;
	    	
	        PackageRelationship coreDocRelationship = this.pkg.getRelationshipsByType(
	                PackageRelationshipTypes.CORE_DOCUMENT).getRelationship(0);
	    
	        // Get core part
	        this.corePart = this.pkg.getPart(coreDocRelationship);
	        
			// Get any embedded OLE2 documents
	        this.embedds = new LinkedList<PackagePart>();
	        for(PackageRelationship rel : corePart.getRelationshipsByType(OLE_OBJECT_REL_TYPE)) {
	            embedds.add(getTargetPart(rel));
	        }
        } catch (OpenXML4JException e) {
            throw new IOException(e.toString());
    	}
    }

