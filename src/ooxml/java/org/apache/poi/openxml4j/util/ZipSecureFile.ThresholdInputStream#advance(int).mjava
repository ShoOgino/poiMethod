        public void advance(int advance) throws IOException {
            counter += advance;
            // check the file size first, in case we are working on uncompressed streams
            if (counter < MAX_ENTRY_SIZE) {
                if (cis == null) return;
                double ratio = (double)cis.counter/(double)counter;
                if (ratio > MIN_INFLATE_RATIO) return;
            }
            throw new IOException("Zip bomb detected! Exiting.");
        }

