    @Test
    public void autoSizeDate() throws IOException {
       HSSFWorkbook wb = new HSSFWorkbook();
       HSSFSheet s = wb.createSheet("Sheet1");
       HSSFRow r = s.createRow(0);
       r.createCell(0).setCellValue(1);
       r.createCell(1).setCellValue(123456);
       
       // Will be sized fairly small
       s.autoSizeColumn((short)0);
       s.autoSizeColumn((short)1);
       
       // Size ranges due to different fonts on different machines
       assertBetween("Single number column width", s.getColumnWidth(0), 350, 550); 
       assertBetween("6 digit number column width", s.getColumnWidth(1), 1500, 2000);
       
       // Set a date format
       HSSFCellStyle cs = wb.createCellStyle();
       HSSFDataFormat f = wb.createDataFormat();
       cs.setDataFormat(f.getFormat("yyyy-mm-dd MMMM hh:mm:ss"));
       r.getCell(0).setCellStyle(cs);
       r.getCell(1).setCellStyle(cs);
       
       assertTrue(DateUtil.isCellDateFormatted(r.getCell(0)));
       assertTrue(DateUtil.isCellDateFormatted(r.getCell(1)));
       
       // Should get much bigger now
       s.autoSizeColumn((short)0);
       s.autoSizeColumn((short)1);

       assertBetween("Date column width", s.getColumnWidth(0), 4750, 7000); 
       assertBetween("Date column width", s.getColumnWidth(1), 4750, 7000);
       
       wb.close();
    }

