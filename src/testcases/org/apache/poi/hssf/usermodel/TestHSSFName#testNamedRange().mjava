    /** Test of TestCase method, of class test.RangeTest. */
    public void testNamedRange() {
        HSSFWorkbook wb = getTestDataProvider().openSampleWorkbook("Simple.xls");

        //Creating new Named Range
        HSSFName newNamedRange = wb.createName();

        //Getting Sheet Name for the reference
        String sheetName = wb.getSheetName(0);

        //Setting its name
        newNamedRange.setNameName("RangeTest");
        //Setting its reference
        newNamedRange.setRefersToFormula(sheetName + "!$D$4:$E$8");

        //Getting NAmed Range
        HSSFName namedRange1 = wb.getNameAt(0);
        //Getting it sheet name
        sheetName = namedRange1.getSheetName();

        // sanity check
        SanityChecker c = new SanityChecker();
        c.checkHSSFWorkbook(wb);

        wb = HSSFTestDataSamples.writeOutAndReadBack(wb);
        HSSFName nm =wb.getNameAt(wb.getNameIndex("RangeTest"));
        assertTrue("Name is "+nm.getNameName(),"RangeTest".equals(nm.getNameName()));
        assertEquals(wb.getSheetName(0)+"!$D$4:$E$8", nm.getRefersToFormula());
    }

