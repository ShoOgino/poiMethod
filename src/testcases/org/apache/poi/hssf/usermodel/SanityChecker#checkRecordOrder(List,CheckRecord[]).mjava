    private void checkRecordOrder(List records, CheckRecord[] check)
    {
        int checkIndex = 0;
        for (int recordIndex = 0; recordIndex < records.size(); recordIndex++)
        {
            Record record = (Record) records.get(recordIndex);
            if (check[checkIndex].getRecord().isInstance(record))
            {
                if (check[checkIndex].getOccurance() == 'M')
                {
                    // skip over duplicate records if multiples are allowed
                    while (recordIndex+1 < records.size() && check[checkIndex].getRecord().isInstance(records.get(recordIndex+1)))
                        recordIndex++;
                }
                checkIndex++;
            }
            if (checkIndex >= check.length)
                return;
        }
        fail("Could not find required record: " + check[checkIndex]);
    }

