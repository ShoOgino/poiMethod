    public void testStringFormulas()
        throws IOException
    {
            File file = TempFile.createTempFile("testStringFormula",".xls");
            FileOutputStream out    = new FileOutputStream(file);
            HSSFWorkbook     wb     = new HSSFWorkbook();
            HSSFSheet        s      = wb.createSheet("A");
            HSSFRow          r      = null;
            HSSFCell         c      = null;
            r = s.createRow(0);
            c=r.createCell(1); c.setCellFormula("UPPER(\"abc\")");
            c=r.createCell(2); c.setCellFormula("LOWER(\"ABC\")");
            c=r.createCell(3); c.setCellFormula("CONCATENATE(\" my \",\" name \")");

            wb.write(out);
            out.close();

            wb = openSample("StringFormulas.xls");
            s = wb.getSheetAt(0);
            r = s.getRow(0);
            c = r.getCell(0);
            assertTrue("expected: UPPER(\"xyz\") got "+c.getCellFormula(), ("UPPER(\"xyz\")").equals(c.getCellFormula()));
            //c = r.getCell((short)1);
            //assertTrue("expected: A!A1+A!B1 got: "+c.getCellFormula(), ("A!A1+A!B1").equals(c.getCellFormula()));
    }

