     /**
      * Checks that dates are properly written to both types of files:
      * those with 1900 and 1904 date windowing.  Note that if the
      * previous test ({@link #testDateWindowingRead}) fails, the
      * results of this test are meaningless.
      */
      public void testDateWindowingWrite() throws Exception {
          GregorianCalendar cal = new GregorianCalendar(2000,0,1); // Jan. 1, 2000
          Date date = cal.getTime();

          // first check a file with 1900 Date Windowing
          HSSFWorkbook wb;
          wb = openSample("1900DateWindowing.xls");
          
          setCell(wb, 0, 1, date);
          wb = writeOutAndReadBack(wb);
          
          assertEquals("Date from file using 1900 Date Windowing",
                          date.getTime(),
                          readCell(wb, 0, 1).getTime());
          
          // now check a file with 1904 Date Windowing
            wb = openSample("1904DateWindowing.xls");
          setCell(wb, 0, 1, date);          
          wb = writeOutAndReadBack(wb);
          assertEquals("Date from file using 1900 Date Windowing",
                          date.getTime(),
                          readCell(wb, 0, 1).getTime());
      }

