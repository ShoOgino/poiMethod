    @Test
    public void test55668() throws IOException {
        Workbook wb = HSSFTestDataSamples.openSampleWorkbook("55668.xls");

        Sheet sheet = wb.getSheetAt(0);
        Row row = sheet.getRow(0);
        Cell cell = row.getCell(0);
        assertEquals(CellType.FORMULA, cell.getCellTypeEnum());
        assertEquals("IF(TRUE,\"\",\"\")", cell.getCellFormula());
        assertEquals("", cell.getStringCellValue());
        cell.setCellType(CellType.STRING);

        assertEquals(CellType.BLANK, cell.getCellTypeEnum());
        try {
            assertNull(cell.getCellFormula());
            fail("Should throw an exception here");
        } catch (IllegalStateException e) {
            // expected here
        }
        assertEquals("", cell.getStringCellValue());

        wb.close();
    }

