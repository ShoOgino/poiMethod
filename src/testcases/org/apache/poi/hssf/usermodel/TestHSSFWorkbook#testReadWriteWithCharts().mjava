    public void testReadWriteWithCharts() throws Exception {
        HSSFWorkbook b;
        HSSFSheet s;
        
        // Single chart, two sheets
        b = new HSSFWorkbook(
        		new FileInputStream(new File(filename,"44010-SingleChart.xls"))
        );
        assertEquals(2, b.getNumberOfSheets());
        s = b.getSheetAt(1);
        assertEquals(0, s.getFirstRowNum());
        assertEquals(0, s.getLastRowNum());
        
        // Has chart on 1st sheet??
        // FIXME
        assertNotNull(b.getSheetAt(0).getDrawingPatriarch());
        assertNull(b.getSheetAt(1).getDrawingPatriarch());
        assertFalse(b.getSheetAt(0).getDrawingPatriarch().containsChart());
        
        // We've now called getDrawingPatriarch() so 
        //  everything will be all screwy
        // So, start again
        b = new HSSFWorkbook(
        		new FileInputStream(new File(filename,"44010-SingleChart.xls"))
        );
        
        b = writeRead(b);
        assertEquals(2, b.getNumberOfSheets());
        s = b.getSheetAt(1);
        assertEquals(0, s.getFirstRowNum());
        assertEquals(0, s.getLastRowNum());

        
        // Two charts, three sheets
        b = new HSSFWorkbook(
        		new FileInputStream(new File(filename,"44010-TwoCharts.xls"))
        );
        assertEquals(3, b.getNumberOfSheets());
        
        s = b.getSheetAt(1);
        assertEquals(0, s.getFirstRowNum());
        assertEquals(0, s.getLastRowNum());
        s = b.getSheetAt(2);
        assertEquals(0, s.getFirstRowNum());
        assertEquals(0, s.getLastRowNum());
        
        // Has chart on 1st sheet??
        // FIXME
        assertNotNull(b.getSheetAt(0).getDrawingPatriarch());
        assertNull(b.getSheetAt(1).getDrawingPatriarch());
        assertNull(b.getSheetAt(2).getDrawingPatriarch());
        assertFalse(b.getSheetAt(0).getDrawingPatriarch().containsChart());
        
        // We've now called getDrawingPatriarch() so 
        //  everything will be all screwy
        // So, start again
        b = new HSSFWorkbook(
        		new FileInputStream(new File(filename,"44010-TwoCharts.xls"))
        );
        
        b = writeRead(b);
        assertEquals(3, b.getNumberOfSheets());
        
        s = b.getSheetAt(1);
        assertEquals(0, s.getFirstRowNum());
        assertEquals(0, s.getLastRowNum());
        s = b.getSheetAt(2);
        assertEquals(0, s.getFirstRowNum());
        assertEquals(0, s.getLastRowNum());
    }

