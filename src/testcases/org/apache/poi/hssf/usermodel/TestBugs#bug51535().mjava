    /**
     * Large row numbers and NPOIFS vs POIFS
     */
    @SuppressWarnings("resource")
    @Test
    public void bug51535() throws Exception {
        byte[] data = HSSFITestDataProvider.instance.getTestDataFileContent("51535.xls");

        HSSFWorkbook wbPOIFS = new HSSFWorkbook(new POIFSFileSystem(
                new ByteArrayInputStream(data)).getRoot(), false);
        HSSFWorkbook wbNPOIFS = new HSSFWorkbook(new NPOIFSFileSystem(
                new ByteArrayInputStream(data)).getRoot(), false);

        for (HSSFWorkbook wb : new HSSFWorkbook[]{wbPOIFS, wbNPOIFS}) {
            assertEquals(3, wb.getNumberOfSheets());

            // Check directly
            HSSFSheet s = wb.getSheetAt(0);
            assertEquals("Top Left Cell", s.getRow(0).getCell(0).getStringCellValue());
            assertEquals("Top Right Cell", s.getRow(0).getCell(255).getStringCellValue());
            assertEquals("Bottom Left Cell", s.getRow(65535).getCell(0).getStringCellValue());
            assertEquals("Bottom Right Cell", s.getRow(65535).getCell(255).getStringCellValue());

            // Extract and check
            ExcelExtractor ex = new ExcelExtractor(wb);
            String text = ex.getText();
            assertContains(text, "Top Left Cell");
            assertContains(text, "Top Right Cell");
            assertContains(text, "Bottom Left Cell");
            assertContains(text, "Bottom Right Cell");
            ex.close();
        }
    }

