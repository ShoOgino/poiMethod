	/**
	 * Test that we get the right number of sheets,
	 *  with the right text on them, no matter what
	 *  the hidden flags are
	 */
	public void testTextSheets() throws Exception {
		FileInputStream isH = new FileInputStream(dirPath + "/" + xlsHidden);
		POIFSFileSystem fsH = new POIFSFileSystem(isH);
		
		FileInputStream isU = new FileInputStream(dirPath + "/" + xlsShown);
		POIFSFileSystem fsU = new POIFSFileSystem(isU);

		HSSFWorkbook wbH = new HSSFWorkbook(fsH);
		HSSFWorkbook wbU = new HSSFWorkbook(fsU);
		
		// Both should have two sheets
		assertEquals(2, wbH.sheets.size());
		assertEquals(2, wbU.sheets.size());
		
		// All sheets should have one row
		assertEquals(0, wbH.getSheetAt(0).getLastRowNum());
		assertEquals(0, wbH.getSheetAt(1).getLastRowNum());
		assertEquals(0, wbU.getSheetAt(0).getLastRowNum());
		assertEquals(0, wbU.getSheetAt(1).getLastRowNum());
		
		// All rows should have one column
		assertEquals(1, wbH.getSheetAt(0).getRow(0).getLastCellNum());
		assertEquals(1, wbH.getSheetAt(1).getRow(0).getLastCellNum());
		assertEquals(1, wbU.getSheetAt(0).getRow(0).getLastCellNum());
		assertEquals(1, wbU.getSheetAt(1).getRow(0).getLastCellNum());
		
		// Text should be sheet based
		assertEquals("Sheet1A1", wbH.getSheetAt(0).getRow(0).getCell((short)0).getStringCellValue());
		assertEquals("Sheet2A1", wbH.getSheetAt(1).getRow(0).getCell((short)0).getStringCellValue());
		assertEquals("Sheet1A1", wbU.getSheetAt(0).getRow(0).getCell((short)0).getStringCellValue());
		assertEquals("Sheet2A1", wbU.getSheetAt(1).getRow(0).getCell((short)0).getStringCellValue());
	}

