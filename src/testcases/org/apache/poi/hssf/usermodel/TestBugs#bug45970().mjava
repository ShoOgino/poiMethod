    /**
     * Problems with formula references to
     *  sheets via URLs
     */
    @Test
    public void bug45970() throws Exception {
       HSSFWorkbook wb1 = openSample("FormulaRefs.xls");
       assertEquals(3, wb1.getNumberOfSheets());

       HSSFSheet s = wb1.getSheetAt(0);
       HSSFRow row;

       row = s.getRow(0);
       assertEquals(Cell.CELL_TYPE_NUMERIC, row.getCell(1).getCellType());
       assertEquals(112.0, row.getCell(1).getNumericCellValue(), 0);

       row = s.getRow(1);
       assertEquals(Cell.CELL_TYPE_FORMULA, row.getCell(1).getCellType());
       assertEquals("B1", row.getCell(1).getCellFormula());
       assertEquals(112.0, row.getCell(1).getNumericCellValue(), 0);

       row = s.getRow(2);
       assertEquals(Cell.CELL_TYPE_FORMULA, row.getCell(1).getCellType());
       assertEquals("Sheet1!B1", row.getCell(1).getCellFormula());
       assertEquals(112.0, row.getCell(1).getNumericCellValue(), 0);

       row = s.getRow(3);
       assertEquals(Cell.CELL_TYPE_FORMULA, row.getCell(1).getCellType());
       assertEquals("[Formulas2.xls]Sheet1!B2", row.getCell(1).getCellFormula());
       assertEquals(112.0, row.getCell(1).getNumericCellValue(), 0);

       row = s.getRow(4);
       assertEquals(Cell.CELL_TYPE_FORMULA, row.getCell(1).getCellType());
       assertEquals("'[$http://gagravarr.org/FormulaRefs.xls]Sheet1'!B1", row.getCell(1).getCellFormula());
       assertEquals(112.0, row.getCell(1).getNumericCellValue(), 0);

       // Change 4
       row.getCell(1).setCellFormula("'[$http://gagravarr.org/FormulaRefs2.xls]Sheet1'!B2");
       row.getCell(1).setCellValue(123.0);

       // Add 5
       row = s.createRow(5);
       row.createCell(1, Cell.CELL_TYPE_FORMULA);
       row.getCell(1).setCellFormula("'[$http://example.com/FormulaRefs.xls]Sheet1'!B1");
       row.getCell(1).setCellValue(234.0);


       // Re-test
       HSSFWorkbook wb2 = writeOutAndReadBack(wb1);
       wb1.close();
       s = wb2.getSheetAt(0);

       row = s.getRow(0);
       assertEquals(Cell.CELL_TYPE_NUMERIC, row.getCell(1).getCellType());
       assertEquals(112.0, row.getCell(1).getNumericCellValue(),0);

       row = s.getRow(1);
       assertEquals(Cell.CELL_TYPE_FORMULA, row.getCell(1).getCellType());
       assertEquals("B1", row.getCell(1).getCellFormula());
       assertEquals(112.0, row.getCell(1).getNumericCellValue(), 0);

       row = s.getRow(2);
       assertEquals(Cell.CELL_TYPE_FORMULA, row.getCell(1).getCellType());
       assertEquals("Sheet1!B1", row.getCell(1).getCellFormula());
       assertEquals(112.0, row.getCell(1).getNumericCellValue(), 0);

       row = s.getRow(3);
       assertEquals(Cell.CELL_TYPE_FORMULA, row.getCell(1).getCellType());
       assertEquals("[Formulas2.xls]Sheet1!B2", row.getCell(1).getCellFormula());
       assertEquals(112.0, row.getCell(1).getNumericCellValue(), 0);

       // TODO - Fix these so they work...
       /*row = s.getRow(4);
       assertEquals(Cell.CELL_TYPE_FORMULA, row.getCell(1).getCellType());
       assertEquals("'[$http://gagravarr.org/FormulaRefs2.xls]Sheet1'!B2", row.getCell(1).getCellFormula());
       assertEquals(123.0, row.getCell(1).getNumericCellValue(), 0);

       row = s.getRow(5);
       assertEquals(Cell.CELL_TYPE_FORMULA, row.getCell(1).getCellType());
       assertEquals("'[$http://example.com/FormulaRefs.xls]Sheet1'!B1", row.getCell(1).getCellFormula());
       assertEquals(234.0, row.getCell(1).getNumericCellValue(), 0);*/
       
       wb2.close();
    }

