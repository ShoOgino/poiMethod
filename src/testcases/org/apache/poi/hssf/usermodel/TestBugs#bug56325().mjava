    @Test
    public void bug56325() throws IOException {
        HSSFWorkbook wb;

        File file = HSSFTestDataSamples.getSampleFile("56325.xls");
        InputStream stream = new FileInputStream(file);
        try {
            POIFSFileSystem fs = new POIFSFileSystem(stream);
            wb = new HSSFWorkbook(fs);            
        } finally {
            stream.close();
        }
        
        assertEquals(3, wb.getNumberOfSheets());
        wb.removeSheetAt(0);
        assertEquals(2, wb.getNumberOfSheets());

        wb = HSSFTestDataSamples.writeOutAndReadBack(wb);
        assertEquals(2, wb.getNumberOfSheets());
        wb.removeSheetAt(0);
        assertEquals(1, wb.getNumberOfSheets());
        wb.removeSheetAt(0);
        assertEquals(0, wb.getNumberOfSheets());
        
        wb = HSSFTestDataSamples.writeOutAndReadBack(wb);
        assertEquals(0, wb.getNumberOfSheets());
    }

