	public void testBug50298() throws Exception {
		HSSFWorkbook wb = HSSFTestDataSamples.openSampleWorkbook("50298.xls");

		
		HSSFSheet sheet = wb.cloneSheet(0);

		wb.setSheetName(wb.getSheetIndex(sheet), "copy");

		wb.setSheetOrder("copy", 0);

		wb.removeSheetAt(0);
		
		// check that the overall workbook serializes with its correct size
		int expected = wb.getWorkbook().getSize();
		int written = wb.getWorkbook().serialize(0, new byte[expected*2]);
		
		assertEquals("Did not have the expected size when writing the workbook: written: " + written + ", but expected: " + expected,
				expected, written);
		
		FileOutputStream fileOut = new FileOutputStream("/tmp/workbook.xls");
		try {
			wb.write(fileOut);
		} finally {
			fileOut.close();
		}
	}

