    private static void reReadWithRemovedSheetWithName(HSSFWorkbook workbookBefore) throws Exception {
        Workbook workbook = HSSFTestDataSamples.writeOutAndReadBack(workbookBefore);
        
        System.out.println("Before removing sheet1...");
        
        Name nameCell = workbook.getName("name1");
        System.out.println("name1: " + nameCell.getRefersToFormula());
     
        nameCell = workbook.getName("name2");
        System.out.println("name2: " + nameCell.getRefersToFormula());
        
        nameCell = workbook.getName("name3");
        System.out.println("name3: " + nameCell.getRefersToFormula());
        
        workbook.removeSheetAt(workbook.getSheetIndex("sheet1"));
        
        /*FileOutputStream fos = new FileOutputStream(AFTER_FILE);
        try {
            workbook.write(fos);
        } finally {
            fos.close();
        }*/
        
        System.out.println("\nAfter removing sheet1...");
        
        nameCell = workbook.getName("name1");
        System.out.println("name1: " + nameCell.getRefersToFormula());
     
        nameCell = workbook.getName("name2");
        System.out.println("name2: " + nameCell.getRefersToFormula());
        
        nameCell = workbook.getName("name3");
        System.out.println("name3: " + nameCell.getRefersToFormula());
        
        workbook.close();
    }

