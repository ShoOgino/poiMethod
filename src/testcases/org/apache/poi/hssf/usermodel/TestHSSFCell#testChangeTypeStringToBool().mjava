	public void testChangeTypeStringToBool() {
		HSSFCell cell = new HSSFWorkbook().createSheet("Sheet1").createRow(0).createCell(0);

		cell.setCellValue(new HSSFRichTextString("TRUE"));
		assertEquals(HSSFCell.CELL_TYPE_STRING, cell.getCellType());
		try {
			cell.setCellType(HSSFCell.CELL_TYPE_BOOLEAN);
		} catch (ClassCastException e) {
			throw new AssertionFailedError(
					"Identified bug in conversion of cell from text to boolean");
		}

		assertEquals(HSSFCell.CELL_TYPE_BOOLEAN, cell.getCellType());
		assertEquals(true, cell.getBooleanCellValue());
		cell.setCellType(HSSFCell.CELL_TYPE_STRING);
		assertEquals("TRUE", cell.getRichStringCellValue().getString());

		// 'false' text to bool and back
		cell.setCellValue(new HSSFRichTextString("FALSE"));
		cell.setCellType(HSSFCell.CELL_TYPE_BOOLEAN);
		assertEquals(HSSFCell.CELL_TYPE_BOOLEAN, cell.getCellType());
		assertEquals(false, cell.getBooleanCellValue());
		cell.setCellType(HSSFCell.CELL_TYPE_STRING);
		assertEquals("FALSE", cell.getRichStringCellValue().getString());
	}

