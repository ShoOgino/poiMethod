/**
     * TEST NAME:  Test Read/Write Simple w/ Data Format<P>
     * OBJECTIVE:  Test that HSSF can write a sheet with custom data formats and then read it and get the proper formats.<P>
     * SUCCESS:    HSSF reads the sheet.  Matches values in their particular positions and format is correct<P>
     * FAILURE:    HSSF does not read a sheet or excepts.  HSSF cannot identify values
     *             in the sheet in their known positions.<P>
     *
     */

    public void testWriteDataFormat() throws IOException {
        File file = TempFile.createTempFile("testWriteDataFormat", ".xls");
        FileOutputStream out = new FileOutputStream(file);
        HSSFWorkbook wb = new HSSFWorkbook();
        HSSFSheet s = wb.createSheet();
        HSSFRow r = null;
        HSSFCell c = null;
        HSSFDataFormat format = wb.createDataFormat();
        HSSFCellStyle cs = wb.createCellStyle();

        short df = format.getFormat("0.0");
        cs.setDataFormat(df);

        r = s.createRow(0);
        c = r.createCell(0);
        c.setCellStyle(cs);
        c.setCellValue(1.25);

        wb.write(out);
        out.close();

        FileInputStream stream = new FileInputStream(file);
        POIFSFileSystem fs = new POIFSFileSystem(stream);
        HSSFWorkbook workbook = new HSSFWorkbook(fs);
        HSSFSheet sheet = workbook.getSheetAt(0);
        HSSFCell cell = sheet.getRow(0).getCell(0);
        format = workbook.createDataFormat();

        assertEquals(1.25, cell.getNumericCellValue(), 1e-10);

        assertEquals(format.getFormat(df), "0.0");

        assertEquals(format, workbook.createDataFormat());

        stream.close();

        workbook.close();
        wb.close();
    }

