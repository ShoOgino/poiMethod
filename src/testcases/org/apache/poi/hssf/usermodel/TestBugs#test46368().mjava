    /**
     * HSSFRichTextString.length() returns negative for really
     *  long strings
     */
    public void test46368() {
        HSSFWorkbook wb = new HSSFWorkbook();
    	HSSFSheet s = wb.createSheet();
    	HSSFRow r = s.createRow(0);
    	for(int i=0; i<15; i++) {
    		int len = 32760 + i;
    		HSSFCell c = r.createCell(i);
    		
    		StringBuffer sb = new StringBuffer();
    		for(int j=0; j<len; j++) {
    			sb.append("x");
    		}
    		HSSFRichTextString rtr = new HSSFRichTextString(sb.toString());
    		assertEquals(len, rtr.length());
    		c.setCellValue(rtr);
    	}
    	
    	// Save and reload
    	wb = writeOutAndReadBack(wb);
    	s = wb.getSheetAt(0);
    	r = s.getRow(0);
    	for(int i=0; i<15; i++) {
    		int len = 32760 + i;
    		HSSFCell c = r.getCell(i);
    		assertEquals(len, c.getRichStringCellValue().length());
    	}
    }

