    /**
     * tests <tt>NameXPtg.toFormulaString(Workbook)</tt> and logic in Workbook below that   
     */
    public void testReadFormulaContainingExternalFunction() {
        String filePath = System.getProperty("HSSF.testdata.path")+ "/" 
        + "externalFunctionExample.xls";
        HSSFWorkbook wb;
        try {
            FileInputStream fin = new FileInputStream(filePath);
            wb = new HSSFWorkbook( fin );
        } catch (IOException e) {
            throw new RuntimeException(e);
        }
        
        String expectedFormula = "YEARFRAC(B1,C1)";
        HSSFSheet sht = wb.getSheetAt(0);
        String cellFormula = sht.getRow(0).getCell((short)0).getCellFormula();
        assertEquals(expectedFormula, cellFormula);
    }

