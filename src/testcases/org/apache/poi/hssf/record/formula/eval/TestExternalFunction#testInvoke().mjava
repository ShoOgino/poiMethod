	/**
	 * Checks that an external function can get invoked from the formula evaluator. 
	 * @throws IOException 

	 */
	public void testInvoke() {
		
		HSSFWorkbook wb;
		HSSFSheet sheet;
		HSSFCell cell;
		if (false) {
			// TODO - this code won't work until we can create user-defined functions directly with POI
			wb = new HSSFWorkbook();
			sheet = wb.createSheet();
			wb.setSheetName(0, "Sheet1");
			HSSFName hssfName = wb.createName();
			hssfName.setNameName("myFunc");
			
		} else {
			// This sample spreadsheet already has a VB function called 'myFunc'
			wb = HSSFTestDataSamples.openSampleWorkbook("testNames.xls");
			sheet = wb.getSheetAt(0);
			HSSFRow row = sheet.createRow(0);
			cell = row.createCell(1);
		}
		
		cell.setCellFormula("myFunc()");
		String actualFormula=cell.getCellFormula();
		assertEquals("myFunc()", actualFormula);
		
		HSSFFormulaEvaluator fe = new HSSFFormulaEvaluator(sheet, wb);
		CellValue evalResult = fe.evaluate(cell);
		
		// Check the return value from ExternalFunction.evaluate()
		// TODO - make this test assert something more interesting as soon as ExternalFunction works a bit better
		assertEquals(HSSFCell.CELL_TYPE_ERROR, evalResult.getCellType());
		assertEquals(ErrorEval.FUNCTION_NOT_IMPLEMENTED.getErrorCode(), evalResult.getErrorValue());
	}

