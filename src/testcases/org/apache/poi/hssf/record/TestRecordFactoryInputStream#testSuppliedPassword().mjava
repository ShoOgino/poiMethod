	/**
	 * Makes sure that an incorrect user supplied password condition is represented with {@link EncryptedDocumentException}
	 */
	public void testSuppliedPassword() {
		// This encodng depends on docId, password and stream position
		final String SAMPLE_WINDOW1_ENCR2 = "3D 00 12 00"
			+ "45, B9, 90, FE, B6, C6, EC, 73, EE, 3F, 52, 45, 97, DB, E3, C1, D6, FE";

		byte[] dataWrongDefault = HexRead.readFromString(""
				+ COMMON_HEX_DATA
				+ "00000000 00000000 00000000 00000000"
				+ SAMPLE_WINDOW1_ENCR2
		);


		Biff8EncryptionKey.setCurrentUserPassword("passw0rd");

		RecordFactoryInputStream rfis;
		try {
			rfis = createRFIS(dataWrongDefault);
			throw new AssertionFailedError("Expected password mismatch error");
		} catch (EncryptedDocumentException e) {
			// expected during successful test
			if (!e.getMessage().equals("Supplied password is invalid for docId/saltData/saltHash")) {
				throw e;
			}
		}

		byte[] dataCorrectDefault = HexRead.readFromString(""
				+ COMMON_HEX_DATA
				+ "C728659A C38E35E0 568A338F C3FC9D70" // correct saltHash for supplied password (and docId/saltHash)
				+ SAMPLE_WINDOW1_ENCR2
		);

		rfis = createRFIS(dataCorrectDefault);
		Biff8EncryptionKey.setCurrentUserPassword(null);

		confirmReadInitialRecords(rfis);
	}

