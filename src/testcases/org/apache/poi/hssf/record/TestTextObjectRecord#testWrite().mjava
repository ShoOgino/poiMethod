    public void testWrite()
    {
        HSSFRichTextString str = new HSSFRichTextString("Hello, World!");

        TextObjectRecord record = new TextObjectRecord();
        int frLength = ( str.numFormattingRuns() + 1 ) * 8;
        record.setFormattingRunLength( (short) frLength );
        record.setTextLength( (short) str.length() );
        record.setStr( str );
        record.setHorizontalTextAlignment( TextObjectRecord.HORIZONTAL_TEXT_ALIGNMENT_LEFT_ALIGNED );
        record.setVerticalTextAlignment( TextObjectRecord.VERTICAL_TEXT_ALIGNMENT_TOP );
        record.setTextLocked( true );
        record.setTextOrientation( TextObjectRecord.TEXT_ORIENTATION_NONE );
        record.setReserved7( 0 );

        byte [] ser = record.serialize();
        //assertEquals(ser.length , data.length);

        //assertTrue(Arrays.equals(data, ser));

        //read again
        RecordInputStream is = new RecordInputStream(new ByteArrayInputStream(data));
        is.nextRecord();
        record = new TextObjectRecord(is);

    }

