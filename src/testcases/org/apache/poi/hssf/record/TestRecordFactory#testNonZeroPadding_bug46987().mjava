	public void testNonZeroPadding_bug46987() {
		Record[] recs = {
			new BOFRecord(),
			new WriteAccessRecord(), // need *something* between BOF and EOF
			EOFRecord.instance,
			BOFRecord.createSheetBOF(),
			EOFRecord.instance,
		};
		ByteArrayOutputStream baos = new ByteArrayOutputStream();
		for (int i = 0; i < recs.length; i++) {
			try {
				baos.write(recs[i].serialize());
			} catch (IOException e) {
				throw new RuntimeException(e);
			}
		}
		//simulate the bad padding at the end of the workbook stream in attachment 23483 of bug 46987
		baos.write(0x00);
		baos.write(0x11);
		baos.write(0x00);
		baos.write(0x02);
		for (int i = 0; i < 192; i++) {
			baos.write(0x00);
		}


		POIFSFileSystem fs = new POIFSFileSystem();
		InputStream is;
		try {
			fs.createDocument(new ByteArrayInputStream(baos.toByteArray()), "dummy");
			is = fs.getRoot().createDocumentInputStream("dummy");
		} catch (IOException e) {
			throw new RuntimeException(e);
		}

		List<Record> outRecs;
		try {
			outRecs = RecordFactory.createRecords(is);
		} catch (RuntimeException e) {
			if (e.getMessage().equals("Buffer underrun - requested 512 bytes but 192 was available")) {
				throw new AssertionFailedError("Identified bug 46987");
			}
			throw e;
		}
		assertEquals(5, outRecs.size());
	}

