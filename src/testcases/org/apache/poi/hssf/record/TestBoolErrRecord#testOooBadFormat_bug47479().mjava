	/**
	 * Bugzilla 47479 was due to an apparent error in OOO which (as of version 3.0.1) 
	 * writes the <i>value</i> field of BOOLERR records as 2 bytes instead of 1.<br/>
	 * Coincidentally, the extra byte written is zero, which is exactly the value 
	 * required by the <i>isError</i> field.  This probably why Excel seems to have
	 * no problem.  OOO does not have the same bug for error values (which wouldn't
	 * work by the same coincidence). 
	 */
	public void testOooBadFormat_bug47479() {
		byte[] data = HexRead.readFromString(
				"05 02 09 00 " + // sid, size
				"00 00 00 00 0F 00 " + // row, col, xfIndex
				"01 00 00 " // extra 00 byte here
				);

		RecordInputStream in = TestcaseRecordInputStream.create(data);
		BoolErrRecord ber = new BoolErrRecord(in);
		boolean hasMore;
		try {
			hasMore = in.hasNextRecord();
		} catch (LeftoverDataException e) {
			if ("Initialisation of record 0x205 left 1 bytes remaining still to be read.".equals(e.getMessage())) {
				throw new AssertionFailedError("Identified bug 47479");
			}
			throw e;
		}
		assertFalse(hasMore);
		assertTrue(ber.isBoolean());
		assertEquals(true, ber.getBooleanValue());
		
		// Check that the record re-serializes correctly
		byte[] outData = ber.serialize();
		byte[] expData = HexRead.readFromString(
				"05 02 08 00 " +
				"00 00 00 00 0F 00 " +
				"01 00 " // normal number of data bytes
				);
		assertTrue(Arrays.equals(expData, outData));
	}

