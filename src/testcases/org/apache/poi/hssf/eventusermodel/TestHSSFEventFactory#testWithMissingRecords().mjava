	public void testWithMissingRecords() throws Exception {
		File f = new File(dirname + "/SimpleWithSkip.xls");

		HSSFRequest req = new HSSFRequest();
		MockHSSFListener mockListen = new MockHSSFListener();
		req.addListenerForAllRecords(mockListen);
		
		POIFSFileSystem fs = new POIFSFileSystem(new FileInputStream(f));
		HSSFEventFactory factory = new HSSFEventFactory();
		factory.processWorkbookEvents(req, fs);

		// Check we got the records
		System.out.println("Processed, found " + mockListen.records.size() + " records");
		assertTrue( mockListen.records.size() > 100 );
		
		// Check that the last few records are as we expect
		// (Makes sure we don't accidently skip the end ones)
		int numRec = mockListen.records.size();
		assertEquals(WindowTwoRecord.class, mockListen.records.get(numRec-3).getClass());
		assertEquals(SelectionRecord.class, mockListen.records.get(numRec-2).getClass());
		assertEquals(EOFRecord.class,       mockListen.records.get(numRec-1).getClass());
	}

