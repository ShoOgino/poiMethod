	/**
	 * FormulaRecordAggregates within blanks/values cause values afterwards to not be aggregated.
	 * This usually occurs during clones 
	 *
	 */
	public void testValueAggregateWithSharedFormulas() {
		Sheet sheet;
		List records = new ArrayList();
		
		FormulaRecord formula = new FormulaRecord();
		StringRecord stringRecord = new StringRecord();
		FormulaRecordAggregate formulaAggregate = new FormulaRecordAggregate(formula, stringRecord);
		
		formula.setExpressionLength((short)5);
		formula.pushExpressionToken(new ExpPtg());
		BlankRecord blank = new BlankRecord();
		blank.setColumn((short)0);
		blank.setRow(1);
		
		records.add(new BOFRecord());
		records.add(new RowRecord());
		
		blank.setColumn((short)0);
		blank.setRow(1);
		
		records.add(blank);
		records.add(new LabelSSTRecord());
		records.add(formula);	
		records.add(new SharedFormulaRecord());
		records.add(formulaAggregate);
		
		blank = new BlankRecord();		
		blank.setColumn((short)0);
		blank.setRow(2);

		
		records.add(blank);
		records.add(new EOFRecord());
		
		sheet = Sheet.createSheet(records, 0);
		ValueRecordsAggregate valueAggregate = sheet.cells;
		
		assertEquals("Aggregated cells not correct, the blank record following sharedformula is not here", 3, valueAggregate.getPhysicalNumberOfCells());		
		
		
	}

