    /**
     * recursively map EscherClientDataRecords  to their parent shape containers:
     * <p/>
     * EscherClientDataRecord1 --> EscherContainerRecord1
     * EscherClientDataRecord2 --> EscherContainerRecord2
     * ...
     * <p/>
     * TODO: YK: this method can be avoided if we have EscherRecord.getParent()
     */
    private static void mapShapeContainers(EscherRecord parent, Map<EscherRecord, EscherContainerRecord> map) {
        if (parent.isContainerRecord()) {
            if (parent.getRecordId() == EscherContainerRecord.SP_CONTAINER) {
                // iterate over shape's children and search for EscherClientDataRecord
                for (EscherRecord r : parent.getChildRecords()) {
                    if (r.getRecordId() == EscherClientDataRecord.RECORD_ID) {
                        map.put(r, (EscherContainerRecord) parent);
                    }
                }
            } else {
                for (EscherRecord ch : parent.getChildRecords()) {
                    mapShapeContainers(ch, map);
                }
            }
        }
    }

