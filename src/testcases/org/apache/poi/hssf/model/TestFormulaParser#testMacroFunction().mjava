    public void testMacroFunction() {
        Workbook w = Workbook.createWorkbook();
        FormulaParser fp = new FormulaParser("FOO()", w);
        fp.parse();
        Ptg[] ptg = fp.getRPNPtg();

        // the name gets encoded as the first arg
        NamePtg tname = (NamePtg) ptg[0];
        assertEquals("FOO", tname.toFormulaString(w));
        
        AbstractFunctionPtg tfunc = (AbstractFunctionPtg) ptg[1];
        assertEquals("externalflag", tfunc.getName());
    }

