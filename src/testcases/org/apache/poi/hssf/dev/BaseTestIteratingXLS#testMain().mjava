	@Test
	public void testMain() throws Exception {
	    String fileName = file.getName();
	    if (EXCLUDED.containsKey(fileName)) {
	        thrown.expect(EXCLUDED.get(fileName));
	    }

		try {
			runOneFile(file);
		} catch (Exception e) {
			// try to read it in HSSFWorkbook to quickly fail if we cannot read the file there at all and thus probably should use EXCLUDED instead
            try (FileInputStream stream = new FileInputStream(file); HSSFWorkbook wb = new HSSFWorkbook(stream)) {
                assertNotNull(wb);
            }

			throw e;
		}
	}

