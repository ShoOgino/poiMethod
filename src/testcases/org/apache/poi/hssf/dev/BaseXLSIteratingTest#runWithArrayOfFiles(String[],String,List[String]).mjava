	private void runWithArrayOfFiles(String[] files, String dir, List<String> failed) throws IOException {
		for(String file : files) {
			try {
				runOneFile(dir, file, failed);
			} catch (Exception e) {
				if(SILENT_EXCLUDED.contains(file)) {
					continue;
				}

				System.out.println("Failed: " + file);
				e.printStackTrace();
				
				// try to read it in HSSFWorkbook to quickly fail if we cannot read the file there at all and thus probably can use SILENT_EXCLUDED instead
				FileInputStream stream = new FileInputStream(new File(dir, file));
				try {
					assertNotNull(new HSSFWorkbook(stream));
				} finally {
					stream.close();
				}
				
				if(!EXCLUDED.contains(file)) {
					failed.add(file);
				}
			}
		}
	}

