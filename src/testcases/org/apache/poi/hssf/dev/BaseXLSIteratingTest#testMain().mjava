	@Test
	public void testMain() throws Exception {
	    // we had intermittent problems when this was set differently somehow, let's try to set it here so it always is set correctly for these tests
	    Biff8EncryptionKey.setCurrentUserPassword(null);

	    String fileName = file.getName();
	    if (EXCLUDED.containsKey(fileName)) {
	        thrown.expect(EXCLUDED.get(fileName));
	    }
	    
		try {
			runOneFile(file);
		} catch (Exception e) {
			// try to read it in HSSFWorkbook to quickly fail if we cannot read the file there at all and thus probably should use EXCLUDED instead
			FileInputStream stream = new FileInputStream(file);
			HSSFWorkbook wb = null;
			try {
			    wb = new HSSFWorkbook(stream);
				assertNotNull(wb);
			} finally {
			    if (wb != null) {
			        wb.close();
			    }
				stream.close();
			}
			
			throw e;
		}
	}

