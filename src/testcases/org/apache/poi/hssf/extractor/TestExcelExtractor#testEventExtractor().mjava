	public void testEventExtractor() throws Exception {
		// First up, a simple file with string
		//  based formulas in it
		EventBasedExcelExtractor extractor = new EventBasedExcelExtractor(
				new POIFSFileSystem(
						HSSFTestDataSamples.openSampleFileStream("SimpleWithFormula.xls")
				)
		);
		try {
    		extractor.setIncludeSheetNames(true);
    
    		String text = extractor.getText();
    		assertEquals("Sheet1\nreplaceme\nreplaceme\nreplacemereplaceme\nSheet2\nSheet3\n", text);
    
    		extractor.setIncludeSheetNames(false);
    		extractor.setFormulasNotResults(true);
    
    		text = extractor.getText();
    		assertEquals("replaceme\nreplaceme\nCONCATENATE(A1,A2)\n", text);
    
    
    		// Now, a slightly longer file with numeric formulas
    		extractor = new EventBasedExcelExtractor(
    				new POIFSFileSystem(
    						HSSFTestDataSamples.openSampleFileStream("sumifformula.xls")
    				)
    		);
    		extractor.setIncludeSheetNames(false);
    		extractor.setFormulasNotResults(true);
    
    		text = extractor.getText();
    		assertEquals(
    				"1000\t1\tSUMIF(A1:A5,\">4000\",B1:B5)\n" +
    				"2000\t2\n" +
    				"3000\t3\n" +
    				"4000\t4\n" +
    				"5000\t5\n",
    				text
    		);
		} finally {
		    extractor.close();
		}
	}

