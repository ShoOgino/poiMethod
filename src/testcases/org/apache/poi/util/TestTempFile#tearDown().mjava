    @After
    public void tearDown() throws IOException {
        String[] files = tempDir.list();
        // can have the "poifiles" subdir
        if(files.length == 1) {
            assertEquals("Had: " + Arrays.toString(files), "poifiles", files[0]);
            files = new File(tempDir, files[0]).list();
            assertEquals("Had: " + Arrays.toString(files), 0, files.length);
        } else {
            assertEquals("Had: " + Arrays.toString(files), 0, files.length);
        }

        // remove the directory after the tests
        TestPOIFSDump.deleteDirectory(tempDir);

        if(previousTempDir == null) {
            System.clearProperty(TempFile.JAVA_IO_TMPDIR);
        } else {
            System.setProperty(TempFile.JAVA_IO_TMPDIR, previousTempDir);
        }
    }

