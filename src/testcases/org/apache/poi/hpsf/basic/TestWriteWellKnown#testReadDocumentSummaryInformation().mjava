    /**
     * <p>This test method checks whether DocumentSummary information streams
     * can be read. This is done by opening all "Test*" files in the 'poifs' directrory
     * pointed to by the "POI.testdata.path" system property, trying to extract
     * the document summary information stream in the root directory and calling
     * its get... methods.</p>
     */
    @Test
    public void testReadDocumentSummaryInformation()
            throws FileNotFoundException, IOException,
            NoPropertySetStreamException, MarkUnsupportedException,
            UnexpectedPropertySetTypeException
    {
        POIDataSamples _samples = POIDataSamples.getHPSFInstance();
        final File dataDir = _samples.getFile("");
        final File[] docs = dataDir.listFiles(new FileFilter()
        {
            @Override
            public boolean accept(final File file)
            {
                return file.isFile() && file.getName().startsWith("Test") && TestReadAllFiles.checkExclude(file);
            }
        });

        for (final File doc : docs) {
            NPOIFSFileSystem poifs = null;
            try {
                /* Read a test document <em>doc</em> into a POI filesystem. */
                poifs = new NPOIFSFileSystem(doc, true);
                final DirectoryEntry dir = poifs.getRoot();
                /*
                 * If there is a document summry information stream, read it from
                 * the POI filesystem.
                 */
                if (dir.hasEntry(DocumentSummaryInformation.DEFAULT_STREAM_NAME)) {
                    final DocumentSummaryInformation dsi = getDocumentSummaryInformation(poifs);
    
                    /* Execute the get... methods. */
                    dsi.getByteCount();
                    dsi.getByteOrder();
                    dsi.getCategory();
                    dsi.getCompany();
                    dsi.getCustomProperties();
                    // FIXME dsi.getDocparts();
                    // FIXME dsi.getHeadingPair();
                    dsi.getHiddenCount();
                    dsi.getLineCount();
                    dsi.getLinksDirty();
                    dsi.getManager();
                    dsi.getMMClipCount();
                    dsi.getNoteCount();
                    dsi.getParCount();
                    dsi.getPresentationFormat();
                    dsi.getScale();
                    dsi.getSlideCount();
                }
            } catch (Exception e) {
                throw new IOException("While handling file " + doc, e);
            } finally {
                if (poifs != null) poifs.close();
            }
        }
    }

