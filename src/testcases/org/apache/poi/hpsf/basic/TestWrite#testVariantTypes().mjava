    /**
     * <p>Writes and reads back various variant types and checks whether the
     * stuff that has been read back equals the stuff that was written.</p>
     */
    public void testVariantTypes()
    {
        Throwable t = null;
        try
        {
            check(Variant.VT_EMPTY, null);
            check(Variant.VT_BOOL, new Boolean(true));
            check(Variant.VT_BOOL, new Boolean(false));
            check(Variant.VT_CF, new byte[]{0});
            check(Variant.VT_CF, new byte[]{0, 1});
            check(Variant.VT_CF, new byte[]{0, 1, 2});
            check(Variant.VT_CF, new byte[]{0, 1, 2, 3});
            check(Variant.VT_CF, new byte[]{0, 1, 2, 3, 4});
            check(Variant.VT_CF, new byte[]{0, 1, 2, 3, 4, 5});
            check(Variant.VT_CF, new byte[]{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10});
            check(Variant.VT_I2, new Integer(27));
            check(Variant.VT_I4, new Long(28));
            check(Variant.VT_FILETIME, new Date());
            check(Variant.VT_LPSTR, "");
            check(Variant.VT_LPSTR, "�");
            check(Variant.VT_LPSTR, "��");
            check(Variant.VT_LPSTR, "���");
            check(Variant.VT_LPSTR, "����");
            check(Variant.VT_LPSTR, "�����");
            check(Variant.VT_LPSTR, "������");
            check(Variant.VT_LPSTR, "�������");
            check(Variant.VT_LPWSTR, "");
            check(Variant.VT_LPWSTR, "�");
            check(Variant.VT_LPWSTR, "��");
            check(Variant.VT_LPWSTR, "���");
            check(Variant.VT_LPWSTR, "����");
            check(Variant.VT_LPWSTR, "�����");
            check(Variant.VT_LPWSTR, "������");
            check(Variant.VT_LPWSTR, "�������");
        }
        catch (Exception ex)
        {
            t = ex;
        }
        catch (Error ex)
        {
            t = ex;
        }
        if (t != null)
        {
            StringWriter sw = new StringWriter();
            PrintWriter pw = new PrintWriter(sw);
            t.printStackTrace(pw);
            pw.close();
            try
            {
                sw.close();
            }
            catch (IOException ex2)
            {
                t.printStackTrace();
            }
            fail(sw.toString());
        }
    }

