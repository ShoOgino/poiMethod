    /**
     * <p>This test methods reads all property set streams from all POI
     * filesystems in the "data" directory.</p>
     * 
     * @throws IOException 
     * @throws HPSFException
     */
    public void testReadAllFiles() throws IOException, HPSFException
    {
        POIDataSamples _samples = POIDataSamples.getHPSFInstance();
        final File dataDir = _samples.getFile("");
        final File[] fileList = dataDir.listFiles(new FileFilter()
            {
                @Override
                public boolean accept(final File f)
                {
                    // exclude files that we know will fail
                    for(String exclude : excludes) {
                        if(f.getAbsolutePath().endsWith(exclude)) {
                            return false;
                        }
                    }

                    return f.isFile();
                }
            });

        for (int i = 0; i < fileList.length; i++)
        {
            final File f = fileList[i];
            /* Read the POI filesystem's property set streams: */
            final POIFile[] psf1 = Util.readPropertySets(f);

            for (int j = 0; j < psf1.length; j++)
            {
                final InputStream in =
                    new ByteArrayInputStream(psf1[j].getBytes());
                try {
                    PropertySetFactory.create(in);
                } catch (Exception e) {
                    throw new IOException("While handling file: " + f + " at " + j, e);
                }
            }
        }
    }

