    public void testAllocateSpace() {
        BlockAllocationTableWriter table         =
            new BlockAllocationTableWriter(POIFSConstants.SMALLER_BIG_BLOCK_SIZE_DETAILS);
        int[]                      blockSizes    =
        {
            0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9
        };
        int                        expectedIndex = 0;

        for (int blockSize : blockSizes) {
            assertEquals(expectedIndex, table.allocateSpace(blockSize));
            expectedIndex += blockSize;
        }
    }

