    protected static String readVBA(POIDataSamples poiDataSamples) {
        File macro = poiDataSamples.getFile("SimpleMacro.vba");
        byte[] bytes;
        try {
            bytes = IOUtils.toByteArray(new FileInputStream(macro));
        } catch (IOException e) {
            throw new RuntimeException(e);
        }
        String testMacroContents = new String(bytes, StringUtil.UTF8);
        
        if (! testMacroContents.startsWith("Sub ")) {
            throw new IllegalArgumentException("Not a macro");
        }
        String testMacroNoSub = testMacroContents.substring(testMacroContents.indexOf("()")+3);
        return testMacroNoSub;
    }

