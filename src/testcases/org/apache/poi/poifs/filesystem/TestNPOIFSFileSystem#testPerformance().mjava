   @Ignore("Takes a long time to run")
   @Test
   public void testPerformance() throws Exception {
      int iterations = 200;//1_000;

      System.out.println("OPOI:");
      long start = System.currentTimeMillis();

      for (int i = 0; i < iterations; i++) {
         try (InputStream inputStream = POIDataSamples.getHSMFInstance().openResourceAsStream("lots-of-recipients.msg")) {
            NPOIFSFileSystem srcFileSystem = new NPOIFSFileSystem(inputStream);
            NPOIFSFileSystem destFileSystem = new NPOIFSFileSystem();

            copyAllEntries(srcFileSystem.getRoot(), destFileSystem.getRoot());

            File file = File.createTempFile("opoi", ".dat");
            try (OutputStream outputStream = new FileOutputStream(file)) {
               destFileSystem.writeFilesystem(outputStream);
            }

            assertTrue(file.delete());
            if (i % 10 == 0) System.out.print(".");
         }
      }

      System.out.println();
      System.out.println("OPOI took: " + (System.currentTimeMillis() - start));


      System.out.println();
      System.out.println("NPOI:");
      start = System.currentTimeMillis();

      for (int i = 0; i < iterations; i++) {

         try (InputStream inputStream = POIDataSamples.getHSMFInstance().openResourceAsStream("lots-of-recipients.msg")) {
            NPOIFSFileSystem srcFileSystem = new NPOIFSFileSystem(inputStream);
            NPOIFSFileSystem destFileSystem = new NPOIFSFileSystem();

            copyAllEntries(srcFileSystem.getRoot(), destFileSystem.getRoot());

            File file = File.createTempFile("npoi", ".dat");
            try (OutputStream outputStream = new FileOutputStream(file)) {
               destFileSystem.writeFilesystem(outputStream);
            }

            assertTrue(file.delete());
            if (i % 10 == 0) System.out.print(".");
         }
      }

      System.out.println();
      System.out.println("NPOI took: " + (System.currentTimeMillis() - start));

      System.out.println();
      System.out.println();
   }

