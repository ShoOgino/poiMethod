    /**
     * Test sorting of properties in <code>DirectoryProperty</code>
     */
    public void testSortProperties() throws IOException {
        POIFSFileSystem fs = openSampleFS();
        Property[] props = getVBAProperties(fs);

        assertEquals(_entries.length, props.length);

        // (1). See that there is a problem with the old case-sensitive property comparator
        Arrays.sort(props, OldCaseSensitivePropertyComparator);
        try {
            for (int i = 0; i < props.length; i++) {
                assertEquals(_entries[i], props[i].getName());
            }
            fail("expected old case-sensitive property comparator to return properties in wrong order");
        } catch (ComparisonFailure e){
            // expected during successful test
            assertNotNull(e.getMessage());
        }

        // (2) Verify that the fixed property comparator works right
        Arrays.sort(props, new DirectoryProperty.PropertyComparator());
        for (int i = 0; i < props.length; i++) {
            assertEquals(_entries[i], props[i].getName());
        }
    }

