    protected DirectoryNode[] openSamples(InputStream[] inps, boolean oldFails) throws Exception {
        NPOIFSFileSystem nfs = new NPOIFSFileSystem(inps[0]);
        if (openedFSs == null) openedFSs = new ArrayList<NPOIFSFileSystem>();
        openedFSs.add(nfs);
        
        OPOIFSFileSystem ofs = null;
        try {
            ofs = new OPOIFSFileSystem(inps[1]);
            if (oldFails) fail("POIFSFileSystem should have failed but didn't");
        } catch (Exception e) {
            if (!oldFails) throw e;
        }

        if (ofs == null) return new DirectoryNode[] { nfs.getRoot() };
        return new DirectoryNode[] { ofs.getRoot(), nfs.getRoot() };
    }

