    public void testFileCorruptionOPOIFS() throws Exception {
        
        // create test InputStream
        byte[] testData = { (byte)1, (byte)2, (byte)3 };
        InputStream testInput = new ByteArrayInputStream(testData);
        
        // detect header
        InputStream in = FileMagic.prepareToCheckMagic(testInput);
        assertFalse(OPOIFSFileSystem.hasPOIFSHeader(in));

        // check if InputStream is still intact
        byte[] test = new byte[3];
        in.read(test);
        assertTrue(Arrays.equals(testData, test));
        assertEquals(-1, in.read());
    }

