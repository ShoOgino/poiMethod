    protected DirectoryNode[] openSample(String name, boolean oldFails) throws Exception {
        NPOIFSFileSystem nfs = new NPOIFSFileSystem(
                _samples.openResourceAsStream(name));
        if (openedFSs == null) openedFSs = new ArrayList<NPOIFSFileSystem>();
        openedFSs.add(nfs);
        
        POIFSFileSystem ofs = null;
        try {
            ofs = new POIFSFileSystem(
                _samples.openResourceAsStream(name));
            if (oldFails) fail("POIFSFileSystem should have failed but didn't");
        } catch (Exception e) {
            if (!oldFails) throw e;
        }

        if (ofs == null) return new DirectoryNode[] { nfs.getRoot() };
        return new DirectoryNode[] { ofs.getRoot(), nfs.getRoot() };
    }

