	/**
	 * Check that we do the right thing when the list of which
	 *  sectors are BAT blocks points off the list of
	 *  sectors that exist in the file.
	 */
	public void testFATandDIFATsectors() throws Exception {
        // Open the file up
        try {
            InputStream stream = _samples.openResourceAsStream("ReferencesInvalidSectors.mpp");
            try {
                new POIFSFileSystem(stream);
                fail("File is corrupt and shouldn't have been opened");
            } finally {
                stream.close();
            }
        } catch (IOException e) {
            String msg = e.getMessage();
            assertTrue(msg.startsWith("Your file contains 695 sectors"));
        }
	}

