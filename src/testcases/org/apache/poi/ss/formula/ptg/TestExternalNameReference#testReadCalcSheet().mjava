	/**
	 * tests <tt>NameXPtg for external cell reference by name</tt> and logic in Workbook below that   
	 */
	public void testReadCalcSheet() {
	    try{
		HSSFWorkbook wb = HSSFTestDataSamples.openSampleWorkbook("XRefCalc.xls");
		assertEquals("Sheet1!$A$2", wb.getName("QUANT").getRefersToFormula());
		assertEquals("Sheet1!$B$2", wb.getName("PART").getRefersToFormula());
		assertEquals("x123",wb.getSheet("Sheet1").getRow(1).getCell(1).getStringCellValue());
		assertEquals("Sheet1!$C$2", wb.getName("UNITCOST").getRefersToFormula());
		CellReference cellRef = new CellReference(wb.getName("UNITCOST").getRefersToFormula());
		HSSFCell cell = wb.getSheet(cellRef.getSheetName()).getRow(cellRef.getRow()).getCell(cellRef.getCol());
		assertEquals("VLOOKUP(PART,COSTS,2,FALSE)",cell.getCellFormula());
		assertEquals("Sheet1!$D$2", wb.getName("COST").getRefersToFormula());
		cellRef = new CellReference(wb.getName("COST").getRefersToFormula());
		cell = wb.getSheet(cellRef.getSheetName()).getRow(cellRef.getRow()).getCell(cellRef.getCol());
		assertEquals("UNITCOST*Quant",cell.getCellFormula());
		assertEquals("Sheet1!$E$2", wb.getName("TOTALCOST").getRefersToFormula());
		cellRef = new CellReference(wb.getName("TOTALCOST").getRefersToFormula());
		cell = wb.getSheet(cellRef.getSheetName()).getRow(cellRef.getRow()).getCell(cellRef.getCol());
		assertEquals("Cost*Markup_Cost",cell.getCellFormula());
	    }catch(Exception e){
		fail();
	    }
	}

