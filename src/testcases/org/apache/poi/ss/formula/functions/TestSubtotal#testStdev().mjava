    public void testStdev(){

        Workbook wb = new HSSFWorkbook();

        FormulaEvaluator fe = wb.getCreationHelper().createFormulaEvaluator();

        Sheet sh = wb.createSheet();
        Cell a1 = sh.createRow(0).createCell(0);
        a1.setCellValue(1);
        Cell a2 = sh.createRow(1).createCell(0);
        a2.setCellValue(3);
        Cell a3 = sh.createRow(2).createCell(0);
        a3.setCellFormula("SUBTOTAL(7,A1:A2)");
        Cell a4 = sh.createRow(3).createCell(0);
        a4.setCellValue(1);
        Cell a5 = sh.createRow(4).createCell(0);
        a5.setCellValue(7);
        Cell a6 = sh.createRow(5).createCell(0);
        a6.setCellFormula("SUBTOTAL(7,A1:A5)*2 + 2");
        Cell a7 = sh.createRow(6).createCell(0);
        a7.setCellFormula("SUBTOTAL(7,A1:A6)");

        fe.evaluateAll();

        assertEquals(1.41421, a3.getNumericCellValue(), 0.0001);
        assertEquals(7.65685, a6.getNumericCellValue(), 0.0001);
        assertEquals(2.82842, a7.getNumericCellValue(), 0.0001);
    }

