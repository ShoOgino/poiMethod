    private Workbook testIFEqualsFormulaEvaluation_setup(String formula, int a1CellType) {
        Workbook wb = new HSSFWorkbook();
        Sheet sheet = wb.createSheet("IFEquals");
        Row row = sheet.createRow(0);
        Cell A1 = row.createCell(0);
        Cell B1 = row.createCell(1);
        Cell C1 = row.createCell(2);
        Cell D1 = row.createCell(3);
        
        switch (a1CellType) {
            case Cell.CELL_TYPE_NUMERIC:
                A1.setCellValue(1.0);
                // "A1=1" should return true
                break;
            case Cell.CELL_TYPE_STRING:
                A1.setCellValue("1");
                // "A1=1" should return false
                // "A1=\"1\"" should return true
                break;
            case Cell.CELL_TYPE_BOOLEAN:
                A1.setCellValue(true);
                // "A1=1" should return true
                break;
            case Cell.CELL_TYPE_FORMULA:
                A1.setCellFormula("1");
                // "A1=1" should return true
                break;
            case Cell.CELL_TYPE_BLANK:
                A1.setCellValue((String) null);
                // "A1=1" should return false
                break;
        }
        B1.setCellValue(2.0);
        C1.setCellValue(3.0);
        D1.setCellFormula(formula);
        
        return wb;
    }

