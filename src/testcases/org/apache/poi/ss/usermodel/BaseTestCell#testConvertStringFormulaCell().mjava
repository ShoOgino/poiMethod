	/**
	 * Test for a bug observed around svn r886733 when using
	 * {@link FormulaEvaluator#evaluateInCell(Cell)} with a
	 * string result type.
	 */
	public void testConvertStringFormulaCell() {
		Cell cellA1 = createACell();
		cellA1.setCellFormula("\"abc\"");

		// default cached formula result is numeric zero
		assertEquals(0.0, cellA1.getNumericCellValue(), 0.0);

		FormulaEvaluator fe = cellA1.getSheet().getWorkbook().getCreationHelper().createFormulaEvaluator();

		fe.evaluateFormulaCell(cellA1);
		assertEquals("abc", cellA1.getStringCellValue());

		fe.evaluateInCell(cellA1);
		if (cellA1.getStringCellValue().equals("")) {
			throw new AssertionFailedError("Identified bug with writing back formula result of type string");
		}
		assertEquals("abc", cellA1.getStringCellValue());
	}

