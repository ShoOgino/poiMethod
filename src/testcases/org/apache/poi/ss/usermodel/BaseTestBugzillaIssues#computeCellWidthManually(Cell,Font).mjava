    private double computeCellWidthManually(Cell cell0, Font font) {
        double width;
        final FontRenderContext fontRenderContext = new FontRenderContext(null, true, true);        
        RichTextString rt = cell0.getRichStringCellValue();
        String[] lines = rt.getString().split("\\n");
        assertEquals(1, lines.length);
        String txt = lines[0] + "0";

        AttributedString str = new AttributedString(txt);
        copyAttributes(font, str, 0, txt.length());

        if (rt.numFormattingRuns() > 0) {
            // TODO: support rich text fragments
        }

        TextLayout layout = new TextLayout(str.getIterator(), fontRenderContext);
        width = ((layout.getBounds().getWidth() / 1) / 8);
        return width;
    }

