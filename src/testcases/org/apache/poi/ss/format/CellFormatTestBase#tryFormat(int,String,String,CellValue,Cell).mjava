    private void tryFormat(int row, String expectedText, String desc,
            CellValue getter, Cell cell) {

        Object value = getter.getValue(cell);
        Color testColor = getter.getColor(cell);
        if (testColor == null)
            testColor = TEST_COLOR;

        if (label == null)
            label = new JLabel();
        label.setForeground(testColor);
        label.setText("xyzzy");

        logger.log(POILogger.INFO, String.format(LocaleUtil.getUserLocale(),
                "Row %d: \"%s\" -> \"%s\": expected \"%s\"",
                row + 1, String.valueOf(value), desc, expectedText));
        String actualText = tryColor(desc, null, getter, value, expectedText,
                testColor);
        logger.log(POILogger.INFO, String.format(LocaleUtil.getUserLocale(),
                ", actual \"%s\")%n", actualText));

        if (tryAllColors && testColor != TEST_COLOR) {
            for (int i = 0; i < COLOR_NAMES.length; i++) {
                tryColor(desc, COLOR_NAMES[i], getter, value, expectedText, COLORS[i]);
            }
        }
    }

