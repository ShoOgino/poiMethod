    @Test
    public void drawBorders() throws IOException {
        CellRangeAddress a1c3 = new CellRangeAddress(0, 2, 0, 2);
        PropertyTemplate pt = new PropertyTemplate();
        pt.drawBorders(a1c3, CellStyle.BORDER_THIN,
                PropertyTemplate.Extent.ALL);
        for (int i = 0; i <= 2; i++) {
            for (int j = 0; j <= 2; j++) {
                assertEquals(4, pt.getNumBorders(i, j));
                assertEquals(CellStyle.BORDER_THIN,
                        pt.getTemplateProperty(i, j, CellUtil.BORDER_TOP));
                assertEquals(CellStyle.BORDER_THIN,
                        pt.getTemplateProperty(i, j, CellUtil.BORDER_BOTTOM));
                assertEquals(CellStyle.BORDER_THIN,
                        pt.getTemplateProperty(i, j, CellUtil.BORDER_LEFT));
                assertEquals(CellStyle.BORDER_THIN,
                        pt.getTemplateProperty(i, j, CellUtil.BORDER_RIGHT));
            }
        }
        pt.drawBorders(a1c3, CellStyle.BORDER_MEDIUM,
                PropertyTemplate.Extent.OUTSIDE);
        for (int i = 0; i <= 2; i++) {
            for (int j = 0; j <= 2; j++) {
                assertEquals(4, pt.getNumBorders(i, j));
                if (i == 0) {
                    if (j == 0) {
                        assertEquals(CellStyle.BORDER_MEDIUM,
                                pt.getTemplateProperty(i, j,
                                        CellUtil.BORDER_TOP));
                        assertEquals(CellStyle.BORDER_THIN,
                                pt.getTemplateProperty(i, j,
                                        CellUtil.BORDER_BOTTOM));
                        assertEquals(CellStyle.BORDER_MEDIUM,
                                pt.getTemplateProperty(i, j,
                                        CellUtil.BORDER_LEFT));
                        assertEquals(CellStyle.BORDER_THIN,
                                pt.getTemplateProperty(i, j,
                                        CellUtil.BORDER_RIGHT));
                    } else if (j == 2) {
                        assertEquals(CellStyle.BORDER_MEDIUM,
                                pt.getTemplateProperty(i, j,
                                        CellUtil.BORDER_TOP));
                        assertEquals(CellStyle.BORDER_THIN,
                                pt.getTemplateProperty(i, j,
                                        CellUtil.BORDER_BOTTOM));
                        assertEquals(CellStyle.BORDER_THIN,
                                pt.getTemplateProperty(i, j,
                                        CellUtil.BORDER_LEFT));
                        assertEquals(CellStyle.BORDER_MEDIUM,
                                pt.getTemplateProperty(i, j,
                                        CellUtil.BORDER_RIGHT));
                    } else {
                        assertEquals(CellStyle.BORDER_MEDIUM,
                                pt.getTemplateProperty(i, j,
                                        CellUtil.BORDER_TOP));
                        assertEquals(CellStyle.BORDER_THIN,
                                pt.getTemplateProperty(i, j,
                                        CellUtil.BORDER_BOTTOM));
                        assertEquals(CellStyle.BORDER_THIN,
                                pt.getTemplateProperty(i, j,
                                        CellUtil.BORDER_LEFT));
                        assertEquals(CellStyle.BORDER_THIN,
                                pt.getTemplateProperty(i, j,
                                        CellUtil.BORDER_RIGHT));
                    }
                } else if (i == 2) {
                    if (j == 0) {
                        assertEquals(CellStyle.BORDER_THIN,
                                pt.getTemplateProperty(i, j,
                                        CellUtil.BORDER_TOP));
                        assertEquals(CellStyle.BORDER_MEDIUM,
                                pt.getTemplateProperty(i, j,
                                        CellUtil.BORDER_BOTTOM));
                        assertEquals(CellStyle.BORDER_MEDIUM,
                                pt.getTemplateProperty(i, j,
                                        CellUtil.BORDER_LEFT));
                        assertEquals(CellStyle.BORDER_THIN,
                                pt.getTemplateProperty(i, j,
                                        CellUtil.BORDER_RIGHT));
                    } else if (j == 2) {
                        assertEquals(CellStyle.BORDER_THIN,
                                pt.getTemplateProperty(i, j,
                                        CellUtil.BORDER_TOP));
                        assertEquals(CellStyle.BORDER_MEDIUM,
                                pt.getTemplateProperty(i, j,
                                        CellUtil.BORDER_BOTTOM));
                        assertEquals(CellStyle.BORDER_THIN,
                                pt.getTemplateProperty(i, j,
                                        CellUtil.BORDER_LEFT));
                        assertEquals(CellStyle.BORDER_MEDIUM,
                                pt.getTemplateProperty(i, j,
                                        CellUtil.BORDER_RIGHT));
                    } else {
                        assertEquals(CellStyle.BORDER_THIN,
                                pt.getTemplateProperty(i, j,
                                        CellUtil.BORDER_TOP));
                        assertEquals(CellStyle.BORDER_MEDIUM,
                                pt.getTemplateProperty(i, j,
                                        CellUtil.BORDER_BOTTOM));
                        assertEquals(CellStyle.BORDER_THIN,
                                pt.getTemplateProperty(i, j,
                                        CellUtil.BORDER_LEFT));
                        assertEquals(CellStyle.BORDER_THIN,
                                pt.getTemplateProperty(i, j,
                                        CellUtil.BORDER_RIGHT));
                    }
                } else {
                    if (j == 0) {
                        assertEquals(CellStyle.BORDER_THIN,
                                pt.getTemplateProperty(i, j,
                                        CellUtil.BORDER_TOP));
                        assertEquals(CellStyle.BORDER_THIN,
                                pt.getTemplateProperty(i, j,
                                        CellUtil.BORDER_BOTTOM));
                        assertEquals(CellStyle.BORDER_MEDIUM,
                                pt.getTemplateProperty(i, j,
                                        CellUtil.BORDER_LEFT));
                        assertEquals(CellStyle.BORDER_THIN,
                                pt.getTemplateProperty(i, j,
                                        CellUtil.BORDER_RIGHT));
                    } else if (j == 2) {
                        assertEquals(CellStyle.BORDER_THIN,
                                pt.getTemplateProperty(i, j,
                                        CellUtil.BORDER_TOP));
                        assertEquals(CellStyle.BORDER_THIN,
                                pt.getTemplateProperty(i, j,
                                        CellUtil.BORDER_BOTTOM));
                        assertEquals(CellStyle.BORDER_THIN,
                                pt.getTemplateProperty(i, j,
                                        CellUtil.BORDER_LEFT));
                        assertEquals(CellStyle.BORDER_MEDIUM,
                                pt.getTemplateProperty(i, j,
                                        CellUtil.BORDER_RIGHT));
                    } else {
                        assertEquals(CellStyle.BORDER_THIN,
                                pt.getTemplateProperty(i, j,
                                        CellUtil.BORDER_TOP));
                        assertEquals(CellStyle.BORDER_THIN,
                                pt.getTemplateProperty(i, j,
                                        CellUtil.BORDER_BOTTOM));
                        assertEquals(CellStyle.BORDER_THIN,
                                pt.getTemplateProperty(i, j,
                                        CellUtil.BORDER_LEFT));
                        assertEquals(CellStyle.BORDER_THIN,
                                pt.getTemplateProperty(i, j,
                                        CellUtil.BORDER_RIGHT));
                    }
                }
            }
        }
        pt.drawBorders(a1c3, CellStyle.BORDER_NONE,
                PropertyTemplate.Extent.NONE);
        for (int i = 0; i <= 2; i++) {
            for (int j = 0; j <= 2; j++) {
                assertEquals(0, pt.getNumBorders(i, j));
            }
        }
        pt.drawBorders(a1c3, CellStyle.BORDER_MEDIUM,
                PropertyTemplate.Extent.TOP);
        for (int i = 0; i <= 2; i++) {
            for (int j = 0; j <= 2; j++) {
                if (i == 0) {
                    assertEquals(1, pt.getNumBorders(i, j));
                    assertEquals(CellStyle.BORDER_MEDIUM,
                            pt.getTemplateProperty(i, j, CellUtil.BORDER_TOP));
                } else {
                    assertEquals(0, pt.getNumBorders(i, j));
                }
            }
        }
        pt.drawBorders(a1c3, CellStyle.BORDER_NONE,
                PropertyTemplate.Extent.NONE);
        pt.drawBorders(a1c3, CellStyle.BORDER_MEDIUM,
                PropertyTemplate.Extent.BOTTOM);
        for (int i = 0; i <= 2; i++) {
            for (int j = 0; j <= 2; j++) {
                if (i == 2) {
                    assertEquals(1, pt.getNumBorders(i, j));
                    assertEquals(CellStyle.BORDER_MEDIUM, pt
                            .getTemplateProperty(i, j, CellUtil.BORDER_BOTTOM));
                } else {
                    assertEquals(0, pt.getNumBorders(i, j));
                }
            }
        }
        pt.drawBorders(a1c3, CellStyle.BORDER_NONE,
                PropertyTemplate.Extent.NONE);
        pt.drawBorders(a1c3, CellStyle.BORDER_MEDIUM,
                PropertyTemplate.Extent.LEFT);
        for (int i = 0; i <= 2; i++) {
            for (int j = 0; j <= 2; j++) {
                if (j == 0) {
                    assertEquals(1, pt.getNumBorders(i, j));
                    assertEquals(CellStyle.BORDER_MEDIUM,
                            pt.getTemplateProperty(i, j, CellUtil.BORDER_LEFT));
                } else {
                    assertEquals(0, pt.getNumBorders(i, j));
                }
            }
        }
        pt.drawBorders(a1c3, CellStyle.BORDER_NONE,
                PropertyTemplate.Extent.NONE);
        pt.drawBorders(a1c3, CellStyle.BORDER_MEDIUM,
                PropertyTemplate.Extent.RIGHT);
        for (int i = 0; i <= 2; i++) {
            for (int j = 0; j <= 2; j++) {
                if (j == 2) {
                    assertEquals(1, pt.getNumBorders(i, j));
                    assertEquals(CellStyle.BORDER_MEDIUM, pt
                            .getTemplateProperty(i, j, CellUtil.BORDER_RIGHT));
                } else {
                    assertEquals(0, pt.getNumBorders(i, j));
                }
            }
        }
        pt.drawBorders(a1c3, CellStyle.BORDER_NONE,
                PropertyTemplate.Extent.NONE);
        pt.drawBorders(a1c3, CellStyle.BORDER_MEDIUM,
                PropertyTemplate.Extent.HORIZONTAL);
        for (int i = 0; i <= 2; i++) {
            for (int j = 0; j <= 2; j++) {
                assertEquals(2, pt.getNumBorders(i, j));
                assertEquals(CellStyle.BORDER_MEDIUM,
                        pt.getTemplateProperty(i, j, CellUtil.BORDER_TOP));
                assertEquals(CellStyle.BORDER_MEDIUM,
                        pt.getTemplateProperty(i, j, CellUtil.BORDER_BOTTOM));
            }
        }
        pt.drawBorders(a1c3, CellStyle.BORDER_NONE,
                PropertyTemplate.Extent.NONE);
        pt.drawBorders(a1c3, CellStyle.BORDER_MEDIUM,
                PropertyTemplate.Extent.INSIDE_HORIZONTAL);
        for (int i = 0; i <= 2; i++) {
            for (int j = 0; j <= 2; j++) {
                if (i == 0) {
                    assertEquals(1, pt.getNumBorders(i, j));
                    assertEquals(CellStyle.BORDER_MEDIUM, pt
                            .getTemplateProperty(i, j, CellUtil.BORDER_BOTTOM));
                } else if (i == 2) {
                    assertEquals(1, pt.getNumBorders(i, j));
                    assertEquals(CellStyle.BORDER_MEDIUM,
                            pt.getTemplateProperty(i, j, CellUtil.BORDER_TOP));
                } else {
                    assertEquals(2, pt.getNumBorders(i, j));
                    assertEquals(CellStyle.BORDER_MEDIUM,
                            pt.getTemplateProperty(i, j, CellUtil.BORDER_TOP));
                    assertEquals(CellStyle.BORDER_MEDIUM, pt
                            .getTemplateProperty(i, j, CellUtil.BORDER_BOTTOM));
                }
            }
        }
        pt.drawBorders(a1c3, CellStyle.BORDER_NONE,
                PropertyTemplate.Extent.NONE);
        pt.drawBorders(a1c3, CellStyle.BORDER_MEDIUM,
                PropertyTemplate.Extent.OUTSIDE_HORIZONTAL);
        for (int i = 0; i <= 2; i++) {
            for (int j = 0; j <= 2; j++) {
                if (i == 0) {
                    assertEquals(1, pt.getNumBorders(i, j));
                    assertEquals(CellStyle.BORDER_MEDIUM,
                            pt.getTemplateProperty(i, j, CellUtil.BORDER_TOP));
                } else if (i == 2) {
                    assertEquals(1, pt.getNumBorders(i, j));
                    assertEquals(CellStyle.BORDER_MEDIUM, pt
                            .getTemplateProperty(i, j, CellUtil.BORDER_BOTTOM));
                } else {
                    assertEquals(0, pt.getNumBorders(i, j));
                }
            }
        }
        pt.drawBorders(a1c3, CellStyle.BORDER_NONE,
                PropertyTemplate.Extent.NONE);
        pt.drawBorders(a1c3, CellStyle.BORDER_MEDIUM,
                PropertyTemplate.Extent.VERTICAL);
        for (int i = 0; i <= 2; i++) {
            for (int j = 0; j <= 2; j++) {
                assertEquals(2, pt.getNumBorders(i, j));
                assertEquals(CellStyle.BORDER_MEDIUM,
                        pt.getTemplateProperty(i, j, CellUtil.BORDER_LEFT));
                assertEquals(CellStyle.BORDER_MEDIUM,
                        pt.getTemplateProperty(i, j, CellUtil.BORDER_RIGHT));
            }
        }
        pt.drawBorders(a1c3, CellStyle.BORDER_NONE,
                PropertyTemplate.Extent.NONE);
        pt.drawBorders(a1c3, CellStyle.BORDER_MEDIUM,
                PropertyTemplate.Extent.INSIDE_VERTICAL);
        for (int i = 0; i <= 2; i++) {
            for (int j = 0; j <= 2; j++) {
                if (j == 0) {
                    assertEquals(1, pt.getNumBorders(i, j));
                    assertEquals(CellStyle.BORDER_MEDIUM, pt
                            .getTemplateProperty(i, j, CellUtil.BORDER_RIGHT));
                } else if (j == 2) {
                    assertEquals(1, pt.getNumBorders(i, j));
                    assertEquals(CellStyle.BORDER_MEDIUM,
                            pt.getTemplateProperty(i, j, CellUtil.BORDER_LEFT));
                } else {
                    assertEquals(2, pt.getNumBorders(i, j));
                    assertEquals(CellStyle.BORDER_MEDIUM,
                            pt.getTemplateProperty(i, j, CellUtil.BORDER_LEFT));
                    assertEquals(CellStyle.BORDER_MEDIUM, pt
                            .getTemplateProperty(i, j, CellUtil.BORDER_RIGHT));
                }
            }
        }
        pt.drawBorders(a1c3, CellStyle.BORDER_NONE,
                PropertyTemplate.Extent.NONE);
        pt.drawBorders(a1c3, CellStyle.BORDER_MEDIUM,
                PropertyTemplate.Extent.OUTSIDE_VERTICAL);
        for (int i = 0; i <= 2; i++) {
            for (int j = 0; j <= 2; j++) {
                if (j == 0) {
                    assertEquals(1, pt.getNumBorders(i, j));
                    assertEquals(CellStyle.BORDER_MEDIUM,
                            pt.getTemplateProperty(i, j, CellUtil.BORDER_LEFT));
                } else if (j == 2) {
                    assertEquals(1, pt.getNumBorders(i, j));
                    assertEquals(CellStyle.BORDER_MEDIUM, pt
                            .getTemplateProperty(i, j, CellUtil.BORDER_RIGHT));
                } else {
                    assertEquals(0, pt.getNumBorders(i, j));
                }
            }
        }
    }

