	public void testWriteReadProperties() throws Exception {
		ByteArrayOutputStream baos = new ByteArrayOutputStream();

		// Write them out
		NPOIFSFileSystem outFS = new NPOIFSFileSystem();
		doc.readProperties();
		doc.writeProperties(outFS);
		outFS.writeFilesystem(baos);

		// Create a new version
		ByteArrayInputStream bais = new ByteArrayInputStream(baos.toByteArray());
		POIFSFileSystem inFS = new POIFSFileSystem(bais);

		// Check they're still there
		doc.directory = inFS.getRoot();
		doc.readProperties();

		// Delegate test
		testReadProperties();
	}

