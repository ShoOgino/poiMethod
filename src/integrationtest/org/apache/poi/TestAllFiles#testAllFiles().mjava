    @Test
    public void testAllFiles() throws Exception {
		assertNotNull("Unknown file extension for file: " + file + ": " + getExtension(file), handler);
		InputStream stream = new BufferedInputStream(new FileInputStream(new File("test-data", file)),100);
		try {
			handler.handleFile(stream);
			
			assertFalse("Expected to fail for file " + file + " and handler " + handler + ", but did not fail!", 
			        EXPECTED_FAILURES.contains(file));
		} catch (Exception e) {
		    // check if we expect failure for this file
			if(!EXPECTED_FAILURES.contains(file)) {
			    throw new Exception("While handling " + file, e);
			}
		} finally {
			stream.close();
		}
	}

