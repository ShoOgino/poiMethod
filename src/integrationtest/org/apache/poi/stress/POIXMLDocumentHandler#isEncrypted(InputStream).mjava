    protected static boolean isEncrypted(InputStream stream) throws IOException {
        if (POIFSFileSystem.hasPOIFSHeader(stream)) {
            POIFSFileSystem poifs = new POIFSFileSystem(stream);
            try {
                if (poifs.getRoot().hasEntry(Decryptor.DEFAULT_POIFS_ENTRY)) {
                    return true;
                }
            } finally {
                poifs.close();
            }
            throw new IOException("Wrong file format or file extension for OO XML file");
        }
        return false;
    }

