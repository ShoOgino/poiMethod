    protected static boolean isEncrypted(InputStream stream) throws IOException {
        if (POIFSFileSystem.hasPOIFSHeader(stream)) {
            POIFSFileSystem poifs = new POIFSFileSystem(stream);
            if (poifs.getRoot().hasEntry(Decryptor.DEFAULT_POIFS_ENTRY)) {
                return true;
            }
            throw new IOException("wrong file format or file extension for OO XML file");
        }
        return false;
    }

