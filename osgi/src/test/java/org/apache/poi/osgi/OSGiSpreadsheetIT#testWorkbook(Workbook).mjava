    // create a workbook, validate and write back
    void testWorkbook(Workbook wb) throws Exception {
        logger.info("testing " + wb.getClass().getSimpleName());

        Sheet s = wb.createSheet("OSGi");
        s.createRow(0).createCell(0).setCellValue("With OSGi");

        ByteArrayOutputStream baos = new ByteArrayOutputStream();
        wb.write(baos);
        ByteArrayInputStream bais = new ByteArrayInputStream(baos.toByteArray());

        if(wb instanceof HSSFWorkbook)
            wb = new HSSFWorkbook(bais);
        else
            wb = new XSSFWorkbook(bais);
        assertEquals(1, wb.getNumberOfSheets());

        s = wb.getSheet("OSGi");
        assertEquals("With OSGi", s.getRow(0).getCell(0).toString());


    }

