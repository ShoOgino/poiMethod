    /**
     * Escape a string for writing to a property file.
     * This is a simplistic version of the Properties.store() escaping.
     */
    public static String escapeProperty(String s)
    {
        int len = s.length();
        StringBuffer buf = new StringBuffer(len * 2);

        for (int i = 0; i < len; ++i)
        {
            char c = s.charAt(i);

            switch (c)
            {
                case '\t':
                    buf.append('\\').append('t');
                    break;
                case '\n':
                    buf.append('\\').append('n');
                    break;
                case '\r':
                    buf.append('\\').append('r');
                    break;
                case '\f':
                    buf.append('\\').append('f');
                    break;

                case '\\':
                case ' ':
                case '=':
                case ':':
                case '#':
                case '!':
                    buf.append('\\').append(c);
                    break;

                default:
                    if ((c < 0x0020) || (c > 0x007e))
                    {
                        buf.append('\\');
                        buf.append('u');
                        buf.append(toHex((c >> 12) & 0xF));
                        buf.append(toHex((c >> 8) & 0xF));
                        buf.append(toHex((c >> 4) & 0xF));
                        buf.append(toHex(c & 0xF));
                    } else
                    {
                        buf.append(c);
                    }
            }
        }

        return buf.toString();
    }

