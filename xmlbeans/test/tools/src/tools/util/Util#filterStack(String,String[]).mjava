    /**
     * Helper for the {@link #getFilteredStackTrace(java.lang.Throwable)}
     * method.
     *
     * @param stack   A stack trace as a String.
     * @param filters Set of custom filters where each filter is
     *                the beginning of a class name.
     * @return The filtered stack trace as a String.
     */
    public static String filterStack(String stack, String[] filters)
    {
        if (!isFilteredStackTrace())
            return stack;

        StringWriter sw = new StringWriter();
        PrintWriter pw = new PrintWriter(sw);
        BufferedReader br = new BufferedReader(new StringReader(stack));

        String line;

        try
        {
            while ((line = br.readLine()) != null)
            {
                if (!isFiltered(line, filters))
                {
                    pw.println(line);
                }
            }
        }
        catch (Exception e)
        {
            return stack;
        }

        return sw.toString();
    }

