    /**
     * scanblocks - Finds the beginnings and lengths of blocks of matches.
     * Sets the blocklen array (see definition).
     * Expects oldinfo valid.
     */
    void scanblocks()
    {
        int oldline, newline;
        int oldfront = 0;      // line# of front of a block in old, or 0
        int newlast = -1;      // newline's value during prev. iteration

        for (oldline = 1; oldline <= oldinfo.maxLine; oldline++)
            blocklen[oldline] = 0;
        blocklen[oldinfo.maxLine + 1] = UNREAL; // starts a mythical blk

        for (oldline = 1; oldline <= oldinfo.maxLine; oldline++)
        {
            newline = oldinfo.other[oldline];
            if (newline < 0)
                oldfront = 0;  /* no match: not in block */
            else
            {                                   /* match. */
                if (oldfront == 0) oldfront = oldline;
                if (newline != (newlast + 1)) oldfront = oldline;
                ++blocklen[oldfront];
            }
            newlast = newline;
        }
    }

