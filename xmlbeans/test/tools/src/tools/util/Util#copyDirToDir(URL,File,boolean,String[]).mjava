    /**
     * Copy a dir url to a new dir.
     */
    public static void copyDirToDir(URL url, File toDir,
                                    boolean replaceNewer, String[] exclude)
            throws IOException
    {
        Log.debug("copyDirToDir(url=" + url + ", toDir=" + toDir + ")");

        // url must end in '/'
        if (!url.getFile().endsWith("/"))
            return;

        if ("file".equals(url.getProtocol()))
        {
            copyDirToDir(new File(url.getPath()), toDir,
                         replaceNewer, exclude);
        } else if ("jar".equals(url.getProtocol()))
        {
            JarURLConnection conn = (JarURLConnection) url.openConnection();
            copyDirToDir(conn.getJarFile(), conn.getEntryName(),
                         toDir, replaceNewer, exclude);
        } else if ("zip".equals(url.getProtocol()))
        {
            URL newUrl = new URL("jar:file:" + url.getPath());
            Log.debug("changed zip url to = " + newUrl);

            copyDirToDir(newUrl, toDir, replaceNewer, exclude);
        } else
        {
            throw new IOException("Protocol not supported yet: " +
                                  url.getProtocol());
        }
    }

