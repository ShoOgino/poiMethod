  private int run() throws Exception
  {
    // create the purchase order
    PurchaseOrderDocument podoc = PurchaseOrderDocument.Factory.newInstance();
    PurchaseOrder po = podoc.addNewPurchaseOrder();

    // create and initialize customer
    Customer customer = po.addNewCustomer();
    customer.setName(Constants.PO_CUSTOMER_NAME);
    customer.setAddress(Constants.PO_CUSTOMER_ADDR);

    // set the date
    po.setDate(Calendar.getInstance());

    // create and initialize the line item array
    for (int i=0; i<Constants.PO_NUM_LINEITEMS; i++)
    {
      LineItem li = po.addNewLineItem();
      li.setDescription(Constants.PO_LI_DESC);
      li.setPerUnitOunces(Constants.PO_LI_PUO);
      li.setPrice(Constants.PO_LI_PRICE);
      li.setQuantity(Constants.PO_LI_QUANTITY);
    }

    // create and initialize the shipper
    Shipper shipper = po.addNewShipper();
    shipper.setName(Constants.PO_SHIPPER_NAME);
    shipper.setPerOunceRate(Constants.PO_SHIPPER_POR);

    // calculate a hash to return
    int hash = ( po.getLineItemArray().length ) * 17;
    return hash;
  }

