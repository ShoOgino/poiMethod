  private int run() throws Exception 
  {
    
    // create the document
    DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();
    factory.setNamespaceAware(true);
    factory.setValidating(false);
    DocumentBuilder builder = factory.newDocumentBuilder();
    Document doc = builder.newDocument();

    // create the purchase order element
    Element po = doc.createElementNS(Constants.PO_NS,"po:purchase-order");

    // create the customer element
    Element customer = doc.createElementNS(Constants.PO_NS,"po:customer");

    // create the customer name element and add to customer
    Element name = doc.createElementNS(Constants.PO_NS,"po:name");
    Node tCustName = doc.createTextNode(Constants.PO_CUSTOMER_NAME);
    name.appendChild(tCustName);
    customer.appendChild(name);

    // create the customer address element and add to customer
    Element address = doc.createElementNS(Constants.PO_NS,"po:address");
    Node tCustAddr = doc.createTextNode(Constants.PO_CUSTOMER_ADDR);
    address.appendChild(tCustAddr);
    customer.appendChild(address);

    // add the customer to the po
    po.appendChild(customer);

    // create the date element and add it to the po
    Element date = doc.createElementNS(Constants.PO_NS,"po:date");
    Node tDate = doc.createTextNode(Constants.PO_DATE_STRING);
    date.appendChild(tDate);
    po.appendChild(date);

    // create and add the line item elements
    for(int i=0; i<Constants.PO_NUM_LINEITEMS; i++)
    {
      Element li = doc.createElementNS(Constants.PO_NS,"po:line-item");

      // description
      Element desc = doc.createElementNS(Constants.PO_NS,"po:description");
      Node tDesc = doc.createTextNode(Constants.PO_LI_DESC);
      desc.appendChild(tDesc);
      li.appendChild(desc);

      // per-unit-ounces
      Element puo = doc.createElementNS(Constants.PO_NS,"po:per-unit-ounces");
      Node tPuo = doc.createTextNode(Constants.PO_LI_PUO_STRING);
      puo.appendChild(tPuo);
      li.appendChild(puo);

      // price
      Element price = doc.createElementNS(Constants.PO_NS,"po:price");
      Node tPrice = doc.createTextNode(Constants.PO_LI_PRICE_STRING);
      price.appendChild(tPrice);
      li.appendChild(price);

      // quantity
      Element quantity = doc.createElementNS(Constants.PO_NS,"po:quantity");
      Node tQuantity = doc.createTextNode(Constants.PO_LI_QUANTITY_STRING);
      quantity.appendChild(tQuantity);
      li.appendChild(quantity);

      // add the line-item to the po
      po.appendChild(li);
    }

    // create and add the shipper
    Element shipper = doc.createElementNS(Constants.PO_NS,"po:shipper");
    Element shipperName = doc.createElementNS(Constants.PO_NS,"po:name");
    Node tShipperName = doc.createTextNode(Constants.PO_SHIPPER_NAME);
    shipperName.appendChild(tShipperName);
    shipper.appendChild(shipperName);
    Element perouncerate = doc.createElementNS(Constants.PO_NS,"po:per-ounce-rate");
    Node tPerOunceRate = doc.createTextNode(Constants.PO_SHIPPER_POR_STRING);
    perouncerate.appendChild(tPerOunceRate);
    shipper.appendChild(perouncerate);

    // create the hash to return
    int hash = ( po.getElementsByTagNameNS(Constants.PO_NS, "line-item").getLength() ) * 17;
    return hash;
  }

