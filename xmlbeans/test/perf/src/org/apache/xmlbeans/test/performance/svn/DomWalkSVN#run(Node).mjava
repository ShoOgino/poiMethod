  private int run(Node p_node)
  {
    int result = 0;
    short type = p_node.getNodeType();

    if(type == Node.ATTRIBUTE_NODE ||
       type == Node.CDATA_SECTION_NODE ||
       type == Node.TEXT_NODE)
    {
      result = p_node.getNodeValue().length();
    }
    else
    {
      result = p_node.getNodeName().length();
    }
    
    Node child = p_node.getFirstChild();
    while(null != child)
    {
      result += run(child);
      child = child.getNextSibling();
    }
    return result;
  }

