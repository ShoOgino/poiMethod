  public static void main(String[] args) throws Exception
  {
  	int interval = Constants.MEM_INTERVAL;
  	long memory = Runtime.getRuntime().maxMemory();
  	int size = 0;
  	int hash = 0;
    String flavor = null;

    if(args.length == 0)
      flavor = "deep-attributes";
    else
      flavor = args[0];

    MaxMemUntypedBisLoadV2 test = new MaxMemUntypedBisLoadV2();
    PerfUtil util = new PerfUtil();
    
    try
    {
    	System.gc();
    	// infinite for loop - go until get oom
    	for(int i=1; true; i++)
    	{
    		System.gc();
    		byte[] bytes = util.createXmlDataBytes(flavor,Constants.MEM_INITIALSIZE+(interval*i));
    		hash += test.run(new BufferedInputStream(new ByteArrayInputStream(bytes) ));
    		size = bytes.length;
    	}
    }
    catch (OutOfMemoryError oom)
    {
    	System.gc();
        // Class.getSimpleName() is only provided in jdk1.5, so have to trim package name off test name for logging to support 1.4
        System.out.print(Constants.DELIM+test.getClass().getName().substring(test.getClass().getName().lastIndexOf('.')+1)+" flavor="+flavor+" ");
        System.out.print("hash "+hash+" ");
        System.out.print("memory "+memory+" ");
        System.out.println("size="+size);
    }
  }

