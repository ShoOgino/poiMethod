    public void testThreadedCompilation() throws Throwable {
        CompilationThread[] threads = new CompilationThread[THREAD_COUNT];
        for (int i = 0; i < threads.length; i++) {
            threads[i] = new CompilationThread();
        }

        for (int i = 0; i < threads.length; i++) {
            threads[i].start();
        }

        for (int i = 0; i < threads.length; i++) {
            threads[i].join();
        }

        for (int i = 0; i < threads.length; i++) {
            Assert.assertNull(threads[i].getException());
            Assert.assertTrue("Thread " + i + " didn't succeed",
                    threads[i].getResult());
        }
    }

