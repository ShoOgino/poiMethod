    public void testCharUtil ( ) throws Exception
    {
        RealCharUtil real = new RealCharUtil();
        FakeCharUtil fake = new FakeCharUtil();

        for ( int iter = 0 ; iter < 5000 ; iter++ )
        {
            switch( rnd( 4 ) )
            {
            case 0 :
            {
                String s = randomString();

                real.newText( s );
                fake.newText( s );

                break;
            }

            case 1 :
            {
                Assert.assertTrue( real.numTexts() == fake.numTexts() );

                if (real.numTexts() > 0)
                {
                    int j = rnd( real.numTexts() );

                    Assert.assertTrue( real.getText( j ).equals( fake.getText( j ) ) );
                }
            }
            
            case 2 :
            {
                if (real.numTexts() > 1)
                {
                    int i = rnd( real.numTexts() );
                    int j = rnd( real.numTexts() );
                    int off = rnd( real.length( i ) + 1 );

                    real.insert( i, j, off );
                    fake.insert( i, j, off );
                    
                    Assert.assertTrue( real.getText( i ).equals( fake.getText( i ) ) );
                    Assert.assertTrue( real.getText( j ).equals( fake.getText( j ) ) );
                }
            }
            case 3 :
            {
                int i = rnd( real.numTexts() );
                int l = real.length( i );
                int off = rnd( l + 1 );
                int cch = rnd( l - off + 1 );

                real.remove( i, off, cch );
                fake.remove( i, off, cch );
                
                Assert.assertTrue( real.getText( i ).equals( fake.getText( i ) ) );
            }
            }
        }
    }

