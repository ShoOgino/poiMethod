    private void runAll(XmlObject doc, String[] xpathes)
        throws Exception
    {
        StringBuffer errors = new StringBuffer();
        boolean bFail = false;
        for (int i = 0; i < xpathes.length; i++)
        {
            try
            {
                runXpath2(doc, xpathes[i], i);
            }
            catch (Exception e)
            {
                bFail = true;
                errors.append("**********************Failed at test " + i +
                    "\n  path:" + xpathes[i] + "\n");
//                if (e.getMessage() == null)
//                {
                    StringWriter sw = new StringWriter();
                    e.printStackTrace(new PrintWriter(sw));
                    errors.append(sw);
//                }
//                else
                    errors.append(e.getMessage());
                errors.append("\n\n");
            }
        }

        if (bFail)
            throw new RuntimeException(errors.toString());
    }

