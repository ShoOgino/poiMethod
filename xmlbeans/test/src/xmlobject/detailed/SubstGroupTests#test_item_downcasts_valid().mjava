    public void test_item_downcasts_valid() throws Exception
    {
        BigInteger bInt = new BigInteger("12");
        ArrayList err = new ArrayList();
        XmlOptions opts = new XmlOptions(
                new XmlOptions().setErrorListener(err));

        xmlobject.substgroup.OrderItem order = OrderItem.Factory.newInstance();
        ItemType item = order.addNewItem();

        BeanBagType b2Type = (BeanBagType) item.substitute(
                BeanBagDocument.type.getDocumentElementName(),
                BeanBagType.type);

        BeanBagSizeType bbSize = b2Type.addNewSize();
        bbSize.setColor("Blue");
        bbSize.setStringValue("Blue");
        b2Type.setSku(bInt);
        b2Type.setSize(bbSize);
        b2Type.setName("BeanBagType");

        ItemType nItem = order.getItem();

        //nItem.validate(opts);
        if (!nItem.validate(opts))
            System.out.println(
                    "nItem - Downcasting Failed Validation:\n" + err);
        err.clear();

        item = (ItemType) nItem.substitute(
                ItemDocument.type.getDocumentElementName(),
                ItemType.type);

        //System.out.println("Item1: " + item.xmlText());

        if (!item.validate(opts))
            System.out.println("Item - Downcasting Failed Validation:\n" + err);

        XmlError[] xErr = getXmlErrors(err);
        Assert.assertTrue("Length of xm_errors was greater than expected",
                xErr.length == 1);
        Assert.assertTrue("Error Code was not as Expected",
                xErr[0].getErrorCode().compareTo("cvc-complex-type.2.4b") == 0);
        err.clear();

        String nName = "ItemType";
        item.setName(nName);
        System.out.println("Item2: " + item.xmlText());

        if (!order.validate(opts))
            System.out.println(
                    "Order - Downcasting Failed Validation:\n" + err);

        //Check value was set
        if (!(nName.compareTo(order.getItem().getName()) == 0))
            throw new Exception("Name Value was not changed");

        //Check Error message
        String expText = "Element not allowed: size in element item@http://xmlobject/substgroup";
        XmlError[] xErr2 = getXmlErrors(err);
        Assert.assertTrue("Length of xm_errors was greater than expected",
                xErr2.length == 1);
        Assert.assertTrue("Error Code was not as Expected",
                xErr2[0].getErrorCode().compareTo("cvc-complex-type.2.4b") ==
                0);
        Assert.assertTrue("Error Message was not as expected",
                xErr2[0].getMessage().compareTo(expText) == 0);

        err.clear();
    }

