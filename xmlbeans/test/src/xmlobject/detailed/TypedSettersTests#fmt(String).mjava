    private static final String fmt ( String s )
    {
        StringBuffer sb = new StringBuffer();

        for ( int i = 0 ; i < s.length() ; i++ )
        {
            char ch = s.charAt( i );

            if (ch != '$')
            {
                sb.append( ch );
                continue;
            }
            
            ch = s.charAt( ++i );

            String id = "";

            while ( (ch >= 'a' && ch <= 'z') || (ch >= 'A' && ch <= 'Z'))
            {
                id = id + ch;
                ch = s.charAt( ++i );
            }

            String arg = "";

            if (ch == '(')
            {
                ch = s.charAt( ++i );

                while ( ch != ')' )
                {
                    arg += ch;
                    ch = s.charAt( ++i );
                }
            }
            else
                i--;

            if (id.equals( "schema" ))
                sb.append( schemaNs );
            else if (id.equals( "xsi" ))
                sb.append( instanceNs );
            else if (id.equals( "type" ))
            {
                Assert.assertTrue( arg.length() > 0 );
                sb.append( "xsi:type=\"" + arg + "\"" );
            }
            else
                Assert.assertTrue( false );
        }

        return sb.toString();
    }

