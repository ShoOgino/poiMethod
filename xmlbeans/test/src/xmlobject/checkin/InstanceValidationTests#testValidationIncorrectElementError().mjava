    public void testValidationIncorrectElementError() throws XmlException
    {
        StringBuffer empSchema = new StringBuffer();

        empSchema.append("<xs:schema xmlns:xs='http://www.w3.org/2001/XMLSchema'   elementFormDefault='qualified'>\n");
        empSchema.append("<xs:element name='age'>\n");
        empSchema.append("<xs:simpleType>\n");
        empSchema.append("<xs:restriction base='xs:integer'>\n");
        empSchema.append("<xs:minInclusive value='0'/>\n");
        empSchema.append("<xs:maxInclusive value='100'/>\n");
        empSchema.append("</xs:restriction>\n");
        empSchema.append("</xs:simpleType>\n");
        empSchema.append("</xs:element>\n");
        empSchema.append("<xs:element name='empRecords'>\n");
        empSchema.append("<xs:complexType>\n");
        empSchema.append("<xs:sequence>\n");
        empSchema.append("<xs:element name='person' type='personType' maxOccurs='unbounded'/>\n");
        empSchema.append("</xs:sequence>\n");
        empSchema.append("</xs:complexType>\n");
        empSchema.append("</xs:element>\n");
        empSchema.append("<xs:element name='name' type='xs:string'/>\n");
        empSchema.append("<xs:complexType name='personType'>\n");
        empSchema.append("<xs:sequence>\n");
        empSchema.append("<xs:element ref='name'/>\n");
        empSchema.append("<xs:element ref='age'/>\n");
        empSchema.append("</xs:sequence>\n");
        empSchema.append("<xs:attribute name='employee' use='required'>\n");
        empSchema.append("<xs:simpleType>\n");
        empSchema.append("<xs:restriction base='xs:NMTOKEN'>\n");
        empSchema.append("<xs:enumeration value='current'/>\n");
        empSchema.append("<xs:enumeration value='past'/>\n");
        empSchema.append("</xs:restriction>\n");
        empSchema.append("</xs:simpleType>\n");
        empSchema.append("</xs:attribute>\n");
        empSchema.append("</xs:complexType>\n");
        empSchema.append("</xs:schema>\n");

        StringBuffer xmlInstance = new StringBuffer();
        xmlInstance.append("<empRecords xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' >");
        xmlInstance.append("<person employee='past'>");
        //xmlInstance.append("<name>joe blow</name>");
        xmlInstance.append("<age>31</age>");
        xmlInstance.append("</person>");
        xmlInstance.append("<person employee='current'>");
        xmlInstance.append("<name>test user</name>");
        xmlInstance.append("<age>29</age>");
        xmlInstance.append("</person>");
        xmlInstance.append("</empRecords>");

        String[] schemas = {empSchema.toString()};

        List errors = null;

        errors = performValidation(schemas, null, xmlInstance.toString(), true);
        Assert.assertTrue(errors != null);
        Assert.assertTrue(errors.size()>0);

        Iterator it = errors.iterator();
        Assert.assertTrue(it.hasNext());

        XmlValidationError xmlValError = (XmlValidationError) it.next();
        Assert.assertEquals(XmlValidationError.INCORRECT_ELEMENT, xmlValError.getErrorType());
        Assert.assertEquals("personType", xmlValError.getBadSchemaType().getName().getLocalPart());
        // todo debug this Assert.assertEquals(xmlValError.getOffendingQName().getLocalPart(), "age");
        Assert.assertEquals("Expected element 'name' instead of 'age' here in element person", xmlValError.getMessage());

        Assert.assertTrue(it.hasNext());

        xmlValError = (XmlValidationError) it.next();
        Assert.assertEquals(XmlValidationError.INCORRECT_ELEMENT, xmlValError.getErrorType());
        Assert.assertEquals("personType", xmlValError.getBadSchemaType().getName().getLocalPart());
        // todo debug this Assert.assertEquals(xmlValError.getOffendingQName().getLocalPart(), "age");
        Assert.assertEquals("Expected element 'name' before the end of the content in element person", xmlValError.getMessage());
    }

