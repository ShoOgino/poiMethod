    public boolean checkContent(String fragment,
                                 SchemaType type,
                                 boolean printErrors)
            throws Exception
    {
        XMLStreamReader xsr = XMLInputFactory.newInstance().
                              createXMLStreamReader(new StringReader(fragment));

        XmlContentTestXSR cxsr = new XmlContentTestXSR(xsr);
        Collection errors = new ArrayList();

        ValidatingXMLStreamReader valXsr = new ValidatingXMLStreamReader();
        valXsr.init(cxsr,
                    false,
                    type,
                    XmlBeans.typeLoaderForClassLoader(ValidatingXMLStreamReader.class.getClassLoader()),
                    null,
                    errors);

        // Walk through the xml
        while (valXsr.hasNext())
            valXsr.next();

        if (!valXsr.isValid())
        {
            if (printErrors)
                tools.xml.Utils.printXMLErrors(errors);
            return false;
        }
        return true;
    }

