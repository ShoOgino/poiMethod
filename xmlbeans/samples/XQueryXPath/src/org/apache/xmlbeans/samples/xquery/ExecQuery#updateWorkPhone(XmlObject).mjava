    /**
     * Uses XQuery to retrieve work <phone> elements from the incoming XML, then
     * changes the number in the results.
     * 
     * This method demonstrates the following characteristics of the execQuery method: 
     * 
     * - it supports XQuery.
     * - the XML it returns is a copy of the XML queried against; contrast this with
     * the selectPath method, which returns a portion of the original document.
     * Changes to returned XML do not impact the XML queried against. 
     * - execQuery called from an XmlCursor returns a cursor positioned at
     * the STARTDOC token of a new XML fragment. Contrast this with the 
     * XmlCursor.selectPath method, which stores results as "selections" in 
     * the cursor used to execute the query.
     * 
     * @param empDoc The incoming XML.
     * @return <code>true</code> if the XPath expression returned results;
     * otherwise, <code>false</code>.
     */
    public boolean updateWorkPhone(XmlObject empDoc)
    {
        boolean hasResults = false;
        
        // A cursor instance to query with.
        XmlCursor empCursor = empDoc.newCursor();

        // The expression: Get the <employee> elements with <state> elements whose
        // value is "WA".
        String queryExpression =
                "for $e in $this/xq:employees/xq:employee " +
                "let $s := $e/xq:address/xq:state " +
                "where $s = 'WA' " +
                "return $e//xq:phone[@location='work']";

        // Execute the query. Results, if any, will be available at 
        // the position of the resultCursor in a new XML document.
        XmlCursor resultCursor = 
            empCursor.execQuery(m_namespaceDeclaration + queryExpression);
        
        System.out.println("The query results, <phone> element copies made " +
        		"from the received document: \n");
        System.out.println(resultCursor.getObject().toString() + "\n");
        
        // If there are results, the results will be children of the fragment root
        // where the new cursor is positioned. This statement tests for children
        // and moves the cursor if to the first if it exists.
        if (resultCursor.toFirstChild())
        {
            hasResults = true;
	        // Use the cursor to loop through the results, printing each sibling
	        // <employee> element returned by the query.
	        int i = 0;
	        do 
	        {
	            // Change the phone numbers.
	            XmlCursor editCursor = resultCursor.newCursor();
	            editCursor.toLastAttribute();
	            editCursor.toNextToken();
	            editCursor.removeXml();
	            editCursor.insertChars("(206)555-1234");
	        } while (resultCursor.toNextSibling());

	        resultCursor.toStartDoc();
	        System.out.println("The query results after changes: \n");
	        System.out.println(resultCursor.getObject().toString() + "\n");

    			System.out.println("The received document -- note that it is unchanged. " +
            		"Changes were made to the copy created by the execQuery method. \n");
    			System.out.println(empDoc + "\n");
        }
        return hasResults;
    }

