    private String sniffForXmlDecl() throws IOException
    {
        mark(MAX_SNIFFED_CHARS);
        try
        {
            char[] buf = new char[MAX_SNIFFED_CHARS];
            int limit = readAsMuchAsPossible(buf, 0, MAX_SNIFFED_CHARS);
            return SniffedXmlInputStream.extractXmlDeclEncoding(buf, 0, limit);
        }
        finally
        {
            reset();
        }
    }

