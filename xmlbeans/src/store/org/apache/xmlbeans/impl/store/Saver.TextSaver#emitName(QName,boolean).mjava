        private void emitName ( QName name, boolean needsPrefix )
        {
            assert name != null;

            String uri = name.getNamespaceURI();

            assert uri != null;

            if (uri.length() != 0)
            {
                String prefix = name.getPrefix();
                String mappedUri = getNamespaceForPrefix( prefix );

                if (mappedUri == null || !mappedUri.equals( uri ))
                    prefix = getUriMapping( uri );

                // Attrs need a prefix.  If I have not found one, then there must be a default
                // prefix obscuring the prefix needed for this attr.  Find it manually.

                // NOTE - Consider keeping the currently mapped default URI separate fromn the
                // _urpMap and _prefixMap.  This way, I would not have to look it up manually
                // here

                if (needsPrefix && prefix.length() == 0)
                    prefix = getNonDefaultUriMapping( uri );

                if (prefix.length() > 0)
                {
                    emit( prefix );
                    emit( ':' );
                }
            }

            assert name.getLocalPart().length() > 0;

            emit( name.getLocalPart() );
        }

