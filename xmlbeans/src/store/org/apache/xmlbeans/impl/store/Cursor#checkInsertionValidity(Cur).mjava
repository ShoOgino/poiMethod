    private void checkInsertionValidity(Cur that) {
        int thatKind = that.kind();

        if (thatKind < 0)
            complain("Can't move/copy/insert an end token.");

        if (thatKind == ROOT)
            complain("Can't move/copy/insert a whole document.");

        int thisKind = _cur.kind();

        if (thisKind == ROOT)
            complain("Can't insert before the start of the document.");

        if (thatKind == ATTR) {
            _cur.push();
            _cur.prevWithAttrs();
            int pk = _cur.kind();
            _cur.pop();

            if (pk != ELEM && pk != ROOT && pk != -ATTR) {
                complain("Can only insert attributes before other attributes or after containers.");
            }
        }

        if (thisKind == ATTR && thatKind != ATTR)
            complain("Can only insert attributes before other attributes or after containers.");
    }

