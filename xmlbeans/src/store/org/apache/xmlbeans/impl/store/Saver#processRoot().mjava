    private final void processRoot ( )
    {
        assert _cur.isRoot();

        XmlDocumentProperties props = _cur.getDocProps();
        String systemId = null;
        String docTypeName = null;
        if (props != null)
        {
            systemId = props.getDoctypeSystemId();
            docTypeName = props.getDoctypeName();
        }

        if (systemId != null || docTypeName != null)
        {
            if (docTypeName == null)
            {
                _cur.push();
                while (!_cur.isElem() && _cur.next())
                    ;
                if (_cur.isElem())
                    docTypeName = _cur.getName().getLocalPart();
                _cur.pop();
            }

            String publicId = props.getDoctypePublicId();

            if (docTypeName != null)
            {
                QName rootElemName = _cur.getName();

                if ( rootElemName == null )
                {
                    _cur.push();
                    while ( !_cur.isFinish() )
                    {
                        if (_cur.isElem())
                        {
                            rootElemName = _cur.getName();
                            break;
                        }
                        _cur.next();
                    }
                    _cur.pop();
                }

                if ( rootElemName!=null && docTypeName.equals(rootElemName.getLocalPart()) )
                {
                    emitDocType( docTypeName, publicId, systemId );
                    return;
                }
            }
        }

        emitStartDoc(_cur);
    }

