        public static CharNode insertNode ( CharNode nodes, CharNode newNode, CharNode before )
        {
            assert !isOnList( nodes, newNode );
            assert before == null || isOnList( nodes, before );
            assert newNode != null;
            assert newNode._prev == null && newNode._next == null;

            if (nodes == null)
            {
                assert before == null;
                nodes = newNode;
            }
            else if (nodes == before)
            {
                nodes._prev = newNode;
                newNode._next = nodes;
                nodes = newNode;
            }
            else
            {
                CharNode n = nodes;

                while ( n._next != before )
                    n = n._next;

                if ((newNode._next = n._next) != null)
                    n._next._prev = newNode;

                newNode._prev = n;
                n._next = newNode;
            }

            return nodes;
        }

