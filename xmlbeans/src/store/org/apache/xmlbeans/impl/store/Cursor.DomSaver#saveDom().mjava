        Node saveDom() {
            Locale l = Locale.getLocale(_stl, _options);

            l.enter();

            try {
                _nodeCur = l.getCur();  // Not weak or temp

                // Build the tree
                
                while (process())
                    ;

                // Set the type

                while (!_nodeCur.isRoot())
                    _nodeCur.toParent();

                if (_type != null)
                    _nodeCur.setType(_type);

                Node node = (Node) _nodeCur.getDom();

                _nodeCur.release();

                _nodeCur = null;

                return node;
            } finally {
                l.exit();
            }
        }

