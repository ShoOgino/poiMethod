        boolean next ( )
        {
            switch ( _state )
            {
            case ROOT_START :
            {
                _state = _elem == null ? CUR : ELEM_START;
                break;
            }

            case ELEM_START :
            {
                if (_saveAttr)
                    _state = ELEM_END;
                else
                {
                    if (_cur.isAttr())
                    {
                        _cur.toParent();
                        _cur.next();
                    }

                    if (_cur.isSamePos( _end ))
                        _state = ELEM_END;
                    else
                        _state = CUR;
                }

                break;
            }

            case CUR :
            {
                assert !_cur.isAttr();

                _cur.next();

                if (_cur.isSamePos( _end ))
                    _state = _elem == null ? ROOT_END : ELEM_END;

                break;
            }

            case ELEM_END :
            {
                _state = ROOT_END;
                break;
            }
            case ROOT_END :
                return false;
            }

            return true;
        }

