    void release ( )
    {
        if (_tempFrame >= 0)
        {
            if (_nextTemp != null)
                _nextTemp._prevTemp = _prevTemp;

            if (_prevTemp == null)
                _locale._tempFrames[ _tempFrame ] = _nextTemp;
            else
                _prevTemp._nextTemp = _nextTemp;

            _prevTemp = _nextTemp = null;
            _tempFrame = -1;
        }

        if (_state != POOLED && _state != DISPOSED)
        {
            // Clean up any state

            while ( _stackTop != -1 )
                popButStay();

            clearSelection();

            _id = null;

            // Unposition

            moveToCur( null );

            assert isNormal();

            assert _xobj == null;
            assert _pos  == NO_POS;

            // Release weak reference and attacked value

            if (_ref != null)
            {
                _ref.clear();
                _ref._cur = null;
            }

            _ref = null;

            // Unregister and either diapose of cursor or add it back to pool

            assert _state == REGISTERED;
            _locale._registered = listRemove( _locale._registered );

            if (_locale._curPoolCount < 16)
            {
                _locale._curPool = listInsert( _locale._curPool );
                _state = POOLED;
                _locale._curPoolCount++;
            }
            else
            {
                _locale = null;
                _state = DISPOSED;
            }
        }
    }

