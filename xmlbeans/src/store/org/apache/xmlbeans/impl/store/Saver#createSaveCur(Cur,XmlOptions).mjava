    private static SaveCur createSaveCur ( Cur c, XmlOptions options )
    {
        QName synthName = (QName) options.get( XmlOptions.SAVE_SYNTHETIC_DOCUMENT_ELEMENT );

        QName fragName = synthName;

        if (fragName == null)
        {
            fragName =
                options.hasOption( XmlOptions.SAVE_USE_OPEN_FRAGMENT )
                    ? Locale._openuriFragment
                    : Locale._xmlFragment;
        }

        boolean saveInner =
            options.hasOption( XmlOptions.SAVE_INNER ) &&
                !options.hasOption( XmlOptions.SAVE_OUTER );

        Cur start = c.tempCur();
        Cur end   = c.tempCur();

        SaveCur cur = null;

        int k = c.kind();

        switch ( k )
        {
        case ROOT :
        {
            positionToInner( c, start, end );

            if (Locale.isFragment( start, end ))
                cur = new FragSaveCur( start, end, fragName );
            else if (synthName != null)
                cur = new FragSaveCur( start, end, synthName );
            else
                cur = new DocSaveCur( c );

            break;
        }

        case ELEM :
        {
            if (saveInner)
            {
                positionToInner( c, start, end );

                cur =
                    new FragSaveCur(
                        start, end, Locale.isFragment( start, end ) ? fragName : synthName );
            }
            else if (synthName != null)
            {
                positionToInner( c, start, end );

                cur = new FragSaveCur( start, end, synthName );
            }
            else
            {
                start.moveToCur( c );
                end.moveToCur( c );
                end.skip();

                cur = new FragSaveCur( start, end, null );
            }

            break;
        }
        }

        if (cur == null)
        {
            assert k < 0 || k == ATTR || k == COMMENT || k == PROCINST || k == TEXT;

            if (k < 0)
            {
                // Save out ""
                start.moveToCur( c );
                end.moveToCur( c );
            }
            else if (k == TEXT)
            {
                start.moveToCur( c );
                end.moveToCur( c );
                end.next();
            }
            else if (saveInner)
            {
                start.moveToCur( c );
                start.next();

                end.moveToCur( c );
                end.toEnd();
            }
            else if (k == ATTR)
            {
                start.moveToCur( c );
                end.moveToCur( c );
            }
            else
            {
                assert k == COMMENT || k == PROCINST;

                start.moveToCur( c );
                end.moveToCur( c );
                end.skip();
            }

            cur = new FragSaveCur( start, end, fragName );
        }

        String filterPI = (String) options.get( XmlOptions.SAVE_FILTER_PROCINST );

        if (filterPI != null)
            cur = new FilterPiSaveCur( cur, filterPI );

        if (options.hasOption( XmlOptions.SAVE_PRETTY_PRINT ))
            cur = new PrettySaveCur( cur, options );

        start.release();
        end.release();

        return cur;
    }

