        private void entitizeAndWriteCommentText ( int bufLimit )
        {
            boolean lastWasDash = false;

            for ( int i=0 ; i<bufLimit ; i++ )
            {
                char ch = _buf[ i ];

                if (isBadChar( ch ))
                    _buf[i] = '?';
                else if (ch == '-')
                {
                    if (lastWasDash)
                    {
                        // Replace "--" with "- " to make well formed
                        _buf[i] = ' ';
                        lastWasDash = false;
                    }
                    else
                    {
                        lastWasDash = true;
                    }
                }
                else
                {
                    lastWasDash = false;
                }

                if (i == _buf.length)
                    i = 0;
            }

            if (_buf[ bufLimit-1 ] == '-')
                _buf[ bufLimit-1 ] = ' ';

            emit(_buf, 0, bufLimit);
        }

