        private static int insert ( int head, int before, int i, int[] next, int[] prev )
        {
            if (head == NULL)
            {
                assert before == NULL;
                prev[ i ] = i;
                head = i;
            }
            else if (before != NULL)
            {
                prev[ i ] = prev[ before ];
                next[ i ] = before;
                prev[ before ] = i;

                if (head == before)
                    head = i;
            }
            else
            {
                prev[ i ] = prev[ head ];
                assert next[ i ] == NULL;
                next[ prev[ head ] ] = i;
                prev[ head ] = i;
            }

            return head;
        }

