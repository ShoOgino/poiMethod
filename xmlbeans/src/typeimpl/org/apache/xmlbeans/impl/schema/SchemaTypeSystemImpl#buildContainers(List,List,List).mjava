    // Only called during init
    private void buildContainers(List redefTypeNames, List redefModelGroupNames, List redefAttributeGroupNames)
    {
        // This method walks the reference maps and copies said references
        // into the appropriate container
        for (Iterator it = _globalElements.entrySet().iterator(); it.hasNext(); )
        {
            Map.Entry entry = (Map.Entry) it.next();
            String ns = ((QName) entry.getKey()).getNamespaceURI();
            getContainerNonNull(ns).addGlobalElement((SchemaGlobalElement.Ref) entry.getValue());
        }
        for (Iterator it = _globalAttributes.entrySet().iterator(); it.hasNext(); )
        {
            Map.Entry entry = (Map.Entry) it.next();
            String ns = ((QName) entry.getKey()).getNamespaceURI();
            getContainerNonNull(ns).addGlobalAttribute((SchemaGlobalAttribute.Ref) entry.getValue());
        }
        for (Iterator it = _modelGroups.entrySet().iterator(); it.hasNext(); )
        {
            Map.Entry entry = (Map.Entry) it.next();
            String ns = ((QName) entry.getKey()).getNamespaceURI();
            getContainerNonNull(ns).addModelGroup((SchemaModelGroup.Ref) entry.getValue());
        }
        for (Iterator it = _attributeGroups.entrySet().iterator(); it.hasNext(); )
        {
            Map.Entry entry = (Map.Entry) it.next();
            String ns = ((QName) entry.getKey()).getNamespaceURI();
            getContainerNonNull(ns).addAttributeGroup((SchemaAttributeGroup.Ref) entry.getValue());
        }
        for (Iterator it = _identityConstraints.entrySet().iterator(); it.hasNext(); )
        {
            Map.Entry entry = (Map.Entry) it.next();
            String ns = ((QName) entry.getKey()).getNamespaceURI();
            getContainerNonNull(ns).addIdentityConstraint((SchemaIdentityConstraint.Ref) entry.getValue());
        }
        for (Iterator it = _globalTypes.entrySet().iterator(); it.hasNext(); )
        {
            Map.Entry entry = (Map.Entry) it.next();
            String ns = ((QName) entry.getKey()).getNamespaceURI();
            getContainerNonNull(ns).addGlobalType((SchemaType.Ref) entry.getValue());
        }
        for (Iterator it = _documentTypes.entrySet().iterator(); it.hasNext(); )
        {
            Map.Entry entry = (Map.Entry) it.next();
            String ns = ((QName) entry.getKey()).getNamespaceURI();
            getContainerNonNull(ns).addDocumentType((SchemaType.Ref) entry.getValue());
        }
        for (Iterator it = _attributeTypes.entrySet().iterator(); it.hasNext(); )
        {
            Map.Entry entry = (Map.Entry) it.next();
            String ns = ((QName) entry.getKey()).getNamespaceURI();
            getContainerNonNull(ns).addAttributeType((SchemaType.Ref) entry.getValue());
        }
        // Some earlier .xsb versions don't have records for redefinitions
        if (_redefinedGlobalTypes != null && _redefinedModelGroups != null &&
            _redefinedAttributeGroups != null)
        {
            assert _redefinedGlobalTypes.size() == redefTypeNames.size();
            for (Iterator it = _redefinedGlobalTypes.iterator(), itname = redefTypeNames.iterator(); it.hasNext(); )
            {
                String ns = ((QName) itname.next()).getNamespaceURI();
                getContainerNonNull(ns).addRedefinedType((SchemaType.Ref) it.next());
            }
            for (Iterator it = _redefinedModelGroups.iterator(), itname = redefModelGroupNames.iterator(); it.hasNext(); )
            {
                String ns = ((QName) itname.next()).getNamespaceURI();
                getContainerNonNull(ns).addRedefinedModelGroup((SchemaModelGroup.Ref) it.next());
            }
            for (Iterator it = _redefinedAttributeGroups.iterator(), itname = redefAttributeGroupNames.iterator(); it.hasNext(); )
            {
                String ns = ((QName) itname.next()).getNamespaceURI();
                getContainerNonNull(ns).addRedefinedAttributeGroup((SchemaAttributeGroup.Ref) it.next());
            }
        }
        // Some earlier .xsb versions don't have records for annotations
        if (_annotations != null)
        {
            for (Iterator it = _annotations.iterator(); it.hasNext(); )
            {
                SchemaAnnotation ann = (SchemaAnnotation) it.next();
                // BUGBUG(radup)
                getContainerNonNull("").addAnnotation(ann);
            }
        }
        for (Iterator it = _containers.values().iterator(); it.hasNext(); )
            ((SchemaContainer) it.next()).setImmutable();
    }

