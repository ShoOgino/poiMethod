    public boolean isAssignableFrom(SchemaType type)
    {
        if (type == null || type.isNoType())
            return true;

        if (isNoType())
            return false;

        if (getSimpleVariety() == UNION)
        {
            SchemaType[] members = getUnionMemberTypes();
            for (int i = 0; i < members.length; i++)
                if (members[i].isAssignableFrom(type))
                    return true;
        }

        int depth = ((SchemaTypeImpl)type).getBaseDepth() - getBaseDepth();
        if (depth < 0)
            return false;
        while (depth > 0)
        {
            type = type.getBaseType();
            depth -= 1;
        }
        return (type.equals(this));
    }

