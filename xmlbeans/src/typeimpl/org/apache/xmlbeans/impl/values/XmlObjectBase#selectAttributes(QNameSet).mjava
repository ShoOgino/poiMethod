    /**
     * Selects the contents of the attributes that are contained in the elementNameSet.
     */
    public XmlObject[] selectAttributes(QNameSet attributeNameSet)
    {
        if (attributeNameSet==null)
            throw new IllegalArgumentException();

        XmlCursor xc = this.newCursor();
        try
        {
            if (!xc.isContainer())
                return EMPTY_RESULT;

            List result = new ArrayList();

            if (xc.toFirstAttribute())
            {
                //look for attributes
                do
                {
                    if (attributeNameSet.contains(xc.getName()))
                    {
                        result.add(xc.getObject());
                    }
                }
                while (xc.toNextAttribute());
            }

            if (result.size() == 0)
                return EMPTY_RESULT;
            else
                return (XmlObject[]) result.toArray(EMPTY_RESULT);
        }
        finally
        {
            xc.dispose();
        }
    }

