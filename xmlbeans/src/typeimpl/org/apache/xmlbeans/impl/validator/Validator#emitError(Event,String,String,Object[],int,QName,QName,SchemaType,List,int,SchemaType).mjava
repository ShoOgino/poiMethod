    // KHK: remove 'message' parameter
    private void emitError ( Event event, String message, String code, Object[] args, int severity,
                             QName fieldName, QName offendingQName,
                             SchemaType expectedSchemaType, List expectedQNames,
                             int errorType, SchemaType badSchemaType )
    {
        _errorState++;

        if (_suspendErrors == 0)
        {
            if (severity == XmlError.SEVERITY_ERROR)
                _invalid = true;

            if (_errorListener != null)
            {
                assert event != null;
                XmlError error;
                XmlCursor curs = event.getLocationAsCursor();
                if (curs != null)
                {
                    // non-streaming validation uses XmlCursor
                    error = XmlValidationError.forCursorWithDetails( message, code, args, severity,
                        curs, fieldName, offendingQName, expectedSchemaType, expectedQNames,
                        errorType, badSchemaType);
                }
                else
                {
                    // streaming validation uses Location
                    error = XmlValidationError.forLocationWithDetails( message, code, args, severity,
                        event.getLocation(), fieldName, offendingQName, expectedSchemaType, expectedQNames,
                        errorType, badSchemaType);
                }

                _errorListener.add(error);
            }
        }
    }

